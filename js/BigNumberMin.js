(function(){if("undefined"==typeof C)var C=function(){this.str=""};C.prototype.append=function(l){this.str="number"==typeof l?this.str+String.fromCharCode(l):this.str+l};C.prototype.length=function(){return this.str.length};C.prototype.charAt=function(l){return this.str.charCodeAt(l)};C.prototype.toString=function(){return this.str};if("undefined"==typeof q)var q={};q.divideFourWordsByTwo=function(l,m){var b=l.lo&65535,c=m&65535,e=m>>>16,f=q.divideThreeWordsByTwo(l.lo>>>16,l.hi&65535,l.hi>>>16,c,
e),d=f[0],f=q.divideThreeWordsByTwo(b,f[1],f[2],c,e);return[(f[0]|d<<16)>>>0,(f[1]|f[2]<<16)>>>0]};q.divideThreeWordsByTwo=function(l,m,b,c,e){var f=0,f=65535==e?b:0<e?((m|b<<16)>>>0)/(e+1&65535)&65535|0:((m|b<<16)>>>0)/c&65535|0,d=c*f>>>0,g=l-(d&65535)>>>0;l=g&65535;g=m-(d>>>16)-(0-(g>>>16)&65535)-(e*f>>>0)>>>0;m=g&65535;for(b=b+(g>>>16)&65535;0!=b||m>e||m==e&&l>=c;)g=l-c>>>0,l=g&65535,g=m-e-(0-(g>>>16)&65535)>>>0,m=g&65535,b=b+(g>>>16)&65535,f++,f&=65535;return[f,l,m,b]};q.divide64By32=function(l,
m,b){var c=0,c=new w(m,0),c=q.divideFourWordsByTwo(c,b);m=c[0];c=c[1];c=new w(l,c);c=q.divideFourWordsByTwo(c,b);return new w(c[0],m)};var w=function(l,m){this.lo=l>>>0;this.hi=m>>>0};w.prototype.signum=function(){return 0==(this.lo|this.hi)?0:0!=this.hi>>>31?-1:1};w.prototype.equals=function(l){return this.lo==l.lo&&this.hi==l.hi};w.prototype.negate=function(){var l=new w(this.lo,this.hi);0!=(this.lo|this.hi)&&l._twosComplement();return l};w.prototype.or=function(l){return new w(this.lo|l.lo,this.hi|
l.hi)};w.prototype.andInt=function(l){return new w(this.lo&l>>>0,this.hi)};w.prototype.intValue=function(l){return this.lo|0};w.prototype.shortValue=function(l){return(this.lo|0)&65535};w.prototype.equalsInt=function(l){return 0>l?0==~this.hi&&this.lo==l>>>0:0==this.hi&&this.lo==l>>>0};w.prototype._twosComplement=function(){0==this.lo&&(this.hi=this.hi-1>>>0);this.lo=this.lo-1>>>0;this.lo=~this.lo>>>0;this.hi=~this.hi>>>0};w.prototype.remainderWithUnsignedDivisor=function(l){if(0!=this.hi>>>31){var m=
new w(this.lo,this.hi);m._twosComplement();m=m._remainderUnsignedDividendUnsigned(l);m._twosComplement();return m}return this._remainderUnsignedDividendUnsigned(l)};w.prototype.divideWithUnsignedDivisor=function(l){if(0!=this.hi>>>31){var m=new w(this.lo,this.hi);m._twosComplement();m=m._divideUnsignedDividendUnsigned(l);m._twosComplement();return m}return this._divideUnsignedDividendUnsigned(l)};w.prototype._divideUnsignedDividendUnsigned=function(l){l|=0;if(0>l)throw new RuntimeException("value is less than 0");
return 1==l?this:0==this.hi?new w((this.lo>>>0)/l,0):q.divide64By32(this.lo,this.hi,l)};w.prototype._remainderUnsignedDividendUnsigned=function(l){l|=0;if(0>l)throw new RuntimeException("value is less than 0");if(1==l)return this;if(65536>l||0==this.hi){var m=this.hi%l,m=(this.lo>>>16|m<<16)%l;return new w((this.lo&65535|m<<16)%l&65535,0)}l=q.divideFourWordsByTwo(this,l);return new w(l[1],0==l[1]>>>31?0:-2147483648)};w.prototype.shiftLeft=function(l){if(0>=l)return this;if(64<=l)return q.LONG_ZERO;
if(32<=l)return new w(0,this.lo<<l-32);if(0==this.lo)return new w(0,this.hi<<l);var m=this.hi<<l,b=this.lo<<l,m=m|this.lo>>>32-l;return new w(b,m)};w.prototype.shiftRight=function(l){if(0>=l)return this;if(64<=l)return 0!=this.hi>>>31?q.LONG_MAX_VALUE():q.LONG_MIN_VALUE();if(32<=l)return new w(this.hi>>l-32,0!=this.hi>>>31?-1:0);if(0==this.hi)return new w(this.lo>>>l,0);var m=this.hi>>l,b=this.lo>>>l,b=b|this.hi<<32-l;return new w(b,m)};q.createStringBuilder=function(l){return new C};q.createLong=
function(l){return l.constructor==w?l:new w(l,0>l?-1:0)};q.createLongFromInts=function(l,m){return new w(l>>>0,m>>>0)};q.LONG_MIN_VALUE_=new w(0,-2147483648);q.LONG_MAX_VALUE_=new w(-1,-1);q.LONG_MIN_VALUE=function(){return q.LONG_MIN_VALUE_};q.LONG_MAX_VALUE=function(){return q.LONG_MAX_VALUE_};q.LONG_ZERO=new w(0,0);var D={IntegersToDouble:function(){throw"Not implemented";},DoubleToIntegers:function(){throw"Not implemented";}};"undefined"!==typeof exports&&(exports.Extras=D,exports.JSInteropFactory=
q,exports.ILong=w,exports.StringBuilder=C);var l=function(){};(function(n,m){n.CountWords=function(b,c){for(;0!=c&&0==b[c-1];)c--;return c|0};n.SetWords=function(b,c,e,f){for(var d=0;d<f;d++)b[c+d]=e&65535};n.ShiftWordsLeftByBits=function(b,c,e,f){var d,g=0;if(0!=f)for(var a=0;a<e;a++)d=b[c+a],b[c+a]=(d<<(f|0)|0|g&65535|0)&65535|0,g=(d&65535)>>(16-f|0)|0;return g};n.ShiftWordsRightByBits=function(b,c,e,f){var d=0;if(0!=f)for(var g=e;0<g;g--)e=b[c+g-1],b[c+g-1]=((e&65535)>>(f|0)&65535|d&65535|0)&65535|
0,d=(e&65535)<<(16-f|0)|0;return d};n.ShiftWordsRightByBitsSignExtend=function(b,c,e,f){var d=65535<<(16-f|0)|0;if(0!=f)for(var g=e;0<g;g--)e=b[c+g-1],b[c+g-1]=((e&65535)>>(f|0)|d&65535|0)&65535|0,d=(e&65535)<<(16-f|0)|0;return d};n.ShiftWordsLeftByWords=function(b,c,e,f){f=f<e?f:e;if(0!=f){for(e-=1;e>=f;e--)b[c+e]=b[c+e-f]&65535;l.SetWords(b,c,0,f)}};n.ShiftWordsRightByWords=function(b,c,e,f){f=f<e?f:e;if(0!=f){for(var d=0;d+f<e;d++)b[c+d]=b[c+d+f]&65535;l.SetWords(b,c+e-f|0,0,f)}};n.ShiftWordsRightByWordsSignExtend=
function(b,c,e,f){f=f<e?f:e;if(0!=f){for(var d=0;d+f<e;d++)b[c+d]=b[c+d+f]&65535;l.SetWords(b,c+e-f|0,65535,f)}};n.Compare=function(b,c,e,f,d){for(;0!=d--;){var g=b[c+d]&65535,a=e[f+d]&65535;if(g>a)return 1;if(g<a)return-1}return 0};n.Increment=function(b,c,e,f){var d=b[c];b[c]=d+f&65535;if((b[c]&65535)>=(d&65535))return 0;for(f=1;f<e;f++)if(b[c+f]=b[c+f]+1&65535,0!=b[c+f])return 0;return 1};n.Decrement=function(b,c,e,f){var d=b[c];b[c]=d-f&65535;if((b[c]&65535)<=(d&65535))return 0;for(f=1;f<e;f++)if(d=
b[c+f],b[c+f]=b[c+f]-1&65535,0!=d)return 0;return 1};n.TwosComplement=function(b,c,e){l.Decrement(b,c,e,1);for(var f=0;f<e;f++)b[c+f]=~b[c+f]&65535};n.Add=function(b,c,e,f,d,g,a){for(var h,k=h=0;k<a;k+=2)h=(e[f+k]&65535)+(d[g+k]&65535)+(h>>16|0),b[c+k]=h&65535|0,h=(e[f+k+1]&65535)+(d[g+k+1]&65535)+(h>>16|0),b[c+k+1]=h&65535|0;return(h|0)>>>16};n.Subtract=function(b,c,e,f,d,g,a){for(var h,k=h=0;k<a;k+=2)h=(e[f+k]&65535)-(d[g+k]&65535)-(h>>31&1),b[c+k]=h&65535|0,h=(e[f+k+1]&65535)-(d[g+k+1]&65535)-
(h>>31&1),b[c+k+1]=h&65535|0;return h>>31&1};n.LinearMultiply=function(b,c,e,f,d,g){var a=0;d&=65535;for(var h=0;h<g;h++){var k;k=(e[f+h]&65535)*d;k+=a&65535;b[c+h]=k&65535|0;a=k>>16|0}return a};n.Baseline_Square2=function(b,c,e,f){var d,g,a;d=(e[f]&65535)*(e[f]&65535);b[c]=d&65535|0;a=(d|0)>>>16;d=(e[f]&65535)*(e[f+1]&65535);g=d&65535;d=((d|0)>>>16<<1)+((g|0)>>15&1)|0;a+=g<<1&65535;g=a&65535;a=d+((a|0)>>>16);b[c+4-3]=g&65535;d=(e[f+2-1]&65535)*(e[f+2-1]&65535);d+=a;b[c+4-2]=d&65535|0;b[c+4-1]=d>>
16&65535};n.Baseline_Square4=function(b,c,e,f){var d,g,a,h;d=(e[f]&65535)*(e[f]&65535);b[c]=d&65535|0;h=(d|0)>>>16;d=(e[f]&65535)*(e[f+1]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;h+=g<<1&65535;g=h&65535;h=a+((h|0)>>>16);b[c+1]=g&65535;d=(e[f]&65535)*(e[f+2]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+1]&65535)*(e[f+1]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+2]=g&65535;d=(e[f]&65535)*(e[f+3]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*
(e[f+2]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+3]=g&65535;d=(e[f+1]&65535)*(e[f+3]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+2]&65535)*(e[f+2]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+4]=g&65535;d=(e[f+2]&65535)*(e[f+3]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+8-3]=g&65535;d=(e[f+4-1]&65535)*(e[f+4-1]&65535);d+=
h;b[c+8-2]=d&65535|0;b[c+8-1]=d>>16&65535};n.Baseline_Square8=function(b,c,e,f){var d,g,a,h;d=(e[f]&65535)*(e[f]&65535);b[c]=d&65535|0;h=(d|0)>>>16;d=(e[f]&65535)*(e[f+1]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;h+=g<<1&65535;g=h&65535;h=a+((h|0)>>>16);b[c+1]=g&65535;d=(e[f]&65535)*(e[f+2]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+1]&65535)*(e[f+1]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+2]=g&65535;d=(e[f]&65535)*(e[f+3]&65535);g=d&
65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+2]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+3]=g&65535;d=(e[f]&65535)*(e[f+4]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+3]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+2]&65535)*(e[f+2]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+4]=g&65535;d=(e[f]&65535)*(e[f+5]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*
(e[f+4]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+3]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+5]=g&65535;d=(e[f]&65535)*(e[f+6]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+5]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+4]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+3]&65535)*(e[f+3]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+
((h|0)>>>16);b[c+6]=g&65535;d=(e[f]&65535)*(e[f+7]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+5]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+4]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+7]=g&65535;d=(e[f+1]&65535)*(e[f+7]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*
(e[f+5]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+4]&65535)*(e[f+4]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+8]=g&65535;d=(e[f+2]&65535)*(e[f+7]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+5]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+9]=g&65535;d=(e[f+3]&65535)*(e[f+7]&65535);g=d&65535;
a=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+5]&65535)*(e[f+5]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+10]=g&65535;d=(e[f+4]&65535)*(e[f+7]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+11]=g&65535;d=(e[f+5]&65535)*(e[f+7]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|
0;g<<=1;d=(e[f+6]&65535)*(e[f+6]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+12]=g&65535;d=(e[f+6]&65535)*(e[f+7]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+16-3]=g&65535;d=(e[f+8-1]&65535)*(e[f+8-1]&65535);d+=h;b[c+16-2]=d&65535|0;b[c+16-1]=d>>16&65535};n.Baseline_Square16=function(b,c,e,f){var d,g,a,h;d=(e[f]&65535)*(e[f]&65535);b[c]=d&65535|0;h=(d|0)>>>16;d=(e[f]&65535)*(e[f+1]&65535);g=d&65535;a=((d|0)>>>16<<
1)+((g|0)>>15&1)|0;h+=g<<1&65535;g=h&65535;h=a+((h|0)>>>16);b[c+1]=g&65535;d=(e[f]&65535)*(e[f+2]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+1]&65535)*(e[f+1]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+2]=g&65535;d=(e[f]&65535)*(e[f+3]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+2]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+3]=g&65535;d=(e[f]&65535)*(e[f+4]&65535);g=
d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+3]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+2]&65535)*(e[f+2]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+4]=g&65535;d=(e[f]&65535)*(e[f+5]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+4]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+3]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+5]=g&65535;d=
(e[f]&65535)*(e[f+6]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+5]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+4]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+3]&65535)*(e[f+3]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+6]=g&65535;d=(e[f]&65535)*(e[f+7]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+5]&65535);d+=g&65535;g=d&65535;a+=
(d|0)>>>16;d=(e[f+3]&65535)*(e[f+4]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+7]=g&65535;d=(e[f]&65535)*(e[f+8]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+7]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+5]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+4]&65535)*(e[f+4]&65535);d+=g&65535;a+=(d|0)>>>
16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+8]=g&65535;d=(e[f]&65535)*(e[f+9]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+8]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+7]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+5]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+9]=g&65535;d=(e[f]&65535)*(e[f+10]&65535);g=d&65535;
a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+9]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+8]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+7]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+5]&65535)*(e[f+5]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+10]=g&65535;d=(e[f]&65535)*(e[f+11]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+10]&
65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+9]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+8]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+7]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+6]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+11]=g&65535;d=(e[f]&65535)*(e[f+12]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;
a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+10]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+9]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+8]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+7]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+6]&65535)*(e[f+6]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+12]=g&65535;d=(e[f]&65535)*(e[f+13]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+
12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+10]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+9]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+8]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+6]&65535)*(e[f+7]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+13]=g&65535;d=(e[f]&65535)*(e[f+14]&65535);g=
d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+10]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+9]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+6]&65535)*(e[f+8]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+7]&65535)*(e[f+7]&65535);d+=g&65535;
a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+14]=g&65535;d=(e[f]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+1]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+10]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+6]&65535)*(e[f+9]&65535);d+=g&65535;
g=d&65535;a+=(d|0)>>>16;d=(e[f+7]&65535)*(e[f+8]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+15]=g&65535;d=(e[f+1]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+2]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>
16;d=(e[f+6]&65535)*(e[f+10]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+7]&65535)*(e[f+9]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+8]&65535)*(e[f+8]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+16]=g&65535;d=(e[f+2]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+3]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+12]&65535);
d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+6]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+7]&65535)*(e[f+10]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+8]&65535)*(e[f+9]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+17]=g&65535;d=(e[f+3]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+4]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;
a+=(d|0)>>>16;d=(e[f+6]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+7]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+8]&65535)*(e[f+10]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+9]&65535)*(e[f+9]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+18]=g&65535;d=(e[f+4]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+5]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+6]&65535)*
(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+7]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+8]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+9]&65535)*(e[f+10]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+19]=g&65535;d=(e[f+5]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+6]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+7]&65535)*(e[f+13]&65535);d+=g&
65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+8]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+9]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+10]&65535)*(e[f+10]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+20]=g&65535;d=(e[f+6]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+7]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+8]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;
d=(e[f+9]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+10]&65535)*(e[f+11]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+21]=g&65535;d=(e[f+7]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+8]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+9]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+10]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&
1)|0;g<<=1;d=(e[f+11]&65535)*(e[f+11]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+22]=g&65535;d=(e[f+8]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+9]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+10]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+11]&65535)*(e[f+12]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+23]=g&65535;d=(e[f+9]&65535)*(e[f+15]&65535);
g=d&65535;a=(d|0)>>>16;d=(e[f+10]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+11]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+12]&65535)*(e[f+12]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+24]=g&65535;d=(e[f+10]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+11]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;d=(e[f+12]&65535)*(e[f+13]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=
(a<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+25]=g&65535;d=(e[f+11]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+12]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+13]&65535)*(e[f+13]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+26]=g&65535;d=(e[f+12]&65535)*(e[f+15]&65535);g=d&65535;a=(d|0)>>>16;d=(e[f+13]&65535)*(e[f+14]&65535);d+=g&65535;g=d&65535;a+=(d|0)>>>16;a=(a<<1)+((g|0)>>15&1)|
0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+27]=g&65535;d=(e[f+13]&65535)*(e[f+15]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;g<<=1;d=(e[f+14]&65535)*(e[f+14]&65535);d+=g&65535;a+=(d|0)>>>16;h+=d&65535;g=h&65535;h=a+((h|0)>>>16);b[c+28]=g&65535;d=(e[f+14]&65535)*(e[f+15]&65535);g=d&65535;a=((d|0)>>>16<<1)+((g|0)>>15&1)|0;g<<=1;h+=g&65535;g=h&65535;h=a+((h|0)>>>16);b[c+32-3]=g&65535;d=(e[f+16-1]&65535)*(e[f+16-1]&65535);d+=h;b[c+32-2]=d&65535|0;b[c+32-1]=d>>16&65535};n.Baseline_Multiply2=
function(b,c,e,f,d,g){var a,h,k;a=(e[f]&65535)*(d[g]&65535);k=(a|0)>>>16;b[c]=a&65535;h=k&65535;a=(e[f]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k=((k|0)>>>16)+((a|0)>>>16);a=(e[f+1]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+1]=a&65535;a=(e[f+1]&65535)*(d[g+1]&65535);a+=k;b[c+1+1]=a&65535|0;b[c+1+2]=a>>16&65535};n.Baseline_Multiply4=function(b,c,e,f,d,g){var a,h,k;a=(e[f]&65535)*(d[g]&65535);k=(a|0)>>>16;b[c]=a&65535;h=k&65535;a=(e[f]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k=((k|0)>>>
16)+((a|0)>>>16);a=(e[f+1]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+1]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+2]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+1]&65535);a+=
h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+3]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+1]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+1]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+4]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+2]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+2]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+5]=a&65535;a=(e[f+3]&
65535)*(d[g+3]&65535);a+=k;b[c+5+1]=a&65535|0;b[c+5+2]=a>>16&65535};n.Baseline_Multiply8=function(b,c,e,f,d,g){var a,h,k;a=(e[f]&65535)*(d[g]&65535);k=(a|0)>>>16;b[c]=a&65535;h=k&65535;a=(e[f]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k=((k|0)>>>16)+((a|0)>>>16);a=(e[f+1]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+1]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*
(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+2]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+3]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=
(e[f+2]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+4]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&
65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+5]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+
1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+6]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+2]&65535);
a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+7]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+1]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+3]&65535);a+=h&65535;
h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+1]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+8]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+2]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+3]&65535);a+=h&65535;h=a&
65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+2]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+9]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+3]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+3]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+10]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+4]&65535)*(d[g+
7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+4]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+11]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+5]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+5]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+12]=a&65535;h=k&65535;k=(k|0)>>>
16;a=(e[f+6]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+6]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+13]=a&65535;a=(e[f+7]&65535)*(d[g+7]&65535);a+=k;b[c+13+1]=a&65535|0;b[c+13+2]=a>>16&65535};n.Baseline_Multiply16=function(b,c,e,f,d,g){var a,h,k;a=(e[f]&65535)*(d[g]&65535);k=(a|0)>>>16;b[c]=a&65535;h=k&65535;a=(e[f]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k=((k|0)>>>16)+((a|0)>>>16);a=(e[f+1]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+1]=a&65535;h=k&65535;k=
(k|0)>>>16;a=(e[f]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+2]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+3]=a&65535;
h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+4]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=
(a|0)>>>16;a=(e[f+2]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+5]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>
16;a=(e[f+3]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+6]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+
3]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+7]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*
(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+8]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+9]&
65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|
0)>>>16;a=(e[f+8]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+9]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;
a=(e[f+5]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+10]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+
1]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+3]&65535);a+=h&65535;
h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+11]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+9]&65535);a+=h&65535;h=
a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&
65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+12]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*
(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+1]&65535);a+=h&65535;h=a&
65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+13]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;
k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*
(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+14]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+1]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+
10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;
k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+1]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+15]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+1]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+2]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;
k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*
(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+2]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+1]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+16]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+2]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+3]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*
(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+5]&65535);a+=h&65535;
h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+3]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+2]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+17]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+3]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+4]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+12]&65535);a+=h&65535;
h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=
(e[f+14]&65535)*(d[g+4]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+3]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+18]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+4]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+5]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;
a=(e[f+9]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+5]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+4]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+19]=a&65535;h=k&65535;k=(k|0)>>>
16;a=(e[f+5]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+6]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+
8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+6]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+5]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+20]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+6]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+7]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+
12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+8]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+7]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+6]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+21]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+7]&65535)*
(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+8]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+8]&65535);a+=h&65535;
h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+7]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+22]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+8]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+9]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+11]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+10]&65535);a+=
h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+9]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+8]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+23]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+9]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+10]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+11]&65535);
a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+10]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+9]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+24]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+10]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+11]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+11]&
65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+10]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+25]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+11]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+12]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+12]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+11]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+26]=a&65535;h=k&65535;
k=(k|0)>>>16;a=(e[f+12]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+13]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+13]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+12]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+27]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+13]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+14]&65535)*(d[g+14]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+13]&65535);a+=h&65535;
k+=(a|0)>>>16;b[c+28]=a&65535;h=k&65535;k=(k|0)>>>16;a=(e[f+14]&65535)*(d[g+15]&65535);a+=h&65535;h=a&65535;k+=(a|0)>>>16;a=(e[f+15]&65535)*(d[g+14]&65535);a+=h&65535;k+=(a|0)>>>16;b[c+29]=a&65535;a=(e[f+15]&65535)*(d[g+15]&65535);a+=k;b[c+30]=a&65535|0;b[c+31]=a>>16&65535};n.s_recursionLimit=16;n.RecursiveMultiply=function(b,c,e,f,d,g,a,h,k){if(k<=l.s_recursionLimit)switch(k>>2){case 0:l.Baseline_Multiply2(b,c,d,g,a,h);break;case 1:l.Baseline_Multiply4(b,c,d,g,a,h);break;case 2:l.Baseline_Multiply8(b,
c,d,g,a,h);break;case 4:l.Baseline_Multiply16(b,c,d,g,a,h);break;default:throw"exception";}else{var m=k/2|0,n=0<l.Compare(d,g,d,g+m|0,m)?0:m;l.Subtract(b,c,d,g+n|0,d,g+(m^n)|0,m);var p=0<l.Compare(a,h,a,h+m|0,m)?0:m;l.Subtract(b,c+m|0,a,h+p|0,a,h+(m^p)|0,m);l.RecursiveMultiply(b,c+k|0,e,f+k|0,d,g+m|0,a,h+m|0,m);l.RecursiveMultiply(e,f,e,f+k|0,b,c,b,c+m|0,m);l.RecursiveMultiply(b,c,e,f+k|0,d,g,a,h,m);g=d=l.Add(b,c+k|0,b,c+k|0,b,c+m|0,m);d+=l.Add(b,c+m|0,b,c+k|0,b,c,m);g+=l.Add(b,c+k|0,b,c+k|0,b,c+
k+m|0,m);g=n==p?g-l.Subtract(b,c+m|0,b,c+m|0,e,f,k):g+l.Add(b,c+m|0,b,c+m|0,e,f,k);g+=l.Increment(b,c+k|0,m,d|0);l.Increment(b,c+k+m|0,m,g|0)}};n.RecursiveSquare=function(b,c,e,f,d,g,a){if(a<=l.s_recursionLimit)switch(a>>2){case 0:l.Baseline_Square2(b,c,d,g);break;case 1:l.Baseline_Square4(b,c,d,g);break;case 2:l.Baseline_Square8(b,c,d,g);break;case 4:l.Baseline_Square16(b,c,d,g);break;default:throw"exception";}else{var h=a/2|0;l.RecursiveSquare(b,c,e,f+a|0,d,g,h);l.RecursiveSquare(b,c+a|0,e,f+a|
0,d,g+h|0,h);l.RecursiveMultiply(e,f,e,f+a|0,d,g,d,g+h|0,h);d=l.Add(b,c+h|0,b,c+h|0,e,f,a);d+=l.Add(b,c+h|0,b,c+h|0,e,f,a);l.Increment(b,c+a+h|0,h,d|0)}};n.Multiply=function(b,c,e,f,d,g,a,h,k){l.RecursiveMultiply(b,c,e,f,d,g,a,h,k)};n.Square=function(b,c,e,f,d,g,a){l.RecursiveSquare(b,c,e,f,d,g,a)};n.AsymmetricMultiply=function(b,c,e,f,d,g,a,h,k,m){if(a==m)g==k&&d==h?l.Square(b,c,e,f,d,g,a):2==a?l.Baseline_Multiply2(b,c,d,g,h,k):l.Multiply(b,c,e,f,d,g,h,k,a);else{if(a>m){var n=d;d=h;h=n;n=g;g=k;k=
n;n=a;a=m;m=n}if(2==a&&0==d[g+1])switch(d[g]){case 0:l.SetWords(b,c,0,m+2);return;case 1:for(n=0;n<(m|0);n++)b[c+n]=h[k+n];b[c+m]=0;b[c+m+1]=0;return;default:b[c+m]=l.LinearMultiply(b,c,h,k,d[g],m)&65535;b[c+m+1]=0;return}if(2==a)if(0==(m/2|0)%2){l.Baseline_Multiply2(b,c,d,g,h,k);for(n=0;2>n;n++)e[(f+4|0)+n]=b[(c+2|0)+n];for(n=4;n<m;n+=4)l.Baseline_Multiply2(e,f+2+n|0,d,g,h,k+n|0);for(n=2;n<m;n+=4)l.Baseline_Multiply2(b,c+n|0,d,g,h,k+n|0)}else{for(n=0;n<m;n+=4)l.Baseline_Multiply2(b,c+n|0,d,g,h,k+
n|0);for(n=2;n<m;n+=4)l.Baseline_Multiply2(e,f+2+n|0,d,g,h,k+n|0)}else if(0==(m/a|0)%2){l.Multiply(b,c,e,f,d,g,h,k,a);for(n=0;n<(a|0);n++)e[(f+2*a|0)+n]=b[(c+a|0)+n];for(n=2*a;n<m;n+=2*a)l.Multiply(e,f+a+n|0,e,f,d,g,h,k+n|0,a);for(n=a;n<m;n+=2*a)l.Multiply(b,c+n|0,e,f,d,g,h,k+n|0,a)}else{for(n=0;n<m;n+=2*a)l.Multiply(b,c+n|0,e,f,d,g,h,k+n|0,a);for(n=a;n<m;n+=2*a)l.Multiply(e,f+a+n|0,e,f,d,g,h,k+n|0,a)}0!=l.Add(b,c+a|0,b,c+a|0,e,f+2*a|0,m-a)&&l.Increment(b,c+m|0,a,1)}};n.MakeUint=function(b,c){return b&
65535|(c|0)<<16|0};n.GetLowHalf=function(b){return b&65535};n.GetHighHalf=function(b){return b>>>16|0};n.GetHighHalfAsBorrow=function(b){return 0-(b>>>16)|0};n.BitPrecision=function(b){if(0==b)return 0;var c=16;0==b>>8&&(b<<=8,c-=8);0==b>>12&&(b<<=4,c-=4);0==b>>14&&(b<<=2,c-=2);0==b>>15&&--c;return c};n.BitPrecisionInt=function(b){if(0==b)return 0;var c=32;0==b>>16&&(b<<=16,c-=16);0==b>>24&&(b<<=8,c-=8);0==b>>28&&(b<<=4,c-=4);0==b>>30&&(b<<=2,c-=2);0==b>>31&&--c;return c};n.Divide32By16=function(b,
c,e){for(var f=0,d=c&65535,g=0;32>g;g++)if(c=f>>31,f<<=1,f=f|b>>31&1|0,b<<=1,c|=f,0!=c>>31||c>=d)f-=d,b+=1;return e?f&65535:b&65535};n.DivideUnsigned=function(b,c){return 0==b>>31?(b|0)/(c&65535)&65535|0:l.Divide32By16(b,c,!1)};n.RemainderUnsigned=function(b,c){return 0==b>>31?(b|0)%(c&65535)&65535:l.Divide32By16(b,c,!0)};n.DivideThreeWordsByTwo=function(b,c,e,f){var d;d=0==(f+1|0)?b[c+2]:0<(f&65535)?l.DivideUnsigned(l.MakeUint(b[c+1],b[c+2]),(f|0)+1&65535):l.DivideUnsigned(l.MakeUint(b[c],b[c+1]),
e);var g=d&65535,a=e&65535,h=f&65535,k=a*g,m=(b[c]&65535)-(l.GetLowHalf(k)&65535);b[c]=l.GetLowHalf(m)&65535;m=(b[c+1]&65535)-(l.GetHighHalf(k)&65535)-(l.GetHighHalfAsBorrow(m)&65535)-h*g;b[c+1]=l.GetLowHalf(m)&65535;for(b[c+2]=b[c+2]+l.GetHighHalf(m)&65535;0!=b[c+2]||(b[c+1]&65535)>(f&65535)||b[c+1]==f&&(b[c]&65535)>=(e&65535);)m=(b[c]&65535)-a,b[c]=l.GetLowHalf(m)&65535,m=(b[c+1]&65535)-h-(l.GetHighHalfAsBorrow(m)&65535),b[c+1]=l.GetLowHalf(m)&65535,b[c+2]=b[c+2]+l.GetHighHalf(m)&65535,d++;return d};
n.DivideFourWordsByTwo=function(b,c,e,f){if(0==f)return l.MakeUint(l.GetLowHalf(c),l.GetHighHalf(e));var d=[0,0];b[0]=l.GetLowHalf(c)&65535;b[1]=l.GetHighHalf(c)&65535;b[2]=l.GetLowHalf(e)&65535;b[3]=l.GetHighHalf(e)&65535;d[1]=l.DivideThreeWordsByTwo(b,1,l.GetLowHalf(f),l.GetHighHalf(f))&65535|0;d[0]=l.DivideThreeWordsByTwo(b,0,l.GetLowHalf(f),l.GetHighHalf(f))&65535|0;return l.MakeUint(d[0],d[1])};n.AtomicDivide=function(b,c,e,f,d,g){e=l.DivideFourWordsByTwo([0,0,0,0],l.MakeUint(e[f],e[f+1]),l.MakeUint(e[f+
2],e[f+3]),l.MakeUint(d[g],d[g+1]));b[c]=l.GetLowHalf(e)&65535;b[c+1]=l.GetHighHalf(e)&65535};n.CorrectQuotientEstimate=function(b,c,e,f,d,g,a,h,k){2==k?l.Baseline_Multiply2(e,f,d,g,a,h):l.AsymmetricMultiply(e,f,e,f+(k+2)|0,d,g,2,a,h,k);for(l.Subtract(b,c,b,c,e,f,k+2);0!=b[c+k]||0<=l.Compare(b,c,a,h,k);)b[c+k]=b[c+k]-(l.Subtract(b,c,b,c,a,h,k)|0)&65535|0,d[g]=d[g]+1&65535,d[g+1]=d[g+1]+((0==d[g]?1:0)|0)&65535|0};n.Divide=function(b,c,e,f,d,g,a,h,k,m,n,p){var s=k|0;p|=0;var r=g+(s+2)|0,u=g+(s+2+p)|
0,t=(0==m[n+p-1]?1:0)|0;d[r]=0;for(var q=d[r+p-1]=0;q<p-t;q++)d[(r+t|0)+q]=m[n+q];m=16-l.BitPrecision(d[r+p-1])|0;l.ShiftWordsLeftByBits(d,r,p,m);d[0]=0;d[s]=0;for(q=d[s+1]=0;q<k;q++)d[(g+t|0)+q]=a[h+q];l.ShiftWordsLeftByBits(d,g,s+2,m);if(0==d[g+s+1]&&1>=(d[g+s]&65535))for(e[f+s-p+1]=0,e[f+s-p]=0;0!=d[s]||0<=l.Compare(d,g+s-p|0,d,r,p);)d[s]=d[s]-(l.Subtract(d,g+s-p|0,d,g+s-p|0,d,r,p)|0)&65535|0,e[f+s-p]=e[f+s-p]+1&65535;else s+=2;a=[0,0];a[0]=d[r+p-2]+1&65535;a[1]=d[r+p-1]+((0==a[0]?1:0)|0)&65535|
0;for(s-=2;s>=p;s-=2)l.AtomicDivide(e,f+s-p|0,d,g+s-2|0,a,0),l.CorrectQuotientEstimate(d,g+s-p|0,d,u,e,f+(s-p)|0,d,r,p);if(null!=b){for(q=0;q<p;q++)b[c+q]=d[(g+t|0)+q];l.ShiftWordsRightByBits(b,c,p,m)}};n.RoundupSizeTable=[2,2,2,4,4,8,8,8,8];n.RoundupSize=function(b){return 8>=b?l.RoundupSizeTable[b]:16>=b?16:32>=b?32:64>=b?64:1<<(l.BitPrecisionInt(b-1)|0)};m.negative=null;m.wordCount=-1;m.reg=null;n.fromByteArray=function(b,c){var e=new l;e.fromByteArrayInternal(b,c);return e};m.fromByteArrayInternal=
function(b,c){if(null==b)throw"bytes";if(0==b.length)this.reg=[0,0],this.wordCount=0;else{this.reg=[];for(var e=0;e<l.RoundupSize(((b.length|0)+1)/2|0);e++)this.reg[e]=0;for(var e=0!=(b[c?b.length-1:0]&128),f=0,d=0;d<b.length;d+=2,f++){var g=c?d+1:b.length-2-d;this.reg[f]=b[c?d:b.length-1-d]&255|0;0<=g&&g<b.length?this.reg[f]=(this.reg[f]|(b[g]|0)<<8|0)&65535|0:e&&(this.reg[f]=(this.reg[f]|65280)&65535)}if(this.negative=e){for(;f<this.reg.length;f++)this.reg[f]=65535;l.TwosComplement(this.reg,0,this.reg.length|
0)}this.wordCount=this.CalcWordCount()}};m.Allocate=function(b){this.reg=[];for(var c=0;c<l.RoundupSize(b);c++)this.reg[c]=0;this.negative=!1;this.wordCount=0;return this};n.GrowForCarry=function(b,c){var e=b.length,f=l.CleanGrow(b,l.RoundupSize(e+1));f[e]=c&65535;return f};n.CleanGrow=function(b,c){if(c>b.length){for(var e=[],f=0;f<c;f++)e[f]=0;for(f=0;f<b.length;f++)e[0+f]=b[0+f];return e}return b};m.SetBitInternal=function(b,c){c?(this.reg=l.CleanGrow(this.reg,l.RoundupSize(l.BitsToWords(b+1))),
this.reg[b/16|0]=(this.reg[b/16|0]|1<<(b&15)|0)&65535|0):(b/16|0)<this.reg.length&&(this.reg[b/16|0]=this.reg[b/16|0]&(~(1<<(b%16|0))|0)&65535|0);this.wordCount=this.CalcWordCount()};m.testBit=function(b){if(0>b)throw"index";if(0>this.signum()){var c=0,e=b/16|0;if(e>=this.reg.length)return!0;for(;c<e&&0==this.reg[c];)c++;var f;f=this.reg[e];c==e&&f--;return 0!=((~f|0)>>(b&15)&1)}return this.GetUnsignedBit(b)};m.GetUnsignedBit=function(b){return(b/16|0)>=this.reg.length?!1:0!=(this.reg[b/16|0]>>(b&
15)&1)};m.InitializeInt=function(b){this.negative=0>b;-2147483648==b?(this.reg=[0,0],this.reg[0]=0,this.reg[1]=32768,this.wordCount=2):(b=0>b?-b|0:b|0,this.reg=[0,0],this.reg[0]=b&65535,this.reg[1]=b>>16&65535,this.wordCount=0!=this.reg[1]?2:0==this.reg[0]?0:1);return this};m.toByteArray=function(b){var c=this.signum();if(0==c)return[0];if(0<c){var e=c=this.ByteCount();this.GetUnsignedBit(8*c-1)&&e++;for(var f=[],d=0;d<e;d++)f[d]=0;for(var g=d=0;g<c;g+=2,d++){var a=b?g:f.length-1-g,h=b?g+1:f.length-
2-g;f[a]=this.reg[d]&255;0<=h&&h<e&&(f[h]=this.reg[d]>>8&255)}}else{e=[];for(d=0;d<this.reg.length;d++)e[d]=0;for(d=0;d<this.reg.length;d++)e[0+d]=this.reg[0+d];l.TwosComplement(e,0,e.length|0);c=2*e.length;for(g=e.length-1;0<=g;g--)if(65535==e[g])c-=2;else{65408==(e[g]&65408)?c-=1:32768!=(e[g]&32768)&&(c+=1);break}0==c&&(c=1);f=[];for(d=0;d<c;d++)f[d]=0;f[b?f.length-1:0]=255;c=c<2*e.length?c:2*e.length;for(g=d=0;g<c;g+=2,d++)a=b?g:f.length-1-g,h=b?g+1:f.length-2-g,f[a]=e[d]&255,0<=h&&h<c&&(f[h]=
e[d]>>8&255)}return f};m.shiftLeft=function(b){if(0==b)return this;if(0>b)return-2147483648==b?this.shiftRight(1).shiftRight(2147483647):this.shiftRight(-b);var c=new l,e=this.wordCount|0,f=b>>4|0,d=b&15;if(0<e&&this.negative){c.negative=!0;c.reg=[];for(g=0;g<l.RoundupSize(e+l.BitsToWords(b|0));g++)c.reg[g]=0;for(g=0;g<e;g++)c.reg[0+g]=this.reg[0+g];l.TwosComplement(c.reg,0,c.reg.length|0);l.ShiftWordsLeftByWords(c.reg,0,e+f,f);l.ShiftWordsLeftByBits(c.reg,f|0,e+l.BitsToWords(d),d);l.TwosComplement(c.reg,
0,c.reg.length|0)}else{c.negative=!1;c.reg=[];for(var g=0;g<l.RoundupSize(e+l.BitsToWords(b|0));g++)c.reg[g]=0;for(g=0;g<e;g++)c.reg[0+g]=this.reg[0+g];l.ShiftWordsLeftByWords(c.reg,0,e+f,f);l.ShiftWordsLeftByBits(c.reg,f|0,e+l.BitsToWords(d),d)}c.wordCount=c.CalcWordCount();return c};m.shiftRight=function(b){if(0==b)return this;if(0>b)return-2147483648==b?this.shiftLeft(1).shiftLeft(2147483647):this.shiftLeft(-b);var c=new l,e=this.wordCount|0,f=b>>4|0;b&=15;c.negative=this.negative;c.reg=[];for(var d=
0;d<l.RoundupSize(e);d++)c.reg[d]=0;for(d=0;d<e;d++)c.reg[0+d]=this.reg[0+d];0>this.signum()?(l.TwosComplement(c.reg,0,c.reg.length|0),l.ShiftWordsRightByWordsSignExtend(c.reg,0,e,f),e>f&&l.ShiftWordsRightByBitsSignExtend(c.reg,0,e-f,b),l.TwosComplement(c.reg,0,c.reg.length|0)):(l.ShiftWordsRightByWords(c.reg,0,e,f),e>f&&l.ShiftWordsRightByBits(c.reg,0,e-f,b));c.wordCount=c.CalcWordCount();return c};n.valueOf=function(b){var c=q.createLong(b);if(0==c.signum())return l.ZERO;if(c.equalsInt(1))return l.ONE;
b=new l;b.negative=0>c.signum();b.reg=[0,0,0,0];if(c.equals(q.LONG_MIN_VALUE()))b.reg[0]=0,b.reg[1]=0,b.reg[2]=0,b.reg[3]=32768,b.wordCount=4;else for(0>c.signum()&&(c=c.negate()),b.reg[0]=c.andInt(65535).shortValue()&65535|0,c=c.shiftRight(16),b.reg[1]=c.andInt(65535).shortValue()&65535|0,c=c.shiftRight(16),b.reg[2]=c.andInt(65535).shortValue()&65535|0,c=c.shiftRight(16),b.reg[3]=c.andInt(65535).shortValue()&65535|0,b.wordCount=4;0!=b.wordCount&&0==b.reg[b.wordCount-1];)b.wordCount--;return b};m.intValue=
function(){var b=this.wordCount|0;if(0==b)return 0;if(2<b)throw"exception";if(2==b&&0!=(this.reg[1]&32768)){if(0==(this.reg[1]&32767|0|this.reg[0])&&this.negative)return-2147483648;throw"exception";}var c=this.reg[0]&65535;1<b&&(c|=(this.reg[1]&65535)<<16);this.negative&&(c=-c);return c};m.HasTinyValue=function(){var b=this.wordCount|0;return 2<b?!1:2==b&&0!=(this.reg[1]&32768)?this.negative&&32768==this.reg[1]&&0==this.reg[0]:!0};m.HasSmallValue=function(){var b=this.wordCount|0;return 4<b?!1:4==
b&&0!=(this.reg[3]&32768)?this.negative&&32768==this.reg[3]&&0==this.reg[2]&&0==this.reg[1]&&0==this.reg[0]:!0};m.longValue=function(){var b=this.wordCount;if(0==b)return q.createLong(0);if(4<b)throw"exception";if(4==b&&0!=(this.reg[3]&32768)){if(this.negative&&32768==this.reg[3]&&0==this.reg[2]&&0==this.reg[1]&&0==this.reg[0])return q.LONG_MIN_VALUE();throw"exception";}var c=(this.reg[0]|0)&65535,e=q.createLong(c);1<b&&(c=(this.reg[1]|0)&65535,e=e.or(q.createLong(c).shiftLeft(16)));2<b&&(c=(this.reg[2]|
0)&65535,e=e.or(q.createLong(c).shiftLeft(32)));3<b&&(c=(this.reg[3]|0)&65535,e=e.or(q.createLong(c).shiftLeft(48)));this.negative&&(e=e.negate());return e};n.Power2=function(b){var c=(new l).Allocate(l.BitsToWords(b+1|0));c.SetBitInternal(b|0,!0);return c};m.PowBigIntVar=function(b){if(null==b)throw"power";var c=b.signum();if(0>c)throw"power is negative";var e=this;if(0==c)return l.ONE;if(b.equals(l.ONE))return this;if(1==b.wordCount&&2==b.reg[0])return e.multiply(e);if(1==b.wordCount&&3==b.reg[0])return e.multiply(e).multiply(e);
for(c=l.ONE;0!=b.signum();)b.testBit(0)&&(c=c.multiply(e)),b=b.shiftRight(1),0!=b.signum()&&(e=e.multiply(e));return c};m.pow=function(b){if(0>b)throw"power is negative";var c=this;if(0==b)return l.ONE;if(1==b)return this;if(2==b)return c.multiply(c);if(3==b)return c.multiply(c).multiply(c);for(var e=l.ONE;0!=b;)0!=(b&1)&&(e=e.multiply(c)),b>>=1,0!=b&&(c=c.multiply(c));return e};m.negate=function(){var b=new l;b.reg=this.reg;b.wordCount=this.wordCount;b.negative=0!=this.wordCount&&!this.negative;
return b};m.abs=function(){return 0<=this.signum()?this:this.negate()};m.CalcWordCount=function(){return l.CountWords(this.reg,this.reg.length)|0};m.ByteCount=function(){var b=this.wordCount;if(0==b)return 0;var c=this.reg[b-1],b=b-1<<1;return 0==c?b:0==c>>8?b+1:b+2};m.BitLength=function(){var b=this.wordCount;return 0!=b?16*(b-1)+l.BitPrecision(this.reg[b-1])|0:0};n.vec="0123456789ABCDEF";n.ReverseChars=function(b,c,e){var f=e>>1;e=c+e-1;for(var d=0;d<f;d++,e--){var g=b[c+d];b[c+d]=b[e];b[e]=g}};
m.SmallValueToString=function(){var b=this.longValue();if(b.equals(q.LONG_MIN_VALUE()))return"-9223372036854775808";var c=0>b.signum(),e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=0;c&&(e[0]="-",f++,b=b.negate());for(;0!=b.signum();){var d=l.vec.charAt(b.remainderWithUnsignedDivisor(10).intValue());e[f++]=d;b=b.divideWithUnsignedDivisor(10)}c?l.ReverseChars(e,1,f-1):l.ReverseChars(e,0,f);b=q.createStringBuilder(16);for(c=0;c<f;c++)b.append(e[c]);return b.toString()};m.toString=function(){if(0==
this.signum())return"0";if(this.HasSmallValue())return this.SmallValueToString();for(var b=[],c=0;c<this.wordCount;c++)b[c]=0;for(c=0;c<b.length;c++)b[0+c]=this.reg[0+c];for(var e=b.length;0!=e&&0==b[e-1];)e--;for(var f=0,d=[],c=0;c<(this.BitLength()/3|0)+1;c++)d[c]=0;for(;0!=e;)if(1==e&&0<b[0]&&1E4>b[0]){for(b=b[0];0!=b;)d[f++]=l.vec.charAt(b%10),b=b/10|0;break}else{for(c=l.FastDivideAndRemainder(b,e,1E4);0!=e&&0==b[e-1];)e--;for(var g=0;4>g;g++)d[f++]=l.vec.charAt(c%10|0),c=c/10|0}l.ReverseChars(d,
0,f);if(0>this.signum()){b=q.createStringBuilder(f+1);b.append("-");for(c=0;c<0+f;c++)b.append(d[c]);return b.toString()}b=q.createStringBuilder(16);for(c=0;c<f;c++)b.append(d[c]);return b.toString()};n.fromString=function(b){if(null==b)throw"str";if(0>=b.length)throw"str.length not less than 0 ("+q.createLong(b.length)+")";var c=0,e=!1;"-"==b.charAt(0)&&(c++,e=!0);for(var f=(new l).Allocate(4),d=!1;c<b.length;c++){var g=b.charAt(c);if("0">g||"9"<g)throw"Illegal character found";var d=!0,g=g-48|0,
a=l.LinearMultiply(f.reg,0,f.reg,0,10,f.reg.length);0!=a&&(f.reg=l.GrowForCarry(f.reg,a));0!=g&&0!=l.Increment(f.reg,0,f.reg.length,g|0)&&(f.reg=l.GrowForCarry(f.reg,1))}if(!d)throw"No digits";f.wordCount=f.CalcWordCount();f.negative=0!=f.wordCount&&e;return f};m.gcd=function(b){if(null==b)throw"bigintSecond";if(0==this.signum())return b.abs();if(0==b.signum())return this.abs();var c=this.abs();b=b.abs();if(b.equals(l.ONE)||c.equals(b))return b;if(c.equals(l.ONE))return c;for(var e;0!=c.signum();)0>
c.compareTo(b)&&(e=c,c=b,b=e),c=c.remainder(b);return b};m.ModPow=function(b,c){if(null==b)throw"pow";if(0>b.signum())throw"pow is negative";for(var e=l.ONE,f=this;0!=b.signum();)b.testBit(0)&&(e=e.multiply(f).remainder(c)),b=b.shiftRight(1),0!=b.signum()&&(f=f.multiply(f).remainder(c));return e};n.PositiveAdd=function(b,c,e){var f,d=c.reg.length>e.reg.length?c.reg.length:e.reg.length;if(c.reg.length==e.reg.length)f=l.Add(b.reg,0,c.reg,0,e.reg,0,c.reg.length|0);else if(c.reg.length>e.reg.length){f=
l.Add(b.reg,0,c.reg,0,e.reg,0,e.reg.length|0);for(var g=0;g<c.reg.length-e.reg.length;g++)b.reg[e.reg.length+g]=c.reg[e.reg.length+g];f=l.Increment(b.reg,e.reg.length,c.reg.length-e.reg.length|0,f|0)}else{f=l.Add(b.reg,0,c.reg,0,e.reg,0,c.reg.length|0);for(g=0;g<e.reg.length-c.reg.length;g++)b.reg[c.reg.length+g]=e.reg[c.reg.length+g];f=l.Increment(b.reg,c.reg.length,e.reg.length-c.reg.length|0,f|0)}0!=f&&(c=l.RoundupSize(d+1),b.reg=l.CleanGrow(b.reg,c),b.reg[d]=f&65535);b.negative=!1;b.wordCount=
b.CalcWordCount();b.ShortenArray()};n.PositiveSubtract=function(b,c,e){var f=c.wordCount,f=f+f%2,d=e.wordCount,d=d+d%2;if(f==d)0<=l.Compare(c.reg,0,e.reg,0,f|0)?(l.Subtract(b.reg,0,c.reg,0,e.reg,0,f|0),b.negative=!1):(l.Subtract(b.reg,0,e.reg,0,c.reg,0,f|0),b.negative=!0);else if(f>d){for(var g=l.Subtract(b.reg,0,c.reg,0,e.reg,0,d|0)|0,a=0;a<f-d;a++)b.reg[d+a]=c.reg[d+a];l.Decrement(b.reg,d,f-d|0,g);b.negative=!1}else{g=l.Subtract(b.reg,0,e.reg,0,c.reg,0,f|0)|0;for(a=0;a<d-f;a++)b.reg[f+a]=e.reg[f+
a];l.Decrement(b.reg,f,d-f|0,g);b.negative=!0}b.wordCount=b.CalcWordCount();b.ShortenArray();0==b.wordCount&&(b.negative=!1)};m.equals=function(b){b=b.constructor==l?b:null;return null==b?!1:0==b.compareTo(this)};m.hashCode=function(){var b;b=0+1000000007*this.signum();if(null!=this.reg)for(var c=0;c<this.wordCount;c++)b+=1000000013*this.reg[c];return b};m.add=function(b){if(null==b)throw"bigintAugend";var c=(new l).Allocate((this.reg.length>b.reg.length?this.reg.length:b.reg.length)|0);0<=this.signum()?
0<=b.signum()?l.PositiveAdd(c,this,b):l.PositiveSubtract(c,this,b):0<=b.signum()?l.PositiveSubtract(c,b,this):(l.PositiveAdd(c,this,b),c.negative=0!=c.signum());return c};m.subtract=function(b){if(null==b)throw"subtrahend";var c=(new l).Allocate((this.reg.length>b.reg.length?this.reg.length:b.reg.length)|0);0<=this.signum()?0<=b.signum()?l.PositiveSubtract(c,this,b):l.PositiveAdd(c,this,b):0<=b.signum()?(l.PositiveAdd(c,this,b),c.negative=0!=c.signum()):l.PositiveSubtract(c,b,this);return c};m.ShortenArray=
function(){if(32<this.reg.length){var b=l.RoundupSize(this.wordCount);if(b<this.reg.length&&16<=this.reg.length-b){for(var c=[],e=0;e<b;e++)c[e]=0;for(e=0;e<(b<this.reg.length?b:this.reg.length);e++)c[0+e]=this.reg[0+e];this.reg=c}}};n.PositiveMultiply=function(b,c,e){if(1==c.wordCount){var f=e.wordCount;b.reg=[];for(var d=0;d<l.RoundupSize(f+1);d++)b.reg[d]=0;b.reg[f]=l.LinearMultiply(b.reg,0,e.reg,0,c.reg[0],f)&65535;b.negative=!1;b.wordCount=b.CalcWordCount()}else if(1==e.wordCount){f=c.wordCount;
b.reg=[];for(d=0;d<l.RoundupSize(f+1);d++)b.reg[d]=0;b.reg[f]=l.LinearMultiply(b.reg,0,c.reg,0,e.reg[0],f)&65535;b.negative=!1;b.wordCount=b.CalcWordCount()}else{if(c.equals(e)){f=l.RoundupSize(c.wordCount);b.reg=[];for(d=0;d<l.RoundupSize(f+f);d++)b.reg[d]=0;b.negative=!1;for(var g=[],d=0;d<f+f;d++)g[d]=0;l.Square(b.reg,0,g,0,c.reg,0,f)}else{var f=l.RoundupSize(c.wordCount),a=l.RoundupSize(e.wordCount);b.reg=[];for(d=0;d<l.RoundupSize(f+a);d++)b.reg[d]=0;b.negative=!1;g=[];for(d=0;d<f+a;d++)g[d]=
0;l.AsymmetricMultiply(b.reg,0,g,0,c.reg,0,f,e.reg,0,a)}b.wordCount=b.CalcWordCount();b.ShortenArray()}};m.multiply=function(b){if(null==b)throw"bigintMult";var c=new l;if(0==this.wordCount||0==b.wordCount)return l.ZERO;if(1==this.wordCount&&1==this.reg[0])return this.negative?b.negate():b;if(1==b.wordCount&&1==b.reg[0])return b.negative?this.negate():this;l.PositiveMultiply(c,this,b);0<=this.signum()!=0<=b.signum()&&c.NegateInternal();return c};n.OperandLength=function(b){for(var c=b.length-1;0<=
c;c--)if(0!=b[c])return c+1;return 0};n.DivideWithRemainderAnyLength=function(b,c,e,f){var d=l.OperandLength(b),g=l.OperandLength(c);if(0==g)throw"The divisor is zero.";if(0==d){if(null!=f)for(var a=0;a<0+f.length;a++)f[a]=0;if(null!=e)for(a=0;a<0+e.length;a++)e[a]=0}else if(d<g){if(null!=f){c=[];for(a=0;a<b.length;a++)c[a]=0;for(a=0;a<b.length;a++)c[0+a]=b[0+a];for(a=0;a<0+f.length;a++)f[a]=0;for(a=0;a<(c.length<f.length?c.length:f.length);a++)f[0+a]=c[0+a]}if(null!=e)for(a=0;a<0+e.length;a++)e[a]=
0}else if(1==d&&1==g){b=(b[0]|0)&65535;c=(c[0]|0)&65535;if(null!=e){for(a=0;a<0+e.length;a++)e[a]=0;e[0]=(b/c|0)&65535}if(null!=f){for(a=0;a<0+f.length;a++)f[a]=0;f[0]=(null!=f?b%c|0:0)&65535}}else{d+=d%2;if(d>b.length)throw"no room";g+=g%2;if(g>c.length)throw"no room";for(var h=[],a=0;a<d+3*(g+2);a++)h[a]=0;l.Divide(f,0,e,0,h,0,b,0,d,c,0,g);if(null!=e)for(a=f=d-g+2;a<f+(e.length-f);a++)e[a]=0}};n.BitsToWords=function(b){return(b+16-1)/16|0};n.FastRemainder=function(b,c,e){for(var f=0;0<c--;)f=l.RemainderUnsigned(l.MakeUint(b[c],
f),e);return f};n.FastDivide=function(b,c,e){for(var f=0,d=e&65535;0<c--;){var g=b[c]&65535|(f|0)<<16|0;0==g>>31?(b[c]=(g/d|0)&65535|0,0<c&&(f=g%d|0)):(b[c]=l.DivideUnsigned(g,e)&65535,0<c&&(f=l.RemainderUnsigned(g,e)))}};n.FastDivideAndRemainder=function(b,c,e){for(var f=0,d=e&65535;0<c--;)f=b[c]&65535|(f|0)<<16|0,0==f>>31?(b[c]=(f/d|0)&65535|0,f=f%d|0):(b[c]=l.DivideUnsigned(f,e)&65535,f=l.RemainderUnsigned(f,e));return f};m.divide=function(b){if(null==b)throw"bigintDivisor";var c=this.wordCount,
e=b.wordCount;if(0==e)throw"exception";if(c<e)return l.ZERO;if(4>=c&&4>=e&&this.HasTinyValue()&&b.HasTinyValue()){var f=this.intValue(),d=b.intValue();if(-2147483648!=f||-1!=d)return b=f/d|0,(new l).InitializeInt(b)}if(1==e){f=new l;f.reg=[];for(d=0;d<this.reg.length;d++)f.reg[d]=0;f.wordCount=this.wordCount;f.negative=this.negative;for(d=0;d<f.reg.length;d++)f.reg[0+d]=this.reg[0+d];l.FastDivide(f.reg,c,b.reg[0]);f.wordCount=f.CalcWordCount();f.negative=0!=f.wordCount?0>this.signum()^0>b.signum():
!1;return f}f=new l;c+=c%2;e+=e%2;f.reg=[];for(d=0;d<l.RoundupSize(c-e+2|0);d++)f.reg[d]=0;f.negative=!1;l.DivideWithRemainderAnyLength(this.reg,b.reg,f.reg,null);f.wordCount=f.CalcWordCount();f.ShortenArray();0>this.signum()^0>b.signum()&&f.NegateInternal();return f};m.divideAndRemainder=function(b){if(null==b)throw"divisor";var c,e=this.wordCount,f=b.wordCount;if(0==f)throw"exception";if(e<f)return[l.ZERO,this];if(1==f){c=new l;c.reg=[];for(var d=0;d<this.reg.length;d++)c.reg[d]=0;c.wordCount=this.wordCount;
c.negative=this.negative;for(d=0;d<c.reg.length;d++)c.reg[0+d]=this.reg[0+d];e=l.FastDivideAndRemainder(c.reg,e,b.reg[0])&65535;c.wordCount=c.CalcWordCount();c.ShortenArray();c.negative=0!=c.wordCount?0>this.signum()^0>b.signum():!1;0>this.signum()&&(e=-e);return[c,(new l).InitializeInt(e)]}var g=new l;c=new l;e+=e%2;f+=f%2;g.reg=[];for(d=0;d<l.RoundupSize(f|0);d++)g.reg[d]=0;g.negative=!1;c.reg=[];for(d=0;d<l.RoundupSize(e-f+2|0);d++)c.reg[d]=0;c.negative=!1;l.DivideWithRemainderAnyLength(this.reg,
b.reg,c.reg,g.reg);g.wordCount=g.CalcWordCount();c.wordCount=c.CalcWordCount();g.ShortenArray();c.ShortenArray();0>this.signum()&&(c.NegateInternal(),0!=g.signum()&&g.NegateInternal());0>b.signum()&&c.NegateInternal();return[c,g]};m.mod=function(b){if(null==b)throw"divisor";if(0>b.signum())throw"Divisor is negative";var c=this.remainder(b);0>c.signum()&&(c=b.subtract(c));return c};m.remainder=function(b){if(0>this.PositiveCompare(b)){if(0==b.signum())throw"exception";return this}var c=new l,e=this.wordCount,
f=b.wordCount;if(0==f)throw"exception";if(e<f)return this;if(1==f)return b=l.FastRemainder(this.reg,this.wordCount,b.reg[0])&65535,0>this.signum()&&(b=-b),(new l).InitializeInt(b);e+=e%2;f+=f%2;c.reg=[];for(var d=0;d<l.RoundupSize(f|0);d++)c.reg[d]=0;c.negative=!1;for(var g=[],d=0;d<l.RoundupSize(e-f+2|0);d++)g[d]=0;l.DivideWithRemainderAnyLength(this.reg,b.reg,g,c.reg);c.wordCount=c.CalcWordCount();c.ShortenArray();0>this.signum()&&0!=c.signum()&&c.NegateInternal();return c};m.NegateInternal=function(){0!=
this.wordCount&&(this.negative=0<this.signum())};m.PositiveCompare=function(b){var c=this.wordCount,e=b.wordCount;return c==e?l.Compare(this.reg,0,b.reg,0,c|0):c>e?1:-1};m.compareTo=function(b){if(null==b)return 1;if(this==b)return 0;var c=this.wordCount,e=b.wordCount,f=0==c?0:this.negative?-1:1,d=0==e?0:b.negative?-1:1;if(f!=d)return f<d?-1:1;if(0==f)return 0;d=0;if(c==e){if(1==c&&this.reg[0]==b.reg[0])return 0;d=l.Compare(this.reg,0,b.reg,0,c|0)}else d=c>e?1:-1;return 0<f?d:-d};m.signum=function(){return 0==
this.wordCount?0:this.negative?-1:1};m.isZero=function(){return 0==this.wordCount};m.Sqrt=function(b){if(0>this.signum())return l.ZERO;var c=null,e=l.Power2((this.BitLength()+1)/2|0);do c=e,e=b.divide(c),e=e.add(c),e=e.shiftRight(1);while(0>e.compareTo(c));return c};m.isEven=function(){return!this.GetUnsignedBit(0)};n.ZERO=(new l).InitializeInt(0);n.ONE=(new l).InitializeInt(1);n.TEN=(new l).InitializeInt(10)})(l,l.prototype);"undefined"!==typeof exports&&(exports.BigInteger=l);var p=function(l){this.smallValue=
l};(function(n,m){n.MutableNumber=function(b){if(0>b)throw"Only positive integers are supported";this.data=[0,0,0,0];this.wordCount=0==b?0:1;this.data[0]=b&4294967295|0};(function(b,c){c.data=null;c.wordCount=null;b.FromBigInteger=function(b){var c=new p.MutableNumber(0);if(0>b.signum())throw"Only positive integers are supported";b=b.toByteArray(!0);var d=b.length,g=4>(d/4|0)+1?4:(d/4|0)+1;if(g>c.data.length){c.data=[];for(var a=0;a<g;a++)c.data[a]=0}c.wordCount=g;for(g=0;g<d;g+=4)a=(b[g]|0)&255,
g+1<d&&(a|=(b[g+1]&255)<<8),g+2<d&&(a|=(b[g+2]&255)<<16),g+3<d&&(a|=(b[g+3]&255)<<24),c.data[g>>2]=a;for(;0!=c.wordCount&&0==c.data[c.wordCount-1];)c.wordCount--;return c};c.ToBigInteger=function(){if(1==this.wordCount&&0==this.data[0]>>31)return l.valueOf(this.data[0]|0);for(var b=[],c=0;c<4*this.wordCount+1;c++)b[c]=0;for(c=0;c<this.wordCount;c++)b[4*c+0]=this.data[c]&255,b[4*c+1]=this.data[c]>>8&255,b[4*c+2]=this.data[c]>>16&255,b[4*c+3]=this.data[c]>>24&255;b[b.length-1]=0;return l.fromByteArray(b,
!0)};c.GetLastWordsInternal=function(b){for(var c=[],d=0;d<b;d++)c[d]=0;for(d=0;d<(b<this.wordCount?b:this.wordCount);d++)c[0+d]=this.data[0+d];return c};c.CanFitInInt32=function(){return 0==this.wordCount||1==this.wordCount&&0==this.data[0]>>31};c.ToInt32=function(){return 0==this.wordCount?0:this.data[0]};c.Copy=function(){var b=new p.MutableNumber(0);if(this.wordCount>b.data.length){b.data=[];for(var c=0;c<this.wordCount;c++)b.data[c]=0}for(c=0;c<this.wordCount;c++)b.data[0+c]=this.data[0+c];b.wordCount=
this.wordCount;return b};c.Multiply=function(b){if(0>b)throw"Only positive multiplicands are supported";if(0!=b){var c=0;0==this.wordCount&&(0==this.data.length&&(this.data=[0,0,0,0]),this.data[0]=0,this.wordCount=1);var d,g,a,h;if(65536>b)for(var k=0;k<this.wordCount;k++){var l=this.data[k],m=l;h=b;var l=l&65535,m=m>>>16,n=l*h;g=n>>>16;d=n&65535;a=0;n=m*h;a+=n>>>16;g+=n&65535;a+=g>>>16;g&=65535;h=a>>>16;a&=65535;l=d|g<<16|0;m=a|h<<16|0;c=l+c;if(c>>31==l>>31?(c&2147483647)<(l&2147483647):0==c>>31)m+=
1;this.data[k]=c;c=m}else for(k=0;k<this.wordCount;k++){var m=l=this.data[k],p=h=b,l=l&65535;h&=65535;m>>>=16;p>>>=16;n=l*h;g=n>>>16;d=n&65535;n=l*p;a=n>>>16;g+=n&65535;a+=g>>>16;g&=65535;n=m*h;a+=n>>>16;g+=n&65535;a+=g>>>16;g&=65535;h=a>>>16;a&=65535;n=m*p;h+=n>>>16;a+=n&65535;h+=a>>>16;a&=65535;l=d|g<<16|0;m=a|h<<16|0;c=l+c;if(c>>31==l>>31?(c&2147483647)<(l&2147483647):0==c>>31)m+=1;this.data[k]=c;c=m}if(0!=c){if(this.wordCount>=this.data.length){b=[];for(k=0;k<this.wordCount+20;k++)b[k]=0;for(k=
0;k<this.data.length;k++)b[0+k]=this.data[0+k];this.data=b}this.data[this.wordCount]=c;this.wordCount++}for(;0!=this.wordCount&&0==this.data[this.wordCount-1];)this.wordCount--}else 0<this.data.length&&(this.data[0]=0),this.wordCount=0;return this};c.signum=function(){return 0==this.wordCount?0:1};c.isEvenNumber=function(){return 0==this.wordCount||0==(this.data[0]&1)};c.CompareToInt=function(b){return 0>b||1<this.wordCount?1:0==this.wordCount?0==b?0:-1:this.data[0]==b?0:(this.data[0]>>31==b>>31?
(this.data[0]&2147483647)<(b&2147483647):0==this.data[0]>>31)?-1:1};c.SubtractInt=function(b){if(0>b)throw"Only positive values are supported";if(0!=b){0==this.wordCount&&(0==this.data.length&&(this.data=[0,0,0,0]),this.data[0]=0,this.wordCount=1);var c,d=this.data[0];c=d-b;b=(d>>31==c>>31?(d&2147483647)<(c&2147483647):0==d>>31)||d==c&&0!=b?1:0;this.data[0]=c|0;if(0!=b)for(d=1;d<this.wordCount;d++)c=this.data[d]-b,b=(this.data[d]>>31==c>>31?(this.data[d]&2147483647)<(c&2147483647):0==this.data[d]>>
31)?1:0,this.data[d]=c|0;for(;0!=this.wordCount&&0==this.data[this.wordCount-1];)this.wordCount--}return this};c.Subtract=function(b){var c=this.wordCount>b.wordCount?this.wordCount:b.wordCount;if(this.data.length<c){for(var d=[],g=0;g<c+20;g++)d[g]=0;for(g=0;g<this.data.length;g++)d[0+g]=this.data[0+g];this.data=d}for(var c=this.wordCount<b.wordCount?this.wordCount:b.wordCount,a=g=d=0;a<c;a++){var h=this.data[a],d=h-b.data[a]-g,g=(h>>31==d>>31?(h&2147483647)<(d&2147483647):0==h>>31)||h==d&&0!=b.data[a]?
1:0;this.data[a]=d|0}if(0!=g)for(a=c;a<this.wordCount;a++)h=this.data[a],d=h-b.data[a]-g,g=(h>>31==d>>31?(h&2147483647)<(d&2147483647):0==h>>31)||h==d&&0!=b.data[a]?1:0,this.data[a]=d|0;for(;0!=this.wordCount&&0==this.data[this.wordCount-1];)this.wordCount--;return this};c.compareTo=function(b){if(this.wordCount!=b.wordCount)return this.wordCount<b.wordCount?-1:1;for(var c=this.wordCount;0!=c--;){var d=this.data[c],g=b.data[c];if(d>>31==g>>31?(d&2147483647)<(g&2147483647):0==d>>31)return-1;if(d!=
g)return 1}return 0};c.Add=function(b){if(0>b)throw"Only positive augends are supported";if(0!=b){var c=0;0==this.wordCount&&(0==this.data.length&&(this.data=[0,0,0,0]),this.data[0]=0,this.wordCount=1);for(var d=0;d<this.wordCount;d++){var g,a=this.data[d];g=a+b+c;c=(g>>31==a>>31?(g&2147483647)<(a&2147483647):0==g>>31)||g==a&&0!=b?1:0;this.data[d]=g;if(0==c)return this;b=0}if(0!=c){if(this.wordCount>=this.data.length){b=[];for(d=0;d<this.wordCount+20;d++)b[d]=0;for(d=0;d<this.data.length;d++)b[0+
d]=this.data[0+d];this.data=b}this.data[this.wordCount]=c;this.wordCount++}}for(;0!=this.wordCount&&0==this.data[this.wordCount-1];)this.wordCount--;return this}})(p.MutableNumber,p.MutableNumber.prototype);m.smallValue=null;m.mnum=null;m.largeValue=null;m.integerMode=0;n.Int32MinValue=l.valueOf(-2147483648);n.Int32MaxValue=l.valueOf(2147483647);n.NegativeInt32MinValue=p.Int32MinValue.negate();n.Copy=function(b){var c=new p(b.smallValue);c.integerMode=b.integerMode;c.largeValue=b.largeValue;c.mnum=
null==b.mnum||1!=b.integerMode?null:b.mnum.Copy();return c};n.FromBig=function(b){var c=b.signum();if(0==c||0>c&&0<=b.compareTo(p.Int32MinValue)||0<c&&0>=b.compareTo(p.Int32MaxValue))return new p(b.intValue());0<c?(c=new p(0),c.integerMode=1,c.mnum=p.MutableNumber.FromBigInteger(b)):(c=new p(0),c.integerMode=2,c.largeValue=b);return c};m.AsInt32=function(){switch(this.integerMode){case 0:return this.smallValue;case 1:return this.mnum.ToInt32();case 2:return this.largeValue.intValue();default:throw"exception";
}};m.compareTo=function(b){switch(this.integerMode<<2|b.integerMode){case 0:return b=b.smallValue,this.smallValue==b?0:this.smallValue<b?-1:1;case 1:return-b.mnum.CompareToInt(this.smallValue);case 2:return this.AsBigInteger().compareTo(b.largeValue);case 4:return this.mnum.CompareToInt(b.smallValue);case 5:return this.mnum.compareTo(b.mnum);case 6:return this.AsBigInteger().compareTo(b.largeValue);case 8:case 9:case 10:return this.largeValue.compareTo(b.AsBigInteger());default:throw"exception";}};
m.Abs=function(){return 0>this.signum()?this.Negate():this};n.WordsToBigInteger=function(b){var c=b.length;if(1==c&&0==b[0]>>31)return l.valueOf(b[0]|0);for(var e=[],f=0;f<4*c+1;f++)e[f]=0;for(f=0;f<c;f++)e[4*f+0]=b[f]&255,e[4*f+1]=b[f]>>8&255,e[4*f+2]=b[f]>>16&255,e[4*f+3]=b[f]>>24&255;e[e.length-1]=0;return l.fromByteArray(e,!0)};n.GetLastWords=function(b,c){return p.MutableNumber.FromBigInteger(b).GetLastWordsInternal(c)};m.Multiply=function(b){if(0==b)this.integerMode=this.smallValue=0;else switch(this.integerMode){case 0:var c=
0<this.smallValue,e=0<b;c&&(!e&&(-2147483648/this.smallValue|0)>b||e&&this.smallValue>(2147483647/b|0))||!c&&(!e&&0!=this.smallValue&&(2147483647/this.smallValue|0)>b||e&&this.smallValue<(-2147483648/b|0))?c&&e?(this.integerMode=1,this.mnum=new p.MutableNumber(this.smallValue),this.mnum.Multiply(b)):(this.integerMode=2,this.largeValue=l.valueOf(this.smallValue),this.largeValue=this.largeValue.multiply(l.valueOf(b))):this.smallValue*=b|0;break;case 1:0>b?(this.integerMode=2,this.largeValue=this.mnum.ToBigInteger(),
this.largeValue=this.largeValue.multiply(l.valueOf(b))):this.mnum.Multiply(b);break;case 2:this.largeValue=this.largeValue.multiply(l.valueOf(b));break;default:throw"exception";}return this};m.Negate=function(){switch(this.integerMode){case 0:-2147483648==this.smallValue?(this.integerMode=1,this.mnum=p.MutableNumber.FromBigInteger(p.NegativeInt32MinValue)):this.smallValue=-this.smallValue;break;case 1:this.integerMode=2;this.largeValue=this.mnum.ToBigInteger();this.largeValue=this.largeValue.negate();
break;case 2:this.largeValue=this.largeValue.negate();break;default:throw"exception";}return this};m.Subtract=function(b){switch(this.integerMode){case 0:0==b.integerMode?(b=b.smallValue,0>b&&2147483647+b<this.smallValue||0<b&&-2147483648+b>this.smallValue?(this.integerMode=2,this.largeValue=l.valueOf(this.smallValue),this.largeValue=this.largeValue.subtract(l.valueOf(b))):this.smallValue-=b):(this.integerMode=2,this.largeValue=l.valueOf(this.smallValue),b=b.AsBigInteger(),this.largeValue=this.largeValue.subtract(b));
break;case 1:1==b.integerMode?this.mnum.Subtract(b.mnum):0==b.integerMode&&0<=b.smallValue?this.mnum.SubtractInt(b.smallValue):(this.integerMode=2,this.largeValue=this.mnum.ToBigInteger(),b=b.AsBigInteger(),this.largeValue=this.largeValue.subtract(b));break;case 2:b=b.AsBigInteger();this.largeValue=this.largeValue.subtract(b);break;default:throw"exception";}return this};m.SubtractInt=function(b){return-2147483648==b?this.AddBig(p.NegativeInt32MinValue):this.AddInt(-b)};m.AddBig=function(b){switch(this.integerMode){case 0:var c=
b.signum();return 0==c||0>c&&0<=b.compareTo(p.Int32MinValue)||0<c&&0>=b.compareTo(p.Int32MaxValue)?this.AddInt(b.intValue()):this.Add(p.FromBig(b));case 1:this.integerMode=2;this.largeValue=this.mnum.ToBigInteger();this.largeValue=this.largeValue.add(b);break;case 2:this.largeValue=this.largeValue.add(b);break;default:throw"exception";}return this};m.SubtractBig=function(b){if(2==this.integerMode)return this.largeValue=this.largeValue.subtract(b),this;var c=b.signum();if(0==c)return this;if(0>c&&
0<b.compareTo(p.Int32MinValue))return this.AddInt(-b.intValue());if(0<c&&0>=b.compareTo(p.Int32MaxValue))return this.SubtractInt(b.intValue());b=b.negate();return this.AddBig(b)};m.Add=function(b){switch(this.integerMode){case 0:0==b.integerMode?0>this.smallValue&&(b.smallValue|0)<-2147483648-this.smallValue||0<this.smallValue&&(b.smallValue|0)>2147483647-this.smallValue?0<=b.smallValue?(this.integerMode=1,this.mnum=new p.MutableNumber(this.smallValue),this.mnum.Add(b.smallValue)):(this.integerMode=
2,this.largeValue=l.valueOf(this.smallValue),this.largeValue=this.largeValue.add(l.valueOf(b.smallValue))):this.smallValue+=b.smallValue:(this.integerMode=2,this.largeValue=l.valueOf(this.smallValue),b=b.AsBigInteger(),this.largeValue=this.largeValue.add(b));break;case 1:0==b.integerMode&&0<=b.smallValue?this.mnum.Add(b.smallValue):(this.integerMode=2,this.largeValue=this.mnum.ToBigInteger(),b=b.AsBigInteger(),this.largeValue=this.largeValue.add(b));break;case 2:b=b.AsBigInteger();this.largeValue=
this.largeValue.add(b);break;default:throw"exception";}return this};m.Mod=function(b){if(0!=b)switch(this.integerMode){case 0:this.smallValue%=b;break;case 1:this.largeValue=this.mnum.ToBigInteger();this.largeValue=this.largeValue.remainder(l.valueOf(b));this.smallValue=this.largeValue.intValue();this.integerMode=0;break;case 2:this.largeValue=this.largeValue.remainder(l.valueOf(b));this.smallValue=this.largeValue.intValue();this.integerMode=0;break;default:throw"exception";}else throw"exception";
return this};m.Divide=function(b){if(0!=b)switch(this.integerMode){case 0:-1==b&&-2147483648==this.smallValue?(this.integerMode=1,this.mnum=p.MutableNumber.FromBigInteger(p.NegativeInt32MinValue)):this.smallValue=this.smallValue/b|0;break;case 1:this.integerMode=2;this.largeValue=this.mnum.ToBigInteger();this.largeValue=this.largeValue.divide(l.valueOf(b));0==this.largeValue.signum()&&(this.smallValue=this.integerMode=0);break;case 2:this.largeValue=this.largeValue.divide(l.valueOf(b));0==this.largeValue.signum()&&
(this.smallValue=this.integerMode=0);break;default:throw"exception";}else throw"exception";return this};m.isEvenNumber=function(){switch(this.integerMode){case 0:return 0==(this.smallValue&1);case 1:return this.mnum.isEvenNumber();case 2:return!1==this.largeValue.testBit(0);default:throw"exception";}};m.AddInt=function(b){switch(this.integerMode){case 0:0>this.smallValue&&(b|0)<-2147483648-this.smallValue||0<this.smallValue&&(b|0)>2147483647-this.smallValue?0<=b?(this.integerMode=1,this.mnum=new p.MutableNumber(this.smallValue),
this.mnum.Add(b)):(this.integerMode=2,this.largeValue=l.valueOf(this.smallValue),this.largeValue=this.largeValue.add(l.valueOf(b))):this.smallValue+=b;break;case 1:0<=b?this.mnum.Add(b):(this.integerMode=2,this.largeValue=this.mnum.ToBigInteger(),b=l.valueOf(b),this.largeValue=this.largeValue.add(b));break;case 2:b=l.valueOf(b);this.largeValue=this.largeValue.add(b);break;default:throw"exception";}return this};m.CanFitInInt32=function(){var b;switch(this.integerMode){case 0:return!0;case 1:return this.mnum.CanFitInInt32();
case 2:return b=this.largeValue.signum(),0==b?!0:0>b?0<=this.largeValue.compareTo(p.Int32MinValue):0>=this.largeValue.compareTo(p.Int32MaxValue);default:throw"exception";}};m.toString=function(){switch(this.integerMode){case 0:return(this.smallValue|0)+"";case 1:return this.mnum.ToBigInteger().toString();case 2:return this.largeValue.toString();default:return""}};m.signum=function(){switch(this.integerMode){case 0:return 0==this.smallValue?0:0>this.smallValue?-1:1;case 1:return this.mnum.signum();
case 2:return this.largeValue.signum();default:return 0}};m.CompareToInt=function(b){switch(this.integerMode){case 0:return b==this.smallValue?0:this.smallValue<b?-1:1;case 1:return this.mnum.ToBigInteger().compareTo(l.valueOf(b));case 2:return this.largeValue.compareTo(l.valueOf(b));default:return 0}};m.MinInt32=function(b){return 0>this.CompareToInt(b)?this.AsInt32():b};m.AsBigInteger=function(){switch(this.integerMode){case 0:return l.valueOf(this.smallValue);case 1:return this.mnum.ToBigInteger();
case 2:return this.largeValue;default:throw"exception";}}})(p,p.prototype);var y=function(l,m,b){if(0>l.signum())throw"bigint is negative";this.shiftedBigInt=l;this.discardedBitCount=new p(0);this.bitsAfterLeftmost=0!=b?1:0;this.bitLeftmost=0!=m?1:0};(function(n,m){m.bitLeftmost=null;m.getLastDiscardedDigit=function(){return this.bitLeftmost};m.bitsAfterLeftmost=null;n.SmallBitLength=32;m.getOlderDiscardedDigits=function(){return this.bitsAfterLeftmost};m.shiftedBigInt=null;m.knownBitLength=null;
m.GetDigitLength=function(){null==this.knownBitLength&&(this.knownBitLength=this.CalcKnownBitLength());return p.Copy(this.knownBitLength)};m.ShiftToDigits=function(b){if(0>b.signum())throw"bits is negative";if(b.CanFitInInt32())this.ShiftToDigitsInt(b.AsInt32());else{this.knownBitLength=this.CalcKnownBitLength();var c=this.knownBitLength.AsBigInteger();b=b.AsBigInteger();c=c.subtract(b);0<c.signum()&&this.ShiftRight(p.FromBig(c))}};m.shiftedSmall=null;m.isSmall=null;m.getShiftedInt=function(){return this.isSmall?
l.valueOf(this.shiftedSmall):this.shiftedBigInt};m.getShiftedIntFast=function(){return this.isSmall?new p(this.shiftedSmall):p.FromBig(this.shiftedBigInt)};m.discardedBitCount=null;m.getDiscardedDigitCount=function(){return this.discardedBitCount};n.FromInt32=function(b){if(0>b)throw"longInt is negative";var c=new y(l.ZERO,0,0);c.shiftedSmall=b;c.discardedBitCount=new p(0);c.isSmall=!0;return c};m.ShiftRight=function(b){if(!(0>=b.signum()))if(b.CanFitInInt32())this.ShiftRightInt(b.AsInt32());else for(b=
b.AsBigInteger();0<b.signum();){var c=1E6;0>b.compareTo(l.valueOf(1E6))&&(c=b.intValue());this.ShiftRightInt(c);b=b.subtract(l.valueOf(c))}};m.ShiftRightBig=function(b){if(!(0>=b))if(0==this.shiftedBigInt.signum())this.discardedBitCount.AddInt(b),this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=0,this.knownBitLength=new p(1);else{var c=this.shiftedBigInt.toByteArray(!0);this.knownBitLength=y.ByteArrayBitLength(c);var e=new p(0),f=null;0>this.knownBitLength.CompareToInt(b)?(e=(new p(b)).Subtract(this.knownBitLength),
f=p.Copy(this.knownBitLength)):f=new p(b);if(0>=this.knownBitLength.CompareToInt(b))this.isSmall=!0,this.shiftedSmall=0,this.knownBitLength.Multiply(0).AddInt(1);else{for(var d=p.Copy(f);0<d.signum()&&0!=this.shiftedBigInt.signum();){var g=d.MinInt32(1E6);this.shiftedBigInt=this.shiftedBigInt.shiftRight(g);d.SubtractInt(g)}this.knownBitLength.Subtract(f)}this.discardedBitCount.AddInt(b);this.bitsAfterLeftmost|=this.bitLeftmost;for(b=0;b<c.length;b++)if(0<f.CompareToInt(8))this.bitsAfterLeftmost|=
c[b],f.SubtractInt(8);else{this.bitsAfterLeftmost|=c[b]<<9-f.AsInt32()&255;this.bitLeftmost=c[b]>>f.AsInt32()-1&1;break}this.bitsAfterLeftmost=0!=this.bitsAfterLeftmost?1:0;0<e.signum()&&(this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=0)}};n.ByteArrayBitLength=function(b){for(var c=(new p(b.length)).Multiply(8),e=b.length-1;0<=e;e--){var f=b[e]|0;if(0!=f){if(0!=(f&128))break;if(0!=(f&64)){c.SubtractInt(1);break}if(0!=(f&32)){c.SubtractInt(2);break}if(0!=(f&16)){c.SubtractInt(3);break}if(0!=
(f&8)){c.SubtractInt(4);break}if(0!=(f&4)){c.SubtractInt(5);break}if(0!=(f&2)){c.SubtractInt(6);break}if(0!=(f&1)){c.SubtractInt(7);break}}c.SubtractInt(8)}0==c.signum()&&c.AddInt(1);return c};m.CalcKnownBitLength=function(){if(this.isSmall){for(var b=y.SmallBitLength,c=y.SmallBitLength-1;0<=c&&0==(this.shiftedSmall&1<<c);c++)b--;0==b&&b++;return new p(b)}b=this.shiftedBigInt.toByteArray(!0);return y.ByteArrayBitLength(b)};m.ShiftBigToBits=function(b){var c=this.shiftedBigInt.toByteArray(!0);this.knownBitLength=
y.ByteArrayBitLength(c);if(0<this.knownBitLength.CompareToInt(b)){for(var e=p.Copy(this.knownBitLength).SubtractInt(b),f=p.Copy(e);0<f.signum()&&0!=this.shiftedBigInt.signum();){var d=f.MinInt32(1E6);this.shiftedBigInt=this.shiftedBigInt.shiftRight(d);f.SubtractInt(d)}this.knownBitLength.Multiply(0).AddInt(b);b<y.SmallBitLength&&(this.isSmall=!0,this.shiftedSmall=this.shiftedBigInt.intValue());this.bitsAfterLeftmost|=this.bitLeftmost;this.discardedBitCount.Add(e);for(b=0;b<c.length;b++)if(0<e.CompareToInt(8))this.bitsAfterLeftmost|=
c[b],e.SubtractInt(8);else{this.bitsAfterLeftmost|=c[b]<<9-e.AsInt32()&255;this.bitLeftmost=c[b]>>e.AsInt32()-1&1;break}this.bitsAfterLeftmost=0!=this.bitsAfterLeftmost?1:0}};m.ShiftRightInt=function(b){this.isSmall?this.ShiftRightSmall(b):this.ShiftRightBig(b)};m.ShiftRightSmall=function(b){if(!(0>=b))if(0==this.shiftedSmall)this.discardedBitCount.AddInt(b),this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=0,this.knownBitLength=new p(1);else{for(var c=y.SmallBitLength,e=y.SmallBitLength-
1;0<=e&&0==(this.shiftedSmall&1<<e);e++)c--;var e=(c<b?c:b)|0,f=b>c;this.knownBitLength=new p(c-e);this.discardedBitCount.AddInt(b);this.bitsAfterLeftmost|=this.bitLeftmost;this.bitsAfterLeftmost|=0!=this.shiftedSmall<<y.SmallBitLength+1-e?1:0;this.bitLeftmost=this.shiftedSmall>>e-1&1|0;this.shiftedSmall>>=e;f&&(this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=0);this.bitsAfterLeftmost=0!=this.bitsAfterLeftmost?1:0}};m.ShiftToDigitsInt=function(b){if(0>b)throw"bits is negative";this.isSmall?
this.ShiftSmallToBits(b):this.ShiftBigToBits(b)};m.ShiftSmallToBits=function(b){for(var c=y.SmallBitLength,e=y.SmallBitLength-1;0<=e&&0==(this.shiftedSmall&1<<e);e++)c--;0==c&&c++;c>b?(c-=b|0,e=c|0,this.knownBitLength=new p(b),this.discardedBitCount.AddInt(c),this.bitsAfterLeftmost|=this.bitLeftmost,this.bitsAfterLeftmost|=0!=this.shiftedSmall<<y.SmallBitLength+1-e?1:0,this.bitLeftmost=this.shiftedSmall>>(e|0)-1&1|0,this.bitsAfterLeftmost=0!=this.bitsAfterLeftmost?1:0,this.shiftedSmall>>=e):this.knownBitLength=
new p(c)}})(y,y.prototype);var B=function(l,m,b){if(0>l.signum())throw"bigint is negative";this.discardedBitCount=new p(0);0>=l.compareTo(B.Int32MaxValue)?(this.shiftedSmall=l.intValue(),this.isSmall=!0):(this.shiftedBigInt=l,this.isSmall=!1);this.bitsAfterLeftmost=0!=b?1:0;this.bitLeftmost=m};(function(n,m){m.bitLeftmost=null;m.getLastDiscardedDigit=function(){return this.bitLeftmost};m.bitsAfterLeftmost=null;m.getOlderDiscardedDigits=function(){return this.bitsAfterLeftmost};m.shiftedBigInt=null;
m.knownBitLength=null;m.GetDigitLength=function(){null==this.knownBitLength&&(this.knownBitLength=this.CalcKnownBitLength());return p.Copy(this.knownBitLength)};m.shiftedSmall=null;m.isSmall=null;m.getShiftedInt=function(){return this.isSmall?l.valueOf(this.shiftedSmall):this.shiftedBigInt};m.discardedBitCount=null;m.getDiscardedDigitCount=function(){return this.discardedBitCount};n.Int32MaxValue=l.valueOf(2147483647);n.FastParseBigInt=function(b,c,e){for(var f=0,d=9<e?9:e,g=0;g<d;g++)var a=b.charCodeAt(c+
g)-48|0,f=10*f,f=f+a;if(d==e)return l.valueOf(f);f=new p(f);for(g=9;g<e;){for(var d=9<e-g?9:e-g,h=1,k=0,m=g;m<g+d;m++)a=b.charCodeAt(c+m)-48|0,h*=10,k*=10,k+=a;f.Multiply(h).AddInt(k);g+=d}return f.AsBigInteger()};n.FastParseLong=function(b,c,e){if(9<e)throw"length not less or equal to 9 ("+e+")";for(var f=0,d=0;d<e;d++)var g=b.charCodeAt(c+d)-48|0,f=10*f,f=f+g;return f};m.getShiftedIntFast=function(){return this.isSmall?new p(this.shiftedSmall):p.FromBig(this.shiftedBigInt)};m.ShiftRight=function(b){if(null==
b)throw"fastint";if(!(0>=b.signum()))if(b.CanFitInInt32())this.ShiftRightInt(b.AsInt32());else for(b=b.AsBigInteger();0<b.signum();){var c=1E6;0>b.compareTo(l.valueOf(1E6))&&(c=b.intValue());this.ShiftRightInt(c);b=b.subtract(l.valueOf(c))}};m.ShiftRightBig=function(b){if(!(0>=b))if(0==this.shiftedBigInt.signum())this.discardedBitCount.AddInt(b),this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=0,this.knownBitLength=new p(1);else{var c=this.shiftedBigInt.toString(),e=c.length,f=0;b>e&&(f=
b-e);this.discardedBitCount.AddInt(b);this.bitsAfterLeftmost|=this.bitLeftmost;var d=e<b?e:b;b>=e?(this.isSmall=!0,this.shiftedSmall=0,this.knownBitLength=new p(1)):(b=e-d|0,this.knownBitLength=new p(b),9>=b?(this.isSmall=!0,this.shiftedSmall=B.FastParseLong(c,0,b)):this.shiftedBigInt=B.FastParseBigInt(c,0,b));for(b=c.length-1;0<=b&&!(this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=c.charCodeAt(b)-48|0,d--,0>=d);b--);this.bitsAfterLeftmost=0!=this.bitsAfterLeftmost?1:0;0<f&&(this.bitsAfterLeftmost|=
this.bitLeftmost,this.bitLeftmost=0)}};m.ShiftToBitsBig=function(b){var c;c=this.shiftedBigInt.toString();var e=c.length;this.knownBitLength=new p(e);if(e>b){b=e-b;this.knownBitLength.SubtractInt(b);e=e-b|0;2147483647>=b?this.discardedBitCount.AddInt(b|0):this.discardedBitCount.AddBig(l.valueOf(b));for(var f=c.length-1;0<=f&&!(this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=c.charCodeAt(f)-48|0,b--,0>=b);f--);9>=e?(this.isSmall=!0,this.shiftedSmall=B.FastParseLong(c,0,e)):this.shiftedBigInt=
B.FastParseBigInt(c,0,e);this.bitsAfterLeftmost=0!=this.bitsAfterLeftmost?1:0}};m.ShiftRightInt=function(b){this.isSmall?this.ShiftRightSmall(b):this.ShiftRightBig(b)};m.ShiftRightSmall=function(b){if(!(0>=b))if(0==this.shiftedSmall)this.discardedBitCount.AddInt(b),this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=0,this.knownBitLength=new p(1);else{for(var c=0,e=this.shiftedSmall;0<e;)c++,e=e/10|0;0==c&&c++;this.knownBitLength=new p(c);for(this.discardedBitCount.AddInt(b);0<b;)if(0==this.shiftedSmall){this.bitsAfterLeftmost|=
this.bitLeftmost;this.bitLeftmost=0;this.knownBitLength=new p(0);break}else c=this.shiftedSmall%10|0,this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=c,b--,this.shiftedSmall=this.shiftedSmall/10|0,this.knownBitLength.SubtractInt(1);this.bitsAfterLeftmost=0!=this.bitsAfterLeftmost?1:0}};m.ShiftToDigits=function(b){if(0>b.signum())throw"bits is negative";if(b.CanFitInInt32())this.ShiftToDigitsInt(b.AsInt32());else{this.knownBitLength=this.CalcKnownBitLength();var c=this.knownBitLength.AsBigInteger();
b=b.AsBigInteger();c=c.subtract(b);0<c.signum()&&this.ShiftRight(p.FromBig(c))}};m.ShiftToDigitsInt=function(b){this.isSmall?this.ShiftToBitsSmall(b):this.ShiftToBitsBig(b)};m.CalcKnownBitLength=function(){if(this.isSmall){for(var b=0,c=this.shiftedSmall;0<c;)b++,c=c/10|0;return new p(0==b?1:b)}return new p(this.shiftedBigInt.toString().length)};m.ShiftToBitsSmall=function(b){for(var c=0,e=this.shiftedSmall;0<e;)c++,e=e/10|0;0==c&&c++;this.knownBitLength=new p(c);if(c>b){b=c-b|0;c=c-b|0;this.knownBitLength=
new p(1>c?1:c);this.discardedBitCount.AddInt(b);for(c=0;c<b;c++)e=this.shiftedSmall%10|0,this.shiftedSmall=this.shiftedSmall/10|0,this.bitsAfterLeftmost|=this.bitLeftmost,this.bitLeftmost=e;this.bitsAfterLeftmost=0!=this.bitsAfterLeftmost?1:0}}})(B,B.prototype);var v=function(){};(function(n,m){n.BigIntPowersOfTen=[l.ONE,l.TEN,l.valueOf(100),l.valueOf(1E3),l.valueOf(1E4),l.valueOf(1E5),l.valueOf(1E6),l.valueOf(1E7),l.valueOf(1E8),l.valueOf(1E9),l.valueOf(q.createLongFromInts(1410065408,2)),l.valueOf(q.createLongFromInts(1215752192,
23)),l.valueOf(q.createLongFromInts(-727379968,232)),l.valueOf(q.createLongFromInts(1316134912,2328)),l.valueOf(q.createLongFromInts(276447232,23283)),l.valueOf(q.createLongFromInts(-1530494976,232830)),l.valueOf(q.createLongFromInts(1874919424,2328306)),l.valueOf(q.createLongFromInts(1569325056,23283064)),l.valueOf(q.createLongFromInts(-1486618624,232830643))];n.BigIntPowersOfFive=[l.ONE,l.valueOf(5),l.valueOf(25),l.valueOf(125),l.valueOf(625),l.valueOf(3125),l.valueOf(15625),l.valueOf(78125),l.valueOf(390625),
l.valueOf(1953125),l.valueOf(9765625),l.valueOf(48828125),l.valueOf(244140625),l.valueOf(1220703125),l.valueOf(q.createLongFromInts(1808548329,1)),l.valueOf(q.createLongFromInts(452807053,7)),l.valueOf(q.createLongFromInts(-2030932031,35)),l.valueOf(q.createLongFromInts(-1564725563,177)),l.valueOf(q.createLongFromInts(766306777,888)),l.valueOf(q.createLongFromInts(-463433411,4440)),l.valueOf(q.createLongFromInts(1977800241,22204)),l.valueOf(q.createLongFromInts(1299066613,111022)),l.valueOf(q.createLongFromInts(-2094601527,
555111)),l.valueOf(q.createLongFromInts(-1883073043,2775557)),l.valueOf(q.createLongFromInts(-825430623,13877787)),l.valueOf(q.createLongFromInts(167814181,69388939)),l.valueOf(q.createLongFromInts(839070905,346944695)),l.valueOf(q.createLongFromInts(-99612771,1734723475))];n.ShiftLeftOne=function(b){for(var c=0,e=0;e<b.length;e++){var f=b[e];b[e]=b[e]<<1|0|c|0;c=0!=f>>31?1:0}return c};n.CountTrailingZeros=function(b){if(0==b)return 32;var c=0;0==b<<16&&(b>>=16,c+=16);0==b<<24&&(b>>=8,c+=8);0==b<<
28&&(b>>=4,c+=4);0==b<<30&&(b>>=2,c+=2);0==b<<31&&++c;return c};n.BitPrecisionInt=function(b){if(0==b)return 0;var c=32;0==b>>16&&(b<<=16,c-=8);0==b>>24&&(b<<=8,c-=8);0==b>>28&&(b<<=4,c-=4);0==b>>30&&(b<<=2,c-=2);0==b>>31&&--c;return c};n.ShiftAwayTrailingZerosTwoElements=function(b){var c=b[0],e=b[1],f=v.CountTrailingZeros(c);if(0==f)return 0;if(32>f)return b[0]=c>>f&2147483647>>f-1|0|e<<32-f|0,b[1]=e>>f&2147483647>>f-1,f;f=v.CountTrailingZeros(e);b[0]=32==f?0:0<f?e>>f&2147483647>>f-1:e;b[1]=0;return 32+
f};n.HasBitSet=function(b,c){return c>>5<b.length&&0!=(b[c>>5]&1<<(c&31))};n.FindPowerOfFiveFromBig=function(b){if(0>=b.signum())return l.ONE;var c=l.ZERO;b=p.FromBig(b);if(0>=b.CompareToInt(54))return v.FindPowerOfFive(b.AsInt32());for(var e=l.ONE;0<b.signum();)if(0>=b.CompareToInt(27)){c=v.FindPowerOfFive(b.AsInt32());e=e.multiply(c);break}else if(0>=b.CompareToInt(9999999)){c=v.FindPowerOfFive(1).pow(b.AsInt32());e=e.multiply(c);break}else 0==c.signum()&&(c=v.FindPowerOfFive(1).pow(9999999)),e=
e.multiply(c),b.AddInt(-9999999);return e};n.BigInt36=l.valueOf(36);n.FindPowerOfTenFromBig=function(b){if(0>=b.signum())return l.ONE;if(0>=b.compareTo(v.BigInt36))return v.FindPowerOfTen(b.intValue());var c=p.FromBig(b);b=l.ONE;for(var e=l.ZERO;0<c.signum();)if(0>=c.CompareToInt(18)){e=v.FindPowerOfTen(c.AsInt32());b=b.multiply(e);break}else if(0>=c.CompareToInt(9999999)){c=c.AsInt32();e=v.FindPowerOfFive(c);e=e.shiftLeft(c);b=b.multiply(e);break}else 0==e.signum()&&(e=v.FindPowerOfFive(9999999),
e=e.shiftLeft(9999999)),b=b.multiply(e),c.AddInt(-9999999);return b};n.FivePower40=l.valueOf(q.createLongFromInts(1977800241,22204)).multiply(l.valueOf(q.createLongFromInts(1977800241,22204)));n.FindPowerOfFive=function(b){if(0>=b)return l.ONE;var c,e;if(27>=b)return v.BigIntPowersOfFive[b|0];if(40==b)return v.FivePower40;if(54>=b)return 0==(b&1)?(e=v.BigIntPowersOfFive[b>>1|0],e=e.multiply(e)):(e=v.BigIntPowersOfFive[27],c=v.BigIntPowersOfFive[(b|0)-27],e=e.multiply(c)),e;if(40<b&&94>=b)return e=
v.FivePower40,c=v.FindPowerOfFive(b-40),e=e.multiply(c);e=l.ONE;var f=!0;for(c=l.ZERO;0<b;)if(27>=b){c=v.BigIntPowersOfFive[b|0];e=f?c:e.multiply(c);break}else if(9999999>=b){c=v.BigIntPowersOfFive[1].pow(b|0);e=f?c:e.multiply(c);break}else 0==c.signum()&&(c=v.BigIntPowersOfFive[1].pow(9999999)),e=f?c:e.multiply(c),f=!1,b-=9999999;return e};n.FindPowerOfTen=function(b){if(0>=b)return l.ONE;var c,e;if(18>=b)return v.BigIntPowersOfTen[b|0];if(27>=b)return b|=0,c=v.BigIntPowersOfFive[b],c=c.shiftLeft(b);
if(36>=b)return 0==(b&1)?(c=v.BigIntPowersOfTen[b>>1|0],c=c.multiply(c)):(c=v.BigIntPowersOfTen[18],e=v.BigIntPowersOfTen[(b|0)-18],c=c.multiply(e)),c;c=l.ONE;var f=!0;for(e=l.ZERO;0<b;)if(18>=b){e=v.BigIntPowersOfTen[b|0];c=f?e:c.multiply(e);break}else if(9999999>=b){b|=0;e=v.FindPowerOfFive(b);e=e.shiftLeft(b);c=f?e:c.multiply(e);break}else 0==e.signum()&&(e=v.BigIntPowersOfTen[1].pow(9999999)),c=f?e:c.multiply(e),f=!1,b-=9999999;return c}})(v,v.prototype);var u=function(n,m,b,c,e){if(0>n)throw"precision not greater or equal to 0 ("+
n+")";if(b>c)throw"exponentMinSmall not less or equal to "+c+" ("+b+")";this.bigintPrecision=l.valueOf(n);this.rounding=m;this.clampNormalExponents=e;this.hasExponentRange=!0;this.exponentMax=l.valueOf(c);this.exponentMin=l.valueOf(b)};(function(n,m){m.exponentMax=null;m.getEMax=function(){return this.hasExponentRange?this.exponentMax:l.ZERO};m.exponentMin=null;m.hasExponentRange=null;m.getHasExponentRange=function(){return this.hasExponentRange};m.getEMin=function(){return this.hasExponentRange?
this.exponentMin:l.ZERO};m.bigintPrecision=null;m.getPrecision=function(){return this.bigintPrecision};m.rounding=null;m.clampNormalExponents=null;m.getClampNormalExponents=function(){return this.hasExponentRange?this.clampNormalExponents:!1};m.getRounding=function(){return this.rounding};m.flags=null;m.hasFlags=null;m.getHasFlags=function(){return this.hasFlags};n.FlagInexact=1;n.FlagRounded=2;n.FlagSubnormal=4;n.FlagUnderflow=8;n.FlagOverflow=16;n.FlagClamped=32;n.FlagInvalid=64;n.FlagDivideByZero=
128;m.getFlags=function(){return this.flags};m.setFlags=function(b){if(!this.getHasFlags())throw"Can't set flags";this.flags=b};m.ExponentWithinRange=function(b){if(null==b)throw"exponent";if(!this.getHasExponentRange())return!0;if(0==this.bigintPrecision.signum())return 0>=b.compareTo(this.getEMax());var c;c=b.add(this.bigintPrecision);c=c.subtract(l.ONE);return 0>c.compareTo(this.getEMin())||0<b.compareTo(this.getEMax())?!1:!0};m.WithRounding=function(b){var c=this.Copy();c.rounding=b;return c};
m.WithBlankFlags=function(){var b=this.Copy();b.hasFlags=!0;b.flags=0;return b};m.WithExponentClamp=function(b){var c=this.Copy();c.clampNormalExponents=b;return c};m.WithExponentRange=function(b,c){if(null==b)throw"exponentMin";if(0<b.compareTo(c))throw"exponentMin greater than exponentMax";var e=this.Copy();e.hasExponentRange=!0;e.exponentMin=b;e.exponentMax=c;return e};m.WithNoFlags=function(){var b=this.Copy();b.hasFlags=!1;b.flags=0;return b};m.WithUnlimitedExponents=function(){var b=this.Copy();
b.hasExponentRange=!1;return b};m.WithPrecision=function(b){if(0>b)throw"precision not greater or equal to 0 ("+b+")";var c=this.Copy();c.bigintPrecision=l.valueOf(b);return c};m.WithBigPrecision=function(b){if(null==b)throw"bigintPrecision";if(0>b.signum())throw"precision not greater or equal to 0 ("+b+")";var c=this.Copy();c.bigintPrecision=b;return c};m.Copy=function(){var b=new u(0,this.rounding,0,0,this.clampNormalExponents);b.hasFlags=this.hasFlags;b.flags=this.flags;b.exponentMax=this.exponentMax;
b.exponentMin=this.exponentMin;b.hasExponentRange=this.hasExponentRange;b.bigintPrecision=this.bigintPrecision;b.rounding=this.rounding;b.clampNormalExponents=this.clampNormalExponents;return b};n.ForPrecision=function(b){return(new u(b,"HalfUp",0,0,!1)).WithUnlimitedExponents()};n.ForRounding=function(b){return(new u(0,b,0,0,!1)).WithUnlimitedExponents()};n.ForPrecisionAndRounding=function(b,c){return(new u(b,c,0,0,!1)).WithUnlimitedExponents()};n.Unlimited=u.ForPrecision(0);n.Decimal32=new u(7,
"HalfEven",-95,96,!0);n.Decimal64=new u(16,"HalfEven",-383,384,!0);n.Decimal128=new u(34,"HalfEven",-6143,6144,!0);n.CliDecimal=new u(96,"HalfEven",0,28,!0)})(u,u.prototype);"undefined"!==typeof exports&&(exports.PrecisionContext=u);var n=function(){};(function(l,m){l.FlagNegative=1;l.FlagQuietNaN=4;l.FlagSignalingNaN=8;l.FlagInfinity=2;l.FlagSpecial=n.FlagQuietNaN|n.FlagSignalingNaN|n.FlagInfinity;l.FlagNaN=n.FlagQuietNaN|n.FlagSignalingNaN;l.FiniteOnly=0;l.FiniteAndNonFinite=1;l.X3Dot274=2})(n,
n.prototype);var z=function(l){this.helper=l;this.support=l.GetArithmeticSupport();this.thisRadix=l.GetRadix()};(function(r,m){m.helper=null;m.thisRadix=null;m.support=null;m.ReturnQuietNaNFastIntPrecision=function(b,c){var e=this.helper.GetMantissa(b).abs(),f=!1;if(0!=e.signum()&&null!=c&&0<c.signum()){var d=this.helper.MultiplyByRadixPower(l.ONE,c);0<=e.compareTo(d)&&(e=e.remainder(d),f=!0)}d=this.helper.GetFlags(b);if(!f&&0!=(d&n.FlagQuietNaN))return b;d&=n.FlagNegative;d|=n.FlagQuietNaN;return this.helper.CreateNewWithFlags(e,
l.ZERO,d)};m.ReturnQuietNaN=function(b,c){var e=this.helper.GetMantissa(b).abs(),f=!1;if(0!=e.signum()&&null!=c&&0!=c.getPrecision().signum()){var d=this.helper.MultiplyByRadixPower(l.ONE,p.FromBig(c.getPrecision()));0<=e.compareTo(d)&&(e=e.remainder(d),f=!0)}d=this.helper.GetFlags(b);if(!f&&0!=(d&n.FlagQuietNaN))return b;d&=n.FlagNegative;d|=n.FlagQuietNaN;return this.helper.CreateNewWithFlags(e,l.ZERO,d)};m.DivisionHandleSpecial=function(b,c,e){var f=this.helper.GetFlags(b),d=this.helper.GetFlags(c);
if(0!=((f|d)&n.FlagSpecial)){c=this.HandleNotANumber(b,c,e);if(null!=c)return c;if(0!=(f&n.FlagInfinity)&&0!=(d&n.FlagInfinity))return this.SignalInvalid(e);if(0!=(f&n.FlagInfinity))return this.EnsureSign(b,0!=((f^d)&n.FlagNegative));if(0!=(d&n.FlagInfinity)){if(null!=e&&e.getHasExponentRange()&&0<e.getPrecision().signum())return e.getHasFlags()&&e.setFlags(e.getFlags()|u.FlagClamped),b=e.getEMin(),b=b.subtract(l.valueOf(e.getPrecision())),b=b.add(l.ONE),f=(f^d)&n.FlagNegative,this.helper.CreateNewWithFlags(l.ZERO,
b,f);f=(f^d)&n.FlagNegative;return this.RoundToPrecision(this.helper.CreateNewWithFlags(l.ZERO,l.ZERO,f),e)}}return null};m.RemainderHandleSpecial=function(b,c,e){var f=this.helper.GetFlags(b),d=this.helper.GetFlags(c);if(0!=((f|d)&n.FlagSpecial)){var g=this.HandleNotANumber(b,c,e);if(null!=g)return g;if(0!=(f&n.FlagInfinity))return this.SignalInvalid(e);if(0!=(d&n.FlagInfinity))return this.RoundToPrecision(b,e)}return 0==this.helper.GetMantissa(c).signum()?this.SignalInvalid(e):null};m.MinMaxHandleSpecial=
function(b,c,e,f,d){var g=this.helper.GetFlags(b),a=this.helper.GetFlags(c);if(0!=((g|a)&n.FlagSpecial)){if(0!=(this.helper.GetFlags(b)&n.FlagSignalingNaN))return this.SignalingNaNInvalid(b,e);if(0!=(this.helper.GetFlags(c)&n.FlagSignalingNaN))return this.SignalingNaNInvalid(c,e);if(0!=(this.helper.GetFlags(b)&n.FlagQuietNaN))return 0!=(this.helper.GetFlags(c)&n.FlagQuietNaN)?this.ReturnQuietNaN(b,e):this.RoundToPrecision(c,e);if(0!=(this.helper.GetFlags(c)&n.FlagQuietNaN))return this.RoundToPrecision(b,
e);if(0!=(g&n.FlagInfinity))return d&&0==(a&n.FlagInfinity)?f?this.RoundToPrecision(c,e):b:f?0!=(g&n.FlagNegative)?b:this.RoundToPrecision(c,e):0==(g&n.FlagNegative)?b:this.RoundToPrecision(c,e);if(0!=(a&n.FlagInfinity))return d?f?this.RoundToPrecision(b,e):c:f?0==(a&n.FlagNegative)?this.RoundToPrecision(b,e):c:0!=(a&n.FlagNegative)?this.RoundToPrecision(b,e):c}return null};m.HandleNotANumber=function(b,c,e){this.helper.GetFlags(b);this.helper.GetFlags(c);return 0!=(this.helper.GetFlags(b)&n.FlagSignalingNaN)?
this.SignalingNaNInvalid(b,e):0!=(this.helper.GetFlags(c)&n.FlagSignalingNaN)?this.SignalingNaNInvalid(c,e):0!=(this.helper.GetFlags(b)&n.FlagQuietNaN)?this.ReturnQuietNaN(b,e):0!=(this.helper.GetFlags(c)&n.FlagQuietNaN)?this.ReturnQuietNaN(c,e):null};m.ValueOf=function(b,c){return null==c||!c.getHasExponentRange()||c.ExponentWithinRange(l.ZERO)?this.helper.ValueOf(b):this.RoundToPrecision(this.helper.ValueOf(b),c)};m.CompareToHandleSpecialReturnInt=function(b,c){var e=this.helper.GetFlags(b),f=this.helper.GetFlags(c);
if(0!=((e|f)&n.FlagSpecial)){if(0!=((e|f)&n.FlagNaN))throw"Either operand is NaN";if(0!=(e&n.FlagInfinity))return(e&(n.FlagInfinity|n.FlagNegative))==(f&(n.FlagInfinity|n.FlagNegative))?0:0==(e&n.FlagNegative)?1:-1;if(0!=(f&n.FlagInfinity))return(e&(n.FlagInfinity|n.FlagNegative))==(f&(n.FlagInfinity|n.FlagNegative))?0:0==(f&n.FlagNegative)?-1:1}return 2};m.CompareToHandleSpecial=function(b,c,e,f){var d=this.helper.GetFlags(b),g=this.helper.GetFlags(c);if(0!=((d|g)&n.FlagSpecial)){if(0!=(this.helper.GetFlags(b)&
n.FlagSignalingNaN))return this.SignalingNaNInvalid(b,f);if(0!=(this.helper.GetFlags(c)&n.FlagSignalingNaN))return this.SignalingNaNInvalid(c,f);if(e){if(0!=(this.helper.GetFlags(b)&n.FlagQuietNaN))return this.SignalingNaNInvalid(b,f);if(0!=(this.helper.GetFlags(c)&n.FlagQuietNaN))return this.SignalingNaNInvalid(c,f)}else{if(0!=(this.helper.GetFlags(b)&n.FlagQuietNaN))return this.ReturnQuietNaN(b,f);if(0!=(this.helper.GetFlags(c)&n.FlagQuietNaN))return this.ReturnQuietNaN(c,f)}if(0!=(d&n.FlagInfinity))return(d&
(n.FlagInfinity|n.FlagNegative))==(g&(n.FlagInfinity|n.FlagNegative))?this.ValueOf(0,null):0==(d&n.FlagNegative)?this.ValueOf(1,null):this.ValueOf(-1,null);if(0!=(g&n.FlagInfinity))return(d&(n.FlagInfinity|n.FlagNegative))==(g&(n.FlagInfinity|n.FlagNegative))?this.ValueOf(0,null):0==(g&n.FlagNegative)?this.ValueOf(-1,null):this.ValueOf(1,null)}return null};m.SignalingNaNInvalid=function(b,c){this.helper.GetFlags(b);null!=c&&c.getHasFlags()&&c.setFlags(c.getFlags()|u.FlagInvalid);return this.ReturnQuietNaN(b,
c)};m.SignalInvalid=function(b){if(this.support==n.FiniteOnly)throw"Invalid operation";null!=b&&b.getHasFlags()&&b.setFlags(b.getFlags()|u.FlagInvalid);return this.helper.CreateNewWithFlags(l.ZERO,l.ZERO,n.FlagQuietNaN)};m.SignalInvalidWithMessage=function(b,c){if(this.support==n.FiniteOnly)throw"Invalid operation";null!=b&&b.getHasFlags()&&b.setFlags(b.getFlags()|u.FlagInvalid);return this.helper.CreateNewWithFlags(l.ZERO,l.ZERO,n.FlagQuietNaN)};m.SignalOverflow=function(b){return this.support==
n.FiniteOnly?null:this.helper.CreateNewWithFlags(l.ZERO,l.ZERO,(b?n.FlagNegative:0)|n.FlagInfinity)};m.SignalDivideByZero=function(b,c){if(this.support==n.FiniteOnly)throw"Division by zero";null!=b&&b.getHasFlags()&&b.setFlags(b.getFlags()|u.FlagDivideByZero);return this.helper.CreateNewWithFlags(l.ZERO,l.ZERO,n.FlagInfinity|(c?n.FlagNegative:0))};m.Round=function(b,c,e,f){var d=!1,g=this.thisRadix;if("HalfUp"==c)b.getLastDiscardedDigit()>=(g/2|0)&&(d=!0);else if("HalfEven"==c)b.getLastDiscardedDigit()>=
(g/2|0)&&(b.getLastDiscardedDigit()>(g/2|0)||0!=b.getOlderDiscardedDigits()?d=!0:f.isEvenNumber()||(d=!0));else if("Ceiling"==c)e||0==(b.getLastDiscardedDigit()|b.getOlderDiscardedDigits())||(d=!0);else if("Floor"==c)e&&0!=(b.getLastDiscardedDigit()|b.getOlderDiscardedDigits())&&(d=!0);else if("HalfDown"==c){if(b.getLastDiscardedDigit()>(g/2|0)||b.getLastDiscardedDigit()==(g/2|0)&&0!=b.getOlderDiscardedDigits())d=!0}else if("Up"==c)0!=(b.getLastDiscardedDigit()|b.getOlderDiscardedDigits())&&(d=!0);
else if("ZeroFiveUp"==c&&0!=(b.getLastDiscardedDigit()|b.getOlderDiscardedDigits()))if(2==g)d=!0;else if(b=p.Copy(f).Mod(g).AsInt32(),0==b||b==(g/2|0))d=!0;return d};m.RoundGivenDigits=function(b,c,e,f,d){var g=!1,a=this.thisRadix;if("HalfUp"==e)b>=(a/2|0)&&(g=!0);else if("HalfEven"==e)b>=(a/2|0)&&(b>(a/2|0)||0!=c?g=!0:d.testBit(0)&&(g=!0));else if("Ceiling"==e)f||0==(b|c)||(g=!0);else if("Floor"==e)f&&0!=(b|c)&&(g=!0);else if("HalfDown"==e){if(b>(a/2|0)||b==(a/2|0)&&0!=c)g=!0}else if("Up"==e)0!=
(b|c)&&(g=!0);else if("ZeroFiveUp"==e&&0!=(b|c))if(2==a)g=!0;else if(b=d.remainder(l.valueOf(a)).intValue(),0==b||b==(a/2|0))g=!0;return g};m.RoundGivenBigInt=function(b,c,e,f){return this.RoundGivenDigits(b.getLastDiscardedDigit(),b.getOlderDiscardedDigits(),c,e,f)};m.EnsureSign=function(b,c){if(null==b)return b;var e=this.helper.GetFlags(b);return c&&0==(e&n.FlagNegative)||!c&&0!=(e&n.FlagNegative)?(e&=~n.FlagNegative,e|=c?n.FlagNegative:0,this.helper.CreateNewWithFlags(this.helper.GetMantissa(b),
this.helper.GetExponent(b),e)):b};m.DivideToIntegerNaturalScale=function(b,c,e){var f=p.FromBig(this.helper.GetExponent(b)).SubtractBig(this.helper.GetExponent(c)),d=u.ForRounding("Down").WithBigPrecision(null==e?l.ZERO:e.getPrecision()).WithBlankFlags(),g=this.DivideInternal(b,c,d,z.IntegerModeFixedScale,l.ZERO,null);if(0!=(d.getFlags()&(u.FlagInvalid|u.FlagDivideByZero)))return e.getHasFlags()&&e.setFlags(e.getFlags()|u.FlagInvalid|u.FlagDivideByZero),g;d=0>this.helper.GetSign(b)^0>this.helper.GetSign(c);
if(0==this.helper.GetMantissa(g).signum())var f=this.helper.GetExponent(b),a=this.helper.GetExponent(c),g=this.helper.CreateNewWithFlags(l.ZERO,f.subtract(a),this.helper.GetFlags(g));else if(0>f.signum())f.Negate(),a=this.helper.GetMantissa(g).abs(),a=this.helper.MultiplyByRadixPower(a,f),g=this.helper.CreateNewWithFlags(a,this.helper.GetExponent(b).subtract(this.helper.GetExponent(c)),this.helper.GetFlags(g));else if(0<f.signum()){a=this.helper.GetMantissa(g).abs();c=p.FromBig(this.helper.GetExponent(g));
for(b=l.valueOf(this.thisRadix);0!=f.compareTo(c);){var h,k=a.divideAndRemainder(b);h=k[0];if(0!=k[1].signum())break;a=h;c.AddInt(1)}g=this.helper.CreateNewWithFlags(a,c.AsBigInteger(),this.helper.GetFlags(g))}null!=e&&(g=this.RoundToPrecision(g,e));return g=this.EnsureSign(g,d)};m.DivideToIntegerZeroScale=function(b,c,e){var f=u.ForRounding("Down").WithBigPrecision(null==e?l.ZERO:e.getPrecision()).WithBlankFlags();b=this.DivideInternal(b,c,f,z.IntegerModeFixedScale,l.ZERO,null);return 0!=(f.getFlags()&
(u.FlagInvalid|u.FlagDivideByZero))?(e.getHasFlags()&&e.setFlags(e.getFlags()|f.getFlags()&(u.FlagInvalid|u.FlagDivideByZero)),b):null!=e&&(f=e.WithBlankFlags().WithUnlimitedExponents(),b=this.RoundToPrecision(b,f),0!=(f.getFlags()&u.FlagRounded))?this.SignalInvalid(e):b};m.Abs=function(b,c){var e=this.helper.GetFlags(b);return 0!=(e&n.FlagSignalingNaN)?this.SignalingNaNInvalid(b,c):0!=(e&n.FlagQuietNaN)?this.ReturnQuietNaN(b,c):0!=(e&n.FlagNegative)?this.RoundToPrecision(this.helper.CreateNewWithFlags(this.helper.GetMantissa(b),
this.helper.GetExponent(b),e&~n.FlagNegative),c):this.RoundToPrecision(b,c)};m.Negate=function(b,c){var e=this.helper.GetFlags(b);if(0!=(e&n.FlagSignalingNaN))return this.SignalingNaNInvalid(b,c);if(0!=(e&n.FlagQuietNaN))return this.ReturnQuietNaN(b,c);var f=this.helper.GetMantissa(b);if(0==(e&n.FlagInfinity)&&0==f.signum())return 0==(e&n.FlagNegative)?this.RoundToPrecision(this.helper.CreateNewWithFlags(f,this.helper.GetExponent(b),e&~n.FlagNegative),c):null!=c&&"Floor"==c.getRounding()?this.RoundToPrecision(this.helper.CreateNewWithFlags(f,
this.helper.GetExponent(b),e|n.FlagNegative),c):this.RoundToPrecision(this.helper.CreateNewWithFlags(f,this.helper.GetExponent(b),e&~n.FlagNegative),c);e^=n.FlagNegative;return this.RoundToPrecision(this.helper.CreateNewWithFlags(f,this.helper.GetExponent(b),e),c)};m.AbsRaw=function(b){return this.EnsureSign(b,!1)};m.NegateRaw=function(b){if(null==b)return b;var c=this.helper.GetFlags(b)&n.FlagNegative;return this.helper.CreateNewWithFlags(this.helper.GetMantissa(b),this.helper.GetExponent(b),0==
c?n.FlagNegative:0)};r.TransferFlags=function(b,c){null!=b&&b.getHasFlags()&&(0!=(c.getFlags()&(u.FlagInvalid|u.FlagDivideByZero))?b.setFlags(b.getFlags()|c.getFlags()&(u.FlagInvalid|u.FlagDivideByZero)):b.setFlags(b.getFlags()|c.getFlags()))};m.Remainder=function(b,c,e){var f=null==e?null:e.WithBlankFlags(),d=this.RemainderHandleSpecial(b,c,f);if(null!=d)return z.TransferFlags(e,f),d;d=this.DivideToIntegerZeroScale(b,c,f);d=this.Add(b,this.NegateRaw(this.Multiply(d,c,null)),f);d=this.EnsureSign(d,
0!=(this.helper.GetFlags(b)&n.FlagNegative));z.TransferFlags(e,f);return d};m.RemainderNear=function(b,c,e){var f=null==e?u.ForRounding("HalfEven").WithBlankFlags():e.WithRounding("HalfEven").WithBlankFlags(),d=this.RemainderHandleSpecial(b,c,f);if(null!=d)return z.TransferFlags(e,f),d;d=this.DivideInternal(b,c,f,z.IntegerModeFixedScale,l.ZERO,null);if(0!=(f.getFlags()&u.FlagInvalid))return this.SignalInvalid(e);f=f.WithBlankFlags();d=this.RoundToPrecision(d,f);if(0!=(f.getFlags()&(u.FlagRounded|
u.FlagInvalid)))return this.SignalInvalid(e);f=null==e?null:e.WithBlankFlags();c=this.Add(b,this.NegateRaw(this.Multiply(d,c,null)),f);if(0!=(f.getFlags()&u.FlagInvalid))return this.SignalInvalid(e);0==this.helper.GetFlags(c)&&0==this.helper.GetMantissa(c).signum()&&(c=this.EnsureSign(c,0!=(this.helper.GetFlags(b)&n.FlagNegative)));z.TransferFlags(e,f);return c};m.NextMinus=function(b,c){if(null==c)throw"ctx";if(0>=c.getPrecision().signum())throw"ctx.getPrecision() not less than 0 ("+c.getPrecision()+
")";if(!c.getHasExponentRange())throw"doesn't satisfy ctx.getHasExponentRange()";var e=this.helper.GetFlags(b);if(0!=(e&n.FlagSignalingNaN))return this.SignalingNaNInvalid(b,c);if(0!=(e&n.FlagQuietNaN))return this.ReturnQuietNaN(b,c);if(0!=(e&n.FlagInfinity)){if(0!=(e&n.FlagNegative))return b;var e=c.getEMax(),e=e.add(l.ONE),e=e.subtract(l.valueOf(c.getPrecision())),f=this.helper.MultiplyByRadixPower(l.ONE,p.FromBig(c.getPrecision())),f=f.subtract(l.ONE);return this.helper.CreateNewWithFlags(f,e,
0)}e=p.FromBig(c.getEMin()).SubtractBig(c.getPrecision()).AddInt(1);f=p.FromBig(this.helper.GetExponent(b));0>=f.compareTo(e)&&(e=p.Copy(f).SubtractInt(2));e=this.helper.CreateNewWithFlags(l.ONE,e.AsBigInteger(),n.FlagNegative);f=c.WithRounding("Floor");return this.Add(b,e,f)};m.NextToward=function(b,c,e){if(null==e)throw"ctx";if(0>=e.getPrecision().signum())throw"ctx.getPrecision() not less than 0 ("+e.getPrecision()+")";if(!e.getHasExponentRange())throw"doesn't satisfy ctx.getHasExponentRange()";
var f=this.helper.GetFlags(b),d=this.helper.GetFlags(c);if(0!=((f|d)&n.FlagSpecial)){var g=this.HandleNotANumber(b,c,e);if(null!=g)return g}c=this.compareTo(b,c);if(0==c)return this.RoundToPrecision(this.EnsureSign(b,0!=(d&n.FlagNegative)),e.WithNoFlags());if(0!=(f&n.FlagInfinity)){if((f&(n.FlagInfinity|n.FlagNegative))==(d&(n.FlagInfinity|n.FlagNegative)))return b;b=e.getEMax();b=b.add(l.ONE);b=b.subtract(l.valueOf(e.getPrecision()));e=this.helper.MultiplyByRadixPower(l.ONE,p.FromBig(e.getPrecision()));
e=e.subtract(l.ONE);return this.helper.CreateNewWithFlags(e,b,f&n.FlagNegative)}f=p.FromBig(e.getEMin()).SubtractBig(e.getPrecision()).AddInt(1);d=p.FromBig(this.helper.GetExponent(b));0>d.compareTo(f)?f=p.Copy(d).SubtractInt(2):f.SubtractInt(2);d=this.helper.CreateNewWithFlags(l.ONE,f.AsBigInteger(),0<c?n.FlagNegative:0);f=e.WithRounding(0<c?"Floor":"Ceiling").WithBlankFlags();b=this.Add(b,d,f);0==(f.getFlags()&(u.FlagOverflow|u.FlagUnderflow))&&f.setFlags(0);0!=(f.getFlags()&u.FlagUnderflow)&&(c=
this.helper.GetMantissa(b).abs(),d=this.helper.MultiplyByRadixPower(l.ONE,p.FromBig(e.getPrecision()).SubtractInt(1)),(0<=c.compareTo(d)||0==e.getPrecision().compareTo(l.ONE))&&f.setFlags(0));e.getHasFlags()&&e.setFlags(e.getFlags()|f.getFlags());return b};m.NextPlus=function(b,c){if(null==c)throw"ctx";if(0>=c.getPrecision().signum())throw"ctx.getPrecision() not less than 0 ("+c.getPrecision()+")";if(!c.getHasExponentRange())throw"doesn't satisfy ctx.getHasExponentRange()";var e=this.helper.GetFlags(b);
if(0!=(e&n.FlagSignalingNaN))return this.SignalingNaNInvalid(b,c);if(0!=(e&n.FlagQuietNaN))return this.ReturnQuietNaN(b,c);if(0!=(e&n.FlagInfinity)){if(0!=(e&n.FlagNegative)){var e=c.getEMax(),e=e.add(l.ONE),e=e.subtract(l.valueOf(c.getPrecision())),f=this.helper.MultiplyByRadixPower(l.ONE,p.FromBig(c.getPrecision())),f=f.subtract(l.ONE);return this.helper.CreateNewWithFlags(f,e,n.FlagNegative)}return b}e=p.FromBig(c.getEMin()).SubtractBig(c.getPrecision()).AddInt(1);f=p.FromBig(this.helper.GetExponent(b));
0>=f.compareTo(e)&&(e=p.Copy(f).SubtractInt(2));e=this.helper.CreateNewWithFlags(l.ONE,e.AsBigInteger(),0);f=c.WithRounding("Ceiling");return this.Add(b,e,f)};m.DivideToExponent=function(b,c,e,f){if(null!=f&&!f.ExponentWithinRange(e))return this.SignalInvalidWithMessage(f,"Exponent not within exponent range: "+e.toString());var d=null==f?u.ForRounding("HalfDown"):f.WithUnlimitedExponents().WithPrecision(0);b=this.DivideInternal(b,c,d,z.IntegerModeFixedScale,e,null);null!=f&&f.getHasFlags()&&f.setFlags(f.getFlags()|
d.getFlags());return b};m.Divide=function(b,c,e){return this.DivideInternal(b,c,e,z.IntegerModeRegular,l.ZERO,null)};m.RoundToScale=function(b,c,e,f,d,g){var a,h=null==g?"HalfEven":g.getRounding(),k=a=0;if(0!=c.signum())if("HalfDown"==h||"HalfUp"==h||"HalfEven"==h)a=e.shiftRight(1),a=c.compareTo(a),0==a&&!1==e.testBit(0)?(a=this.thisRadix/2|0,k=0):(a=0<a?this.thisRadix/2|0:0,k=1);else{if("Unnecessary"==h)throw"Rounding was required";k=a=1}e=0;c=b;if(0==f.signum()){if(0!=(a|k)){e=e|u.FlagInexact|u.FlagRounded;
if("Unnecessary"==h)throw"Rounding was required";this.RoundGivenDigits(a,k,h,d,c)&&(c=c.add(l.ONE))}}else if(a=this.helper.CreateShiftAccumulatorWithDigits(b,a,k),a.ShiftRight(f),c=a.getShiftedInt(),0!=a.getDiscardedDigitCount().signum()||0!=(a.getLastDiscardedDigit()|a.getOlderDiscardedDigits())){0!=b.signum()&&(e|=u.FlagRounded);if(0!=(a.getLastDiscardedDigit()|a.getOlderDiscardedDigits())&&(e=e|u.FlagInexact|u.FlagRounded,"Unnecessary"==h))throw"Rounding was required";this.RoundGivenBigInt(a,h,
d,c)&&(c=c.add(l.ONE))}g.getHasFlags()&&g.setFlags(g.getFlags()|e);d&&(c=c.negate());return c};r.IntegerModeFixedScale=1;r.IntegerModeRegular=0;r.NonTerminatingCheckThreshold=5;m.DivideInternal=function(b,c,e,f,d,g){var a=this.DivisionHandleSpecial(b,c,e);if(null!=a)return a;a=this.helper.GetSign(b);if(0==this.helper.GetSign(c))return 0==a?this.SignalInvalid(e):this.SignalDivideByZero(e,0!=(this.helper.GetFlags(b)&n.FlagNegative)^0!=(this.helper.GetFlags(c)&n.FlagNegative));var h=this.thisRadix;if(0==
a)return a=null,f==z.IntegerModeFixedScale?(b=this.helper.GetFlags(b)&n.FlagNegative^this.helper.GetFlags(c)&n.FlagNegative,a=this.helper.CreateNewWithFlags(l.ZERO,d,b)):(a=this.helper.GetExponent(b),h=this.helper.GetExponent(c),b=this.helper.GetFlags(b)&n.FlagNegative^this.helper.GetFlags(c)&n.FlagNegative,a=this.RoundToPrecision(this.helper.CreateNewWithFlags(l.ZERO,a.subtract(h),b),e)),null!=g&&(g[0]=a),a;g=this.helper.GetMantissa(b).abs();var a=this.helper.GetMantissa(c).abs(),k=p.FromBig(this.helper.GetExponent(b)),
m=p.FromBig(this.helper.GetExponent(c)),F=p.Copy(k).Subtract(m),r=new p(0),m=new p(0),k=p.Copy(F);b=(this.helper.GetFlags(b)&n.FlagNegative)!=(this.helper.GetFlags(c)&n.FlagNegative);c=null==e?new p(0):p.FromBig(e.getPrecision());if(f==z.IntegerModeFixedScale){h=p.FromBig(d);null!=e&&e.getHasFlags()&&0<h.compareTo(k)&&e.setFlags(e.getFlags()|u.FlagRounded);if(0>=F.compareTo(h))return h=p.Copy(h).Subtract(F),k=g.divideAndRemainder(a),g=k[0],k=k[1],g=this.RoundToScale(g,k,a,h,b,e),this.helper.CreateNewWithFlags(g,
d,b?n.FlagNegative:0);if(null!=e&&0!=e.getPrecision().signum()&&0<p.Copy(F).SubtractInt(8).compareTo(c))return this.SignalInvalidWithMessage(e,"Result can't fit the precision");h=p.Copy(F).Subtract(h);g=this.helper.MultiplyByRadixPower(g,h);k=g.divideAndRemainder(a);g=k[0];k=k[1];g=this.RoundToScale(g,k,a,new p(0),b,e);return this.helper.CreateNewWithFlags(g,d,b?n.FlagNegative:0)}var t=new p(1),s=g.compareTo(a);if(0>s){d=this.helper.CreateShiftAccumulator(g).GetDigitLength();var q=this.helper.CreateShiftAccumulator(a).GetDigitLength();
q.Subtract(d);0==q.signum()&&q.AddInt(1);g=this.helper.MultiplyByRadixPower(g,q);r.Add(q);0>g.compareTo(a)&&(g=2==h?g.shiftLeft(1):g.multiply(l.valueOf(h)),r.AddInt(1))}else 0<s&&(d=this.helper.CreateShiftAccumulator(g).GetDigitLength(),q=this.helper.CreateShiftAccumulator(a).GetDigitLength(),d.Subtract(q),q=a,a=this.helper.MultiplyByRadixPower(a,d),r.Subtract(d),0>g.compareTo(a)&&(0==d.CompareToInt(1)?a=q:(d=l.valueOf(h),a=a.divide(d)),r.AddInt(1)));d=!1;if(0==s)m=new p(1),g=l.ZERO;else{var s=0,
q=p.FromBig(a),v=p.FromBig(g),w=null;2!=h&&(w=p.FromBig(a).Multiply(h/2|0));for(var x=null!=e&&0!=e.getPrecision().signum();;){var y=!1;if(s!=z.NonTerminatingCheckThreshold||x||f!=z.IntegerModeRegular)s<z.NonTerminatingCheckThreshold&&s++;else{if(!this.helper.HasTerminatingRadixExpansion(v.AsBigInteger(),a))throw"Result would have a nonterminating expansion";s++}y=0;null!=w&&0<=v.compareTo(w)&&(v.Subtract(w),y+=h/2|0);for(;0<=v.compareTo(q);)v.Subtract(q),y++;m.AddInt(y);y=0==v.signum();if(x&&0==
t.compareTo(c)){g=v.AsBigInteger();d=!0;break}if(y&&0<=r.signum()){g=v.AsBigInteger();break}r.AddInt(1);0!=m.signum()&&t.AddInt(1);m.Multiply(h);v.Multiply(h)}}F=p.Copy(F).Subtract(r);f=null==e?"HalfEven":e.getRounding();c=r=0;if(0!=g.signum())if("HalfDown"==f||"HalfEven"==f||"HalfUp"==f)r=a.shiftRight(1),g=g.compareTo(r),0==g&&!1==a.testBit(0)?(r=h/2|0,c=0):(r=0<g?h/2|0:0,c=1);else{if("Unnecessary"==f)throw"Rounding was required";c=r=1}h=a=m.AsBigInteger();null!=e&&e.getHasFlags()&&0<F.compareTo(k)&&
e.setFlags(e.getFlags()|u.FlagRounded);g=F.AsBigInteger();a=this.helper.CreateNewWithFlags(a,g,b?n.FlagNegative:0);if(d&&!e.getHasExponentRange()){if(!this.RoundGivenDigits(r,c,f,b,h))return null!=e&&e.getHasFlags()&&0!=(r|c)&&e.setFlags(e.getFlags()|u.FlagInexact|u.FlagRounded),a;if(!1==h.testBit(0)&&0==(this.thisRadix&1))return h=h.add(l.ONE),null!=e&&e.getHasFlags()&&0!=(r|c)&&e.setFlags(e.getFlags()|u.FlagInexact|u.FlagRounded),this.helper.CreateNewWithFlags(h,g,b?n.FlagNegative:0)}if(d&&e.getHasExponentRange()&&
(k=p.Copy(F).AddBig(e.getPrecision()).SubtractInt(1).AsBigInteger(),0<=k.compareTo(e.getEMin())&&0>=k.compareTo(e.getEMax()))){if(!this.RoundGivenDigits(r,c,f,b,h))return null!=e&&e.getHasFlags()&&0!=(r|c)&&e.setFlags(e.getFlags()|u.FlagInexact|u.FlagRounded),a;if(!1==h.testBit(0)&&0==(this.thisRadix&1))return h=h.add(l.ONE),null!=e&&e.getHasFlags()&&0!=(r|c)&&e.setFlags(e.getFlags()|u.FlagInexact|u.FlagRounded),this.helper.CreateNewWithFlags(h,g,b?n.FlagNegative:0)}return this.RoundToPrecisionWithShift(a,
e,r,c,new p(0),!1)};m.MinMagnitude=function(b,c,e){if(null==b)throw"a";if(null==c)throw"b";var f=this.MinMaxHandleSpecial(b,c,e,!0,!0);if(null!=f)return f;f=this.compareTo(this.AbsRaw(b),this.AbsRaw(c));return 0==f?this.Min(b,c,e):0>f?this.RoundToPrecision(b,e):this.RoundToPrecision(c,e)};m.MaxMagnitude=function(b,c,e){if(null==b)throw"a";if(null==c)throw"b";var f=this.MinMaxHandleSpecial(b,c,e,!1,!0);if(null!=f)return f;f=this.compareTo(this.AbsRaw(b),this.AbsRaw(c));return 0==f?this.Max(b,c,e):
0<f?this.RoundToPrecision(b,e):this.RoundToPrecision(c,e)};m.Max=function(b,c,e){if(null==b)throw"a";if(null==c)throw"b";var f=this.MinMaxHandleSpecial(b,c,e,!1,!1);if(null!=f)return f;f=this.compareTo(b,c);if(0!=f)return 0>f?this.RoundToPrecision(c,e):this.RoundToPrecision(b,e);f=this.helper.GetFlags(b)&n.FlagNegative;return f!=(this.helper.GetFlags(c)&n.FlagNegative)?0!=f?this.RoundToPrecision(c,e):this.RoundToPrecision(b,e):0==f?0<this.helper.GetExponent(b).compareTo(this.helper.GetExponent(c))?
this.RoundToPrecision(b,e):this.RoundToPrecision(c,e):0<this.helper.GetExponent(b).compareTo(this.helper.GetExponent(c))?this.RoundToPrecision(c,e):this.RoundToPrecision(b,e)};m.Min=function(b,c,e){if(null==b)throw"a";if(null==c)throw"b";var f=this.MinMaxHandleSpecial(b,c,e,!0,!1);if(null!=f)return f;f=this.compareTo(b,c);if(0!=f)return 0<f?this.RoundToPrecision(c,e):this.RoundToPrecision(b,e);f=this.helper.GetFlags(b)&n.FlagNegative;return f!=(this.helper.GetFlags(c)&n.FlagNegative)?0!=f?this.RoundToPrecision(b,
e):this.RoundToPrecision(c,e):0==f?0<this.helper.GetExponent(b).compareTo(this.helper.GetExponent(c))?this.RoundToPrecision(c,e):this.RoundToPrecision(b,e):0<this.helper.GetExponent(b).compareTo(this.helper.GetExponent(c))?this.RoundToPrecision(b,e):this.RoundToPrecision(c,e)};m.Multiply=function(b,c,e){var f=this.helper.GetFlags(b),d=this.helper.GetFlags(c);if(0!=((f|d)&n.FlagSpecial)){var g=this.HandleNotANumber(b,c,e);if(null!=g)return g;if(0!=(f&n.FlagInfinity))return 0==(d&n.FlagSpecial)&&0==
this.helper.GetMantissa(c).signum()?this.SignalInvalid(e):this.EnsureSign(b,0!=(f&n.FlagNegative^d&n.FlagNegative));if(0!=(d&n.FlagInfinity))return 0==(f&n.FlagSpecial)&&0==this.helper.GetMantissa(b).signum()?this.SignalInvalid(e):this.EnsureSign(c,0!=(f&n.FlagNegative^d&n.FlagNegative))}g=this.helper.GetExponent(c);g=this.helper.GetExponent(b).add(g);f=f&n.FlagNegative^d&n.FlagNegative;b=this.helper.CreateNewWithFlags(this.helper.GetMantissa(b).multiply(this.helper.GetMantissa(c)),g,f);null!=e&&
(b=this.RoundToPrecision(b,e));return b};m.MultiplyAndAdd=function(b,c,e,f){var d=u.Unlimited.WithBlankFlags();b=this.Add(this.Multiply(b,c,d),e,f);f.getHasFlags()&&f.setFlags(f.getFlags()|d.getFlags());return b};m.RoundToBinaryPrecision=function(b,c){return this.RoundToBinaryPrecisionWithShift(b,c,0,0,new p(0),!1)};m.RoundToBinaryPrecisionWithShift=function(b,c,e,f,d,g){if(null==c||0==c.getPrecision().signum()&&!c.getHasExponentRange()&&0==(e|f)&&0==d.signum())return b;if(0==c.getPrecision().signum()||
2==this.thisRadix)return this.RoundToPrecisionWithShift(b,c,e,f,d,!1);var a=c.getHasExponentRange()?p.FromBig(c.getEMin()):null,h=c.getHasExponentRange()?p.FromBig(c.getEMax()):null,k=p.FromBig(c.getPrecision());g=[0];b=this.RoundToPrecisionInternal(b,k,c.getRounding(),a,h,e,f,d,!0,!1,g);if(c.getClampNormalExponents()&&null!=b){e=null;if(2==this.thisRadix)e=p.Copy(k);else{e=l.ONE;for(k=p.Copy(k);0<k.signum();)f=0<=k.CompareToInt(1E6)?1E6:k.AsInt32(),e=e.shiftLeft(f),k.SubtractInt(f);e=e.subtract(l.ONE);
e=this.helper.CreateShiftAccumulator(e).GetDigitLength()}h=p.Copy(h).AddInt(1).Subtract(e);e=p.FromBig(this.helper.GetExponent(b));0<e.compareTo(h)&&(k=0!=(this.helper.GetFlags(b)&n.FlagNegative),b=this.helper.GetMantissa(b).abs(),0!=b.signum()&&(e=p.Copy(e).Subtract(h),b=this.helper.MultiplyByRadixPower(b,e)),null!=g&&(g[0]|=u.FlagClamped),b=this.helper.CreateNewWithFlags(b,h.AsBigInteger(),k?n.FlagNegative:0))}c.getHasFlags()&&c.setFlags(c.getFlags()|g[0]);return b};m.Plus=function(b,c){return this.RoundToPrecisionWithShift(b,
c,0,0,new p(0),!0)};m.RoundToPrecision=function(b,c){return this.RoundToPrecisionWithShift(b,c,0,0,new p(0),!1)};m.RoundToPrecisionWithShift=function(b,c,e,f,d,g){if(null==c||0==c.getPrecision().signum()&&!c.getHasExponentRange()&&0==(e|f)&&0==d.signum())return b;var a=c.getHasExponentRange()?p.FromBig(c.getEMin()):null,h=c.getHasExponentRange()?p.FromBig(c.getEMax()):null,k=p.FromBig(c.getPrecision()),m=this.helper.GetFlags(b);if(0<k.signum()&&0>=k.CompareToInt(34)&&(null==d||0==d.signum())&&0==
(m&n.FlagSpecial)){var r=this.helper.GetMantissa(b).abs(),q=this.helper.MultiplyByRadixPower(l.ONE,k);g&&0!=(m&n.FlagNegative)&&0==r.signum()&&"Floor"!=c.getRounding()&&(b=this.EnsureSign(b,!1),m=0);if(0>r.compareTo(q))if(this.RoundGivenDigits(e,f,c.getRounding(),0!=(m&n.FlagNegative),r)){if(c.getHasFlags()&&0!=(e|f)&&c.setFlags(c.getFlags()|u.FlagInexact|u.FlagRounded),r=r.add(l.ONE),0>r.compareTo(q)){if(!c.getHasExponentRange())return this.helper.CreateNewWithFlags(r,this.helper.GetExponent(b),
m);q=p.FromBig(this.helper.GetExponent(b));q=p.Copy(q).Add(k).SubtractInt(1);s=p.Copy(a).Add(k).SubtractInt(1);if(0>=q.compareTo(h)&&0<=q.compareTo(s))return this.helper.CreateNewWithFlags(r,this.helper.GetExponent(b),m)}}else{c.getHasFlags()&&0!=(e|f)&&c.setFlags(c.getFlags()|u.FlagInexact|u.FlagRounded);if(!c.getHasExponentRange())return b;var q=p.FromBig(this.helper.GetExponent(b)),q=p.Copy(q).Add(k).SubtractInt(1),s=p.Copy(a).Add(k).SubtractInt(1);if(0>=q.compareTo(h)&&0<=q.compareTo(s))return b}}m=
[0];b=this.RoundToPrecisionInternal(b,k,c.getRounding(),a,h,e,f,d,!1,g,c.getHasFlags()?m:null);c.getClampNormalExponents()&&null!=b&&(h=p.Copy(h).AddInt(1).Subtract(k),q=p.FromBig(this.helper.GetExponent(b)),0<q.compareTo(h)&&(k=0!=(this.helper.GetFlags(b)&n.FlagNegative),b=this.helper.GetMantissa(b).abs(),0!=b.signum()&&(q=p.Copy(q).Subtract(h),b=this.helper.MultiplyByRadixPower(b,q)),null!=m&&(m[0]|=u.FlagClamped),b=this.helper.CreateNewWithFlags(b,h.AsBigInteger(),k?n.FlagNegative:0)));c.getHasFlags()&&
c.setFlags(c.getFlags()|m[0]);return b};m.Quantize=function(b,c,e){var f=this.helper.GetFlags(b),d=this.helper.GetFlags(c);if(0!=((f|d)&n.FlagSpecial)){var g=this.HandleNotANumber(b,c,e);if(null!=g)return g;if(0!=(f&d&n.FlagInfinity))return this.RoundToPrecision(b,e);if(0!=((f|d)&n.FlagInfinity))return this.SignalInvalid(e)}c=this.helper.GetExponent(c);if(null!=e&&!e.ExponentWithinRange(c))return this.SignalInvalidWithMessage(e,"Exponent not within exponent range: "+c.toString());var f=(null==e?u.ForRounding("HalfEven"):
e.Copy()).WithBlankFlags(),g=this.helper.GetMantissa(b).abs(),a=this.helper.GetExponent(b),h=a.compareTo(c),d=this.helper.GetFlags(b)&n.FlagNegative,k=null;if(0==h)k=this.RoundToPrecision(b,f);else if(0==g.signum())k=this.helper.CreateNewWithFlags(l.ZERO,c,d),k=this.RoundToPrecision(k,f);else if(0<h){b=p.FromBig(a).SubtractBig(c);if(0<f.getPrecision().signum()&&0<b.compareTo(p.FromBig(f.getPrecision()).AddInt(10)))return this.SignalInvalidWithMessage(e,"Result too high for current precision");g=this.helper.MultiplyByRadixPower(g,
b);k=this.helper.CreateNewWithFlags(g,c,d);k=this.RoundToPrecision(k,f)}else g=p.FromBig(c).SubtractBig(a),k=this.RoundToPrecisionWithShift(b,f,0,0,g,!1);if(0!=(f.getFlags()&u.FlagOverflow)||null==k||!this.helper.GetExponent(k).equals(c))return this.SignalInvalid(e);k=this.EnsureSign(k,0!=d);null!=e&&e.getHasFlags()&&(b=f.getFlags(),b&=~u.FlagUnderflow,e.setFlags(e.getFlags()|b));return k};m.RoundToExponentExact=function(b,c,e){if(0<=this.helper.GetExponent(b).compareTo(c))return this.RoundToPrecision(b,
e);var f=null==e?null:e.WithPrecision(0).WithBlankFlags();b=this.Quantize(b,this.helper.CreateNewWithFlags(l.ONE,c,0),f);null!=e&&e.getHasFlags()&&e.setFlags(e.getFlags()|f.getFlags());return b};m.RoundToExponentSimple=function(b,c,e){var f=this.helper.GetFlags(b);if(0!=(f&n.FlagSpecial)){var d=this.HandleNotANumber(b,b,e);if(null!=d)return d;if(0!=(f&n.FlagInfinity))return b}if(0<=this.helper.GetExponent(b).compareTo(c))return this.RoundToPrecision(b,e);if(null!=e&&!e.ExponentWithinRange(c))return this.SignalInvalidWithMessage(e,
"Exponent not within exponent range: "+c.toString());d=this.helper.GetMantissa(b).abs();b=p.FromBig(c).SubtractBig(this.helper.GetExponent(b));var g=this.helper.CreateShiftAccumulator(d);g.ShiftRight(b);d=g.getShiftedInt();return this.RoundToPrecisionWithShift(this.helper.CreateNewWithFlags(d,c,f),e,g.getLastDiscardedDigit(),g.getOlderDiscardedDigits(),new p(0),!1)};m.RoundToExponentNoRoundedFlag=function(b,c,e){var f=null==e?null:e.WithBlankFlags();b=this.RoundToExponentExact(b,c,f);null!=e&&e.getHasFlags()&&
e.setFlags(e.getFlags()|f.getFlags()&~(u.FlagInexact|u.FlagRounded));return b};m.Reduce=function(b,c){var e=this.RoundToPrecision(b,c);if(null!=e&&0==(this.helper.GetFlags(e)&n.FlagSpecial)){var f=this.helper.GetMantissa(e).abs(),e=p.FromBig(this.helper.GetExponent(e));if(0==f.signum())e=new p(0);else for(var d=l.valueOf(this.thisRadix);0!=f.signum();){var g,a=f.divideAndRemainder(d);g=a[0];if(0!=a[1].signum())break;f=g;e.AddInt(1)}d=this.helper.GetFlags(b);e=this.helper.CreateNewWithFlags(f,e.AsBigInteger(),
d);null!=c&&c.getClampNormalExponents()&&(f=c.WithBlankFlags(),e=this.RoundToPrecision(e,f),c.getHasFlags()&&c.setFlags(c.getFlags()|f.getFlags()&~u.FlagClamped));e=this.EnsureSign(e,0!=(d&n.FlagNegative))}return e};m.RoundToPrecisionInternal=function(b,c,e,f,d,g,a,h,k,m,r){if(0>c.signum())throw"precision not greater or equal to 0 ("+c+")";if(2==this.thisRadix||0==c.signum())k=!1;var q=this.helper.GetFlags(b);if(0!=(q&n.FlagSpecial)){if(0!=(q&n.FlagSignalingNaN))return null!=r&&(r[0]|=u.FlagInvalid),
this.ReturnQuietNaNFastIntPrecision(b,c);if(0!=(q&n.FlagQuietNaN))return this.ReturnQuietNaNFastIntPrecision(b,c);if(0!=(q&n.FlagInfinity))return b}m&&0!=(q&n.FlagNegative)&&0==this.helper.GetMantissa(b).signum()&&"Floor"!=e&&(b=this.EnsureSign(b,!1),q=0);m=0!=(q&n.FlagNegative);var s=this.helper.GetMantissa(b).abs(),t=s,v=0==t.signum()&&0==(g|a),w=l.ONE,y=p.FromBig(this.helper.GetExponent(b));b=0;var x=this.helper.CreateShiftAccumulatorWithDigits(s,g,a),z=0==c.signum(),A=c;if(k){for(A=p.Copy(c);0<
A.signum();)c=0<=A.CompareToInt(1E6)?1E6:A.AsInt32(),w=w.shiftLeft(c),A.SubtractInt(c);w=w.subtract(l.ONE);A=this.helper.CreateShiftAccumulator(w).GetDigitLength()}else A=c;null!=h&&x.ShiftRight(h);z?A=x.GetDigitLength():x.ShiftToDigits(A);if(k)for(;0<x.getShiftedInt().compareTo(w);)x.ShiftRightInt(1);h=p.Copy(x.getDiscardedDigitCount());y.Add(h);var B=c=p.Copy(y).Add(x.GetDigitLength()).SubtractInt(1),E=null,E=l.ZERO;if(k&&null!=d&&0==c.compareTo(d)){var D=p.Copy(A).Subtract(x.GetDigitLength()),
C=x.getShiftedInt(),C=this.helper.MultiplyByRadixPower(C,D);0<C.compareTo(w)&&c.AddInt(1)}null!=r&&null!=f&&0>c.compareTo(f)&&(E=x.getShiftedInt(),this.RoundGivenBigInt(x,e,m,E)&&(E=E.add(l.ONE),!1==E.testBit(0)&&0==(this.thisRadix&1)&&(B=this.helper.CreateShiftAccumulator(E),B.ShiftToDigits(A),0!=B.getDiscardedDigitCount().signum()&&(E=B.getShiftedInt()),B=p.Copy(y).Add(B.GetDigitLength()).SubtractInt(1))));if(null!=d&&0<c.compareTo(d)){if(v)return null!=r&&(r[0]=b|u.FlagClamped),this.helper.CreateNewWithFlags(t,
d.AsBigInteger(),q);b=b|u.FlagOverflow|u.FlagInexact|u.FlagRounded;if("Unnecessary"==e)throw"Rounding was required";if(!z&&("Down"==e||"ZeroFiveUp"==e||"Ceiling"==e&&m||"Floor"==e&&!m))return e=l.ZERO,k?e=w:(e=this.helper.MultiplyByRadixPower(l.ONE,A),e=e.subtract(l.ONE)),null!=r&&(r[0]=b),E=p.Copy(d).AddInt(1).Subtract(A),this.helper.CreateNewWithFlags(e,E.AsBigInteger(),m?n.FlagNegative:0);null!=r&&(r[0]=b);return this.SignalOverflow(m)}if(null!=f&&0>c.compareTo(f)&&(q=p.Copy(f).Subtract(A).AddInt(1),
null!=r&&0!=E.signum()&&0>B.compareTo(f)&&(b|=u.FlagSubnormal),0>p.Copy(y).compareTo(q))){D=p.Copy(q).Subtract(y);D.Add(h);x=this.helper.CreateShiftAccumulatorWithDigits(t,g,a);x.ShiftRight(D);d=x.getShiftedIntFast();if(0!=(x.getLastDiscardedDigit()|x.getOlderDiscardedDigits())&&"Unnecessary"==e)throw"Rounding was required";if(0!=x.getDiscardedDigitCount().signum()||0!=(x.getLastDiscardedDigit()|x.getOlderDiscardedDigits()))null!=r&&(v||(b|=u.FlagRounded),0!=(x.getLastDiscardedDigit()|x.getOlderDiscardedDigits())&&
(b=b|u.FlagInexact|u.FlagRounded)),this.Round(x,e,m,d)&&d.AddInt(1);null!=r&&(0==d.signum()&&(b|=u.FlagClamped),(b&(u.FlagSubnormal|u.FlagInexact))==(u.FlagSubnormal|u.FlagInexact)&&(b=b|u.FlagUnderflow|u.FlagRounded),r[0]=b);return this.helper.CreateNewWithFlags(d.AsBigInteger(),q.AsBigInteger(),m?n.FlagNegative:0)}f=!1;if(0!=x.getDiscardedDigitCount().signum()||0!=(x.getLastDiscardedDigit()|x.getOlderDiscardedDigits())){0!=s.signum()&&(b|=u.FlagRounded);s=x.getShiftedInt();if(0!=(x.getLastDiscardedDigit()|
x.getOlderDiscardedDigits())&&(b=b|u.FlagInexact|u.FlagRounded,"Unnecessary"==e))throw"Rounding was required";if(this.RoundGivenBigInt(x,e,m,s)&&(s=s.add(l.ONE),k&&(f=!0),!1==s.testBit(0)&&0==(this.thisRadix&1))){x=this.helper.CreateShiftAccumulator(s);x.ShiftToDigits(A);if(k)for(;0<x.getShiftedInt().compareTo(w);)x.ShiftRightInt(1);0!=x.getDiscardedDigitCount().signum()&&(y.Add(x.getDiscardedDigitCount()),h.Add(x.getDiscardedDigitCount()),s=x.getShiftedInt(),k||(f=!0))}}if(f&&null!=d&&(c=p.Copy(y),
c.Add(x.GetDigitLength()).SubtractInt(1),k&&null!=d&&0==c.compareTo(d)&&(D=p.Copy(A).Subtract(x.GetDigitLength()),C=x.getShiftedInt(),C=this.helper.MultiplyByRadixPower(C,D),0<C.compareTo(w)&&c.AddInt(1)),0<c.compareTo(d))){b=b|u.FlagOverflow|u.FlagInexact|u.FlagRounded;if(!z&&("Down"==e||"ZeroFiveUp"==e||"Ceiling"==e&&m||"Floor"==e&&!m))return k?e=w:(e=this.helper.MultiplyByRadixPower(l.ONE,A),e=e.subtract(l.ONE)),null!=r&&(r[0]=b),E=p.Copy(d).AddInt(1).Subtract(A),this.helper.CreateNewWithFlags(e,
E.AsBigInteger(),m?n.FlagNegative:0);null!=r&&(r[0]=b);return this.SignalOverflow(m)}null!=r&&(r[0]=b);return this.helper.CreateNewWithFlags(s,y.AsBigInteger(),m?n.FlagNegative:0)};m.AddCore=function(b,c,e,f,d,g){f=0!=(f&n.FlagNegative);d=0!=(d&n.FlagNegative);var a=!1;f!=d?(b=b.subtract(c),c=b.signum(),a=f^(0==c?d:0>c)):(b=b.add(c),a=f);0==b.signum()&&a&&(f&&d||f^d&&null!=g&&"Floor"==g.getRounding()||(a=!1));return this.helper.CreateNewWithFlags(b,e,a?n.FlagNegative:0)};m.Add=function(b,c,e){var f=
this.helper.GetFlags(b),d=this.helper.GetFlags(c);if(0!=((f|d)&n.FlagSpecial)){var g=this.HandleNotANumber(b,c,e);if(null!=g)return g;if(0!=(f&n.FlagInfinity))return 0!=(d&n.FlagInfinity)&&(f&n.FlagNegative)!=(d&n.FlagNegative)?this.SignalInvalid(e):b;if(0!=(d&n.FlagInfinity))return c}var a=this.helper.GetExponent(b).compareTo(this.helper.GetExponent(c)),g=null,g=this.helper.GetMantissa(b).abs(),h=this.helper.GetMantissa(c).abs();if(0==a)g=this.AddCore(g,h,this.helper.GetExponent(b),f,d,e);else{var k=
c,m=this.helper.GetExponent(b),k=this.helper.GetExponent(k),r=0>a?m:k,q=p.FromBig(m),s=p.FromBig(k),t=p.Copy(q).Subtract(s).Abs();if(null!=e&&0<e.getPrecision().signum()){var u=p.FromBig(e.getPrecision());if(0<p.Copy(t).compareTo(u)){a=q.compareTo(s);if(0>a){if(0!=h.signum()&&(a=this.helper.CreateShiftAccumulator(g).GetDigitLength(),0>p.Copy(q).Add(a).AddInt(2).compareTo(s)&&(a=p.Copy(s).SubtractInt(4).Subtract(a).SubtractBig(e.getPrecision()),q=p.Copy(a).Subtract(s).Abs(),0>q.compareTo(t)))){if(this.helper.GetSign(b)==
this.helper.GetSign(c)){a=this.helper.CreateShiftAccumulator(h).GetDigitLength();if(0>a.compareTo(u))return f=p.Copy(u).Subtract(a),h=this.helper.MultiplyByRadixPower(h,f),f=f.AsBigInteger(),k=k.subtract(f),c=this.helper.CreateNewWithFlags(h,k,this.helper.GetFlags(c)),this.RoundToPrecisionWithShift(c,e,0,1,null,!1);f=p.Copy(a).Subtract(u);return this.RoundToPrecisionWithShift(c,e,0,1,f,!1)}0!=g.signum()&&(g=l.ONE);m=a.AsBigInteger()}}else if(0<a&&0!=g.signum()&&(a=this.helper.CreateShiftAccumulator(h).GetDigitLength(),
0>p.Copy(s).Add(a).AddInt(2).compareTo(q)&&(a=p.Copy(q).SubtractInt(4).Subtract(a).SubtractBig(e.getPrecision()),q=p.Copy(a).Subtract(q).Abs(),0>q.compareTo(t)))){if(this.helper.GetSign(b)==this.helper.GetSign(c)){a=this.helper.CreateShiftAccumulator(g).GetDigitLength();if(0>a.compareTo(u))return f=p.Copy(u).Subtract(a),g=this.helper.MultiplyByRadixPower(g,f),f=f.AsBigInteger(),m=m.subtract(f),b=this.helper.CreateNewWithFlags(g,m,this.helper.GetFlags(b)),this.RoundToPrecisionWithShift(b,e,0,1,null,
!1);f=p.Copy(a).Subtract(u);return this.RoundToPrecisionWithShift(b,e,0,1,f,!1)}0!=h.signum()&&(h=l.ONE);k=a.AsBigInteger()}a=m.compareTo(k);r=0>a?m:k}}0<a?g=this.helper.RescaleByExponentDiff(g,m,k):h=this.helper.RescaleByExponentDiff(h,m,k);g=this.AddCore(g,h,r,f,d,e)}null!=e&&(g=this.RoundToPrecision(g,e));return g};m.CompareToWithContext=function(b,c,e,f){if(null==c)return this.SignalInvalid(f);e=this.CompareToHandleSpecial(b,c,e,f);return null!=e?e:this.ValueOf(this.compareTo(b,c),null)};m.compareTo=
function(b,c){if(null==c)return 1;var e=this.helper.GetFlags(b),f=this.helper.GetFlags(c);if(0!=(e&n.FlagNaN))return 0!=(f&n.FlagNaN)?0:1;if(0!=(f&n.FlagNaN))return-1;e=this.CompareToHandleSpecialReturnInt(b,c);if(1>=e)return e;e=this.helper.GetSign(b);f=this.helper.GetSign(c);if(e!=f)return e<f?-1:1;if(0==f||0==e)return 0;var d=this.helper.GetExponent(b).compareTo(this.helper.GetExponent(c)),g=this.helper.GetMantissa(b).abs().compareTo(this.helper.GetMantissa(c).abs());0>e&&(g=-g);if(0==g)return 0>
e?-d:d;if(0==d)return g;var g=this.helper.GetExponent(b),a=this.helper.GetExponent(c),h=p.FromBig(g),k=p.FromBig(a),l=p.Copy(h).Subtract(k).Abs();if(0<=l.CompareToInt(100)){var m=this.helper.GetMantissa(b).abs(),r=this.helper.GetMantissa(c).abs(),q=this.helper.CreateShiftAccumulator(m).GetDigitLength(),s=this.helper.CreateShiftAccumulator(r).GetDigitLength(),t=null,t=0<q.compareTo(s)?q:s;if(0<p.Copy(l).compareTo(t)){d=h.compareTo(k);if(0>d){if(0!=r.signum()&&(d=this.helper.CreateShiftAccumulator(m).GetDigitLength(),
0>p.Copy(h).Add(d).AddInt(2).compareTo(k)&&(t=p.Copy(k).SubtractInt(8).Subtract(d).Subtract(t),h=p.Copy(t).Subtract(k).Abs(),0>h.compareTo(l)))){if(e==f)return 0>e?1:-1;g=t.AsBigInteger()}}else if(0<d&&0!=m.signum()&&(d=this.helper.CreateShiftAccumulator(r).GetDigitLength(),0>p.Copy(k).Add(d).AddInt(2).compareTo(h)&&(t=p.Copy(h).SubtractInt(8).Subtract(d).Subtract(t),h=p.Copy(t).Subtract(h).Abs(),0>h.compareTo(l)))){if(e==f)return 0>e?-1:1;a=t.AsBigInteger()}d=g.compareTo(a)}}0<d?(f=this.helper.RescaleByExponentDiff(this.helper.GetMantissa(b),
g,a),g=this.helper.GetMantissa(c).abs(),f=f.abs(),g=f.compareTo(g)):(f=this.helper.RescaleByExponentDiff(this.helper.GetMantissa(c),g,a),g=this.helper.GetMantissa(b).abs(),f=f.abs(),g=g.compareTo(f));return 0>e?-g:g}})(z,z.prototype);var r=function(l,m){this.exponent=m;var b=l.signum();this.unsignedMantissa=0>b?l.negate():l;this.flags=0>b?n.FlagNegative:0};(function(s,m){m.exponent=null;m.unsignedMantissa=null;m.flags=null;m.getExponent=function(){return this.exponent};m.getUnsignedMantissa=function(){return this.unsignedMantissa};
m.getMantissa=function(){return this.isNegative()?this.unsignedMantissa.negate():this.unsignedMantissa};m.EqualsInternal=function(b){return null==b?!1:this.exponent.equals(b.exponent)&&this.unsignedMantissa.equals(b.unsignedMantissa)&&this.flags==b.flags};m.equals=function(b){return this.EqualsInternal(b.constructor==r?b:null)};m.hashCode=function(){var b;b=0+1000000007*this.exponent.hashCode();b+=1000000009*this.unsignedMantissa.hashCode();return b+=1000000009*this.flags};s.CreateWithFlags=function(b,
c,e){b=new r(b,c);b.flags=e;return b};s.MaxSafeInt=214748363;s.FromString=function(b){if(null==b)throw"str";if(0==b.length)throw"exception";var c=0,e=!1;if("+"==b.charAt(0)||"-"==b.charAt(0))e="-"==b.charAt(0),c++;var f=0,d=null,g=!1,a=!1,h=!1,k=0,m=null,q=c;if(q+8==b.length&&!("I"!=b.charAt(q)&&"i"!=b.charAt(q)||"N"!=b.charAt(q+1)&&"n"!=b.charAt(q+1)||"F"!=b.charAt(q+2)&&"f"!=b.charAt(q+2)||"I"!=b.charAt(q+3)&&"i"!=b.charAt(q+3)||"N"!=b.charAt(q+4)&&"n"!=b.charAt(q+4)||"I"!=b.charAt(q+5)&&"i"!=b.charAt(q+
5)||"T"!=b.charAt(q+6)&&"t"!=b.charAt(q+6)||"Y"!=b.charAt(q+7)&&"y"!=b.charAt(q+7))||q+3==b.length&&!("I"!=b.charAt(q)&&"i"!=b.charAt(q)||"N"!=b.charAt(q+1)&&"n"!=b.charAt(q+1)||"F"!=b.charAt(q+2)&&"f"!=b.charAt(q+2)))return e?r.NegativeInfinity:r.PositiveInfinity;if(q+3<=b.length&&!("N"!=b.charAt(q)&&"n"!=b.charAt(q)||"A"!=b.charAt(q+1)&&"a"!=b.charAt(q+1)||"N"!=b.charAt(q+2)&&"n"!=b.charAt(q+2))){if(q+3==b.length)return e?r.CreateWithFlags(l.ZERO,l.ZERO,(e?n.FlagNegative:0)|n.FlagQuietNaN):r.NaN;
for(q+=3;q<b.length;q++)if("0"<=b.charAt(q)&&"9">=b.charAt(q)){var s=b.charCodeAt(q)-48|0;f>r.MaxSafeInt?(null==d&&(d=new p(f)),d.Multiply(10),d.AddInt(s)):(f*=10,f+=s)}else throw"exception";b=null==d?l.valueOf(f):d.AsBigInteger();return r.CreateWithFlags(b,l.ZERO,(e?n.FlagNegative:0)|n.FlagQuietNaN)}if(q+4<=b.length&&!("S"!=b.charAt(q)&&"s"!=b.charAt(q)||"N"!=b.charAt(q+1)&&"n"!=b.charAt(q+1)||"A"!=b.charAt(q+2)&&"a"!=b.charAt(q+2)||"N"!=b.charAt(q+3)&&"n"!=b.charAt(q+3))){if(q+4==b.length)return e?
r.CreateWithFlags(l.ZERO,l.ZERO,n.FlagSignalingNaN):r.SignalingNaN;for(q+=4;q<b.length;q++)if("0"<=b.charAt(q)&&"9">=b.charAt(q))s=b.charCodeAt(q)-48|0,f>r.MaxSafeInt?(null==d&&(d=new p(f)),d.Multiply(10),d.AddInt(s)):(f*=10,f+=s);else throw"exception";b=null==d?l.valueOf(f):d.AsBigInteger();return r.CreateWithFlags(b,l.ZERO,(e?n.FlagNegative:0)|n.FlagSignalingNaN)}for(;q<b.length;q++)if("0"<=b.charAt(q)&&"9">=b.charAt(q))s=b.charCodeAt(q)-48|0,f>r.MaxSafeInt?(null==d&&(d=new p(f)),d.Multiply(10),
d.AddInt(s)):(f*=10,f+=s),a=!0,g&&(-2147483648==k?(null==m&&(m=new p(k)),m.AddInt(-1)):k--);else if("."==b.charAt(q)){if(g)throw"exception";g=!0}else if("E"==b.charAt(q)||"e"==b.charAt(q)){h=!0;q++;break}else throw"exception";if(!a)throw"exception";if(h){g=null;h=0;c=1;a=!1;if(q==b.length)throw"exception";if("+"==b.charAt(q)||"-"==b.charAt(q))"-"==b.charAt(q)&&(c=-1),q++;for(;q<b.length;q++)if("0"<=b.charAt(q)&&"9">=b.charAt(q))a=!0,s=b.charCodeAt(q)-48|0,h>r.MaxSafeInt?(null==g&&(g=new p(h)),g.Multiply(10),
g.AddInt(s)):(h*=10,h+=s);else throw"exception";if(!a)throw"exception";0<=c&&0==k&&null==m&&null==g?k=h:null==g?(null==m&&(m=new p(k)),0>c?m.SubtractInt(h):m.AddInt(h)):(null==m&&(m=new p(k)),0>c?m.Subtract(g):m.Add(g))}else if(q!=b.length)throw"exception";return r.CreateWithFlags(null==d?l.valueOf(f):d.AsBigInteger(),null==m?l.valueOf(k):m.AsBigInteger(),e?n.FlagNegative:0)};s.DecimalMathHelper=function(){};(function(b,c){c.GetRadix=function(){return 10};c.GetSign=function(b){return b.signum()};
c.GetMantissa=function(b){return b.unsignedMantissa};c.GetExponent=function(b){return b.exponent};c.RescaleByExponentDiff=function(b,c,d){b.signum();if(0==b.signum())return l.ZERO;c=p.FromBig(c).SubtractBig(d).Abs();return b=c.CanFitInInt32()?b.multiply(v.FindPowerOfTen(c.AsInt32())):b.multiply(v.FindPowerOfTenFromBig(c.AsBigInteger()))};c.CreateNew=function(b,c){return new r(b,c)};c.CreateShiftAccumulatorWithDigits=function(b,c,d){return new B(b,c,d)};c.CreateShiftAccumulator=function(b){return new B(b,
0,0)};c.HasTerminatingRadixExpansion=function(b,c){var d=b.gcd(c);c=c.divide(d);if(0==c.signum())return!1;for(;!1==c.testBit(0);)c=c.shiftRight(1);for(;;){var g=c.divideAndRemainder(l.valueOf(5)),d=g[0];if(0!=g[1].signum())break;c=d}return 0==c.compareTo(l.ONE)};c.MultiplyByRadixPower=function(b,c){return 0>=c.signum()||0==b.signum()?b:0!=b.compareTo(l.ONE)?b=c.CanFitInInt32()?b.multiply(v.FindPowerOfTen(c.AsInt32())):b.multiply(v.FindPowerOfTenFromBig(c.AsBigInteger())):c.CanFitInInt32()?v.FindPowerOfTen(c.AsInt32()):
v.FindPowerOfTenFromBig(c.AsBigInteger())};c.GetFlags=function(b){return b.flags};c.CreateNewWithFlags=function(b,c,d){return r.CreateWithFlags(b,c,d)};c.GetArithmeticSupport=function(){return n.FiniteAndNonFinite};c.ValueOf=function(b){return r.FromInt64(b)}})(r.DecimalMathHelper,r.DecimalMathHelper.prototype);s.AppendString=function(b,c,e){if(0<e.CompareToInt(2147483647)||0>e.signum())throw"exception";for(e=e.AsInt32()-1;0<=e;e--)b.append(c);return!0};m.ToStringInternal=function(b){var c=0!=(this.flags&
n.FlagNegative);if(0!=(this.flags&n.FlagInfinity))return c?"-Infinity":"Infinity";if(0!=(this.flags&n.FlagSignalingNaN))return 0==this.unsignedMantissa.signum()?c?"-sNaN":"sNaN":c?"-sNaN"+this.unsignedMantissa.abs().toString():"sNaN"+this.unsignedMantissa.abs().toString();if(0!=(this.flags&n.FlagQuietNaN))return 0==this.unsignedMantissa.signum()?c?"-NaN":"NaN":c?"-NaN"+this.unsignedMantissa.abs().toString():"NaN"+this.unsignedMantissa.abs().toString();var e=this.unsignedMantissa.abs().toString(),
f=-this.exponent.signum();if(0==f)return c?"-"+e:e;var d=0==this.unsignedMantissa.signum();if(2==b&&d&&0>f)return c?"-"+e:e;var g=new p(e.length),a=p.FromBig(this.exponent),h=p.Copy(a);a.Add(g).AddInt(-1);var k=new p(1),l=new p(-6);if(1==b){var m=p.Copy(a),s=0>a.signum(),t=p.Copy(a).Abs().Mod(3).AsInt32();d&&(0>a.compareTo(l)||0>f)?(1==t?s?(k.AddInt(1),m.AddInt(1)):(k.AddInt(2),m.AddInt(2)):2==t&&(s?(k.AddInt(2),m.AddInt(2)):(k.AddInt(1),m.AddInt(1))),l.AddInt(1)):1==t?s?(k.AddInt(2),m.AddInt(-2)):
(k.AddInt(1),m.AddInt(-1)):2==t&&(s?(k.AddInt(1),m.AddInt(-1)):(k.AddInt(2),m.AddInt(-2)));a=m}if(2==b||0<=a.compareTo(l)&&0<=f){if(0<f){a=p.Copy(h).Add(g);k=a.CompareToInt(0);b=null;if(0>k)b=(new p(e.length)).AddInt(6),b=q.createStringBuilder(0<b.CompareToInt(2147483647)?2147483647:b.AsInt32()),c&&b.append("-"),b.append("0."),r.AppendString(b,"0",p.Copy(a).Negate()),b.append(e);else{if(0==k){if(!a.CanFitInInt32())throw"exception";g=a.AsInt32();0>g&&(g=0);b=(new p(e.length)).AddInt(6);b=q.createStringBuilder(0<
b.CompareToInt(2147483647)?2147483647:b.AsInt32());c&&b.append("-");for(c=0;c<0+g;c++)b.append(e.charAt(c));b.append("0.")}else{if(0<a.CompareToInt(e.length)){if(!g.CanFitInInt32())throw"exception";g=g.AsInt32();0>g&&(g=0);b=(new p(e.length)).AddInt(6);b=q.createStringBuilder(0<b.CompareToInt(2147483647)?2147483647:b.AsInt32());c&&b.append("-");for(c=0;c<0+g;c++)b.append(e.charAt(c));r.AppendString(b,"0",p.Copy(a).SubtractInt(b.length))}else{if(!a.CanFitInInt32())throw"exception";g=a.AsInt32();0>
g&&(g=0);b=(new p(e.length)).AddInt(6);b=q.createStringBuilder(0<b.CompareToInt(2147483647)?2147483647:b.AsInt32());c&&b.append("-");for(c=0;c<0+g;c++)b.append(e.charAt(c))}b.append(".")}for(c=g;c<g+(e.length-g);c++)b.append(e.charAt(c))}return b.toString()}return 2==b&&0>f?(a=p.Copy(h),b=q.createStringBuilder(16),c&&b.append("-"),b.append(e),r.AppendString(b,"0",a),b.toString()):c?"-"+e:e}if(1==b&&d&&0<k.CompareToInt(1))b=q.createStringBuilder(16),c&&b.append("-"),b.append(e),b.append("."),r.AppendString(b,
"0",p.Copy(k).AddInt(-1));else if(f=p.Copy(k),k=f.CompareToInt(e.length),0<k)f.SubtractInt(e.length),b=q.createStringBuilder(16),c&&b.append("-"),b.append(e),r.AppendString(b,"0",f);else if(0>k){if(!f.CanFitInInt32())throw"exception";g=f.AsInt32();0>f.signum()&&(g=0);b=(new p(e.length)).AddInt(6);b=q.createStringBuilder(0<b.CompareToInt(2147483647)?2147483647:b.AsInt32());c&&b.append("-");for(c=0;c<0+g;c++)b.append(e.charAt(c));b.append(".");for(c=g;c<g+(e.length-g);c++)b.append(e.charAt(c))}else if(0!=
a.signum()||c){if(0==a.signum()&&c)return"-"+e;b=q.createStringBuilder(16);c&&b.append("-");b.append(e)}else return e;if(0!=a.signum()){b.append(0>a.signum()?"E-":"E+");a.Abs();for(e=q.createStringBuilder(16);0!=a.signum();)c=p.Copy(a).Mod(10).AsInt32(),e.append(48+c),a.Divide(10);a=e.length();for(c=0;c<a;c++)b.append(e.charAt(a-1-c))}return b.toString()};m.ToBigInteger=function(){var b=this.getExponent().signum();if(0==b)b=this.getMantissa();else if(0<b)b=this.getMantissa(),b=b.multiply(v.FindPowerOfTenFromBig(this.getExponent()));
else var b=this.getMantissa(),c=this.getExponent(),c=c.negate(),b=b.divide(v.FindPowerOfTenFromBig(c));return b};s.OneShift62=l.ONE.shiftLeft(62);m.ToExtendedFloat=function(){if(this.IsNaN()||this.IsInfinity())return t.CreateWithFlags(this.unsignedMantissa,this.exponent,this.flags);var b=this.getExponent(),c=this.getMantissa();if(0==c.signum())return this.isNegative()?t.NegativeZero:t.Zero;if(0==b.signum())return t.FromBigInteger(c);if(0<b.signum())return c=c.multiply(v.FindPowerOfTenFromBig(b)),
t.FromBigInteger(c);var b=p.FromBig(b),e=0>c.signum(),f;e&&(c=c.negate());for(var d=p.Copy(b).Negate(),d=v.FindPowerOfFiveFromBig(d.AsBigInteger());;){var g;f=c.divideAndRemainder(d);g=f[0];f=f[1];if(0!=f.signum()&&0>g.compareTo(r.OneShift62)){g=p.GetLastWords(g,2);var a=0;0!=(g[0]|g[1])?(a=v.BitPrecisionInt(g[1]),a=0!=a?a+32:v.BitPrecisionInt(g[0]),a=63-a):a=1;b.SubtractInt(a);c=c.shiftLeft(a)}else{c=g;break}}d=d.shiftRight(1);0<f.compareTo(d)&&(c=c.add(l.ONE));e&&(c=c.negate());return new t(c,b.AsBigInteger())};
m.ToSingle=function(){return this.IsPositiveInfinity()?Number.POSITIVE_INFINITY:this.IsNegativeInfinity()?Number.NEGATIVE_INFINITY:this.isNegative()&&0==this.signum()?Float.intBitsToFloat(-2147483648):this.ToExtendedFloat().ToSingle()};m.ToDouble=function(){return this.IsPositiveInfinity()?Number.POSITIVE_INFINITY:this.IsNegativeInfinity()?Number.NEGATIVE_INFINITY:this.isNegative()&&0==this.signum()?D.IntegersToDouble([-2147483648,0]):this.ToExtendedFloat().ToDouble()};s.FromSingle=function(b){var c=
Float.floatToRawIntBits(b);b=0!=c>>31;var e=c>>23&255,c=c&8388607;if(255==e){if(0==c)return b?r.NegativeInfinity:r.PositiveInfinity;e=0!=(c&4194304);c=l.valueOf(c&2097151);c=c.subtract(l.ONE);return 0==c.signum()?e?r.NaN:r.SignalingNaN:r.CreateWithFlags(c,l.ZERO,(b?n.FlagNegative:0)|(e?n.FlagQuietNaN:n.FlagSignalingNaN))}0==e?e++:c|=8388608;if(0==c)return b?r.NegativeZero:r.Zero;for(e-=150;0==(c&1);)e++,c>>=1;if(0==e)return b&&(c=-c),r.FromInt64(c);if(0<e)return c=l.valueOf(c),c=c.shiftLeft(e),b&&
(c=c.negate()),r.FromBigInteger(c);c=l.valueOf(c);c=c.multiply(v.FindPowerOfFive(-e));b&&(c=c.negate());return new r(c,l.valueOf(e))};s.FromBigInteger=function(b){return new r(b,l.ZERO)};s.FromInt64=function(b){b=q.createLong(b);b=l.valueOf(b);return new r(b,l.ZERO)};s.FromDouble=function(b){var c=D.DoubleToIntegers(b),e=c[1]>>20&2047;b=0!=c[1]>>31;if(2047==e){if(0==(c[1]&1048575)&&0==c[0])return b?r.NegativeInfinity:r.PositiveInfinity;e=0!=(c[1]&524288);c[1]&=262143;c=p.WordsToBigInteger(c);c=c.subtract(l.ONE);
return 0==c.signum()?e?r.NaN:r.SignalingNaN:r.CreateWithFlags(c,l.ZERO,(b?n.FlagNegative:0)|(e?n.FlagQuietNaN:n.FlagSignalingNaN))}c[1]&=1048575;0==e?e++:c[1]|=1048576;if(0!=(c[1]|c[0]))e+=v.ShiftAwayTrailingZerosTwoElements(c);else return b?r.NegativeZero:r.Zero;e-=1075;c=p.WordsToBigInteger(c);if(0==e)return b&&(c=c.negate()),r.FromBigInteger(c);if(0<e)return c=c.shiftLeft(e),b&&(c=c.negate()),r.FromBigInteger(c);c=c.multiply(v.FindPowerOfFive(-e));b&&(c=c.negate());return new r(c,l.valueOf(e))};
s.FromExtendedFloat=function(b){if(null==b)throw"bigfloat";if(b.IsNaN()||b.IsInfinity())return r.CreateWithFlags(b.getUnsignedMantissa(),b.getExponent(),(b.isNegative()?n.FlagNegative:0)|(b.IsInfinity()?n.FlagInfinity:0)|(b.IsQuietNaN()?n.FlagQuietNaN:0)|(b.IsSignalingNaN()?n.FlagSignalingNaN:0));var c=b.getExponent(),e=b.getMantissa();if(0==e.signum())return b.isNegative()?r.NegativeZero:r.Zero;if(0==c.signum())return r.FromBigInteger(e);if(0<c.signum()){c=p.FromBig(c);for((b=0>e.signum())&&(e=e.negate());0<
c.signum();){var f=512;0>c.CompareToInt(512)&&(f=c.AsInt32());e=e.shiftLeft(f);c.AddInt(-f)}b&&(e=e.negate());return r.FromBigInteger(e)}b=c.negate();e=e.multiply(v.FindPowerOfFiveFromBig(b));return new r(e,c)};m.toString=function(){return this.ToStringInternal(0)};m.ToEngineeringString=function(){return this.ToStringInternal(1)};m.ToPlainString=function(){return this.ToStringInternal(2)};s.One=new r(l.ONE,l.ZERO);s.Zero=new r(l.ZERO,l.ZERO);s.NegativeZero=r.CreateWithFlags(l.ZERO,l.ZERO,n.FlagNegative);
s.Ten=new r(l.TEN,l.ZERO);s.NaN=r.CreateWithFlags(l.ZERO,l.ZERO,n.FlagQuietNaN);s.SignalingNaN=r.CreateWithFlags(l.ZERO,l.ZERO,n.FlagSignalingNaN);s.PositiveInfinity=r.CreateWithFlags(l.ZERO,l.ZERO,n.FlagInfinity);s.NegativeInfinity=r.CreateWithFlags(l.ZERO,l.ZERO,n.FlagInfinity|n.FlagNegative);m.IsPositiveInfinity=function(){return(this.flags&(n.FlagInfinity|n.FlagNegative))==(n.FlagInfinity|n.FlagNegative)};m.IsNegativeInfinity=function(){return(this.flags&(n.FlagInfinity|n.FlagNegative))==n.FlagInfinity};
m.IsNaN=function(){return 0!=(this.flags&(n.FlagQuietNaN|n.FlagSignalingNaN))};m.IsInfinity=function(){return 0!=(this.flags&n.FlagInfinity)};m.isNegative=function(){return 0!=(this.flags&n.FlagNegative)};m.IsQuietNaN=function(){return 0!=(this.flags&n.FlagQuietNaN)};m.IsSignalingNaN=function(){return 0!=(this.flags&n.FlagSignalingNaN)};m.signum=function(){return 0==this.unsignedMantissa.signum()?0:0!=(this.flags&n.FlagNegative)?-1:1};m.isZero=function(){return 0==this.unsignedMantissa.signum()};
m.DivideToSameExponent=function(b,c){return this.DivideToExponent(b,this.exponent,u.ForRounding(c))};m.Reduce=function(b){return r.math.Reduce(this,b)};m.RemainderNaturalScale=function(b,c){return this.Subtract(this.DivideToIntegerNaturalScale(b,null).Multiply(b,null),c)};m.Divide=function(b,c){return r.math.Divide(this,b,c)};m.DivideToExponent=function(b,c,e){return r.math.DivideToExponent(this,b,c,e)};m.Abs=function(b){return r.math.Abs(this,b)};m.Negate=function(b){return r.math.Negate(this,b)};
m.Subtract=function(b,c){if(null==b)throw"decfrac";var e=b;0==(b.flags&n.FlagNaN)&&(e=r.CreateWithFlags(b.unsignedMantissa,b.exponent,b.flags^n.FlagNegative));return this.Add(e,c)};s.math=new z(new r.DecimalMathHelper);m.DivideToIntegerNaturalScale=function(b,c){return r.math.DivideToIntegerNaturalScale(this,b,c)};m.DivideToIntegerZeroScale=function(b,c){return r.math.DivideToIntegerZeroScale(this,b,c)};m.Remainder=function(b,c){return r.math.Remainder(this,b,c)};m.RemainderNear=function(b,c){return r.math.RemainderNear(this,
b,c)};m.NextMinus=function(b){return r.math.NextMinus(this,b)};m.NextPlus=function(b){return r.math.NextPlus(this,b)};m.NextToward=function(b,c){return r.math.NextToward(this,b,c)};s.Max=function(b,c,e){return r.math.Max(b,c,e)};s.Min=function(b,c,e){return r.math.Min(b,c,e)};s.MaxMagnitude=function(b,c,e){return r.math.MaxMagnitude(b,c,e)};s.MinMagnitude=function(b,c,e){return r.math.MinMagnitude(b,c,e)};m.compareTo=function(b){return r.math.compareTo(this,b)};m.CompareToWithContext=function(b,c){return r.math.CompareToWithContext(this,
b,!1,c)};m.CompareToSignal=function(b,c){return r.math.CompareToWithContext(this,b,!0,c)};m.Add=function(b,c){return r.math.Add(this,b,c)};m.Quantize=function(b,c){return r.math.Quantize(this,b,c)};m.RoundToIntegralExact=function(b){return r.math.RoundToExponentExact(this,l.ZERO,b)};m.RoundToIntegralNoRoundedFlag=function(b){return r.math.RoundToExponentNoRoundedFlag(this,l.ZERO,b)};m.RoundToExponentExact=function(b,c){return r.math.RoundToExponentExact(this,b,c)};m.RoundToExponent=function(b,c){return r.math.RoundToExponentSimple(this,
b,c)};m.Multiply=function(b,c){return r.math.Multiply(this,b,c)};m.MultiplyAndAdd=function(b,c,e){return r.math.MultiplyAndAdd(this,b,c,e)};m.MultiplyAndSubtract=function(b,c,e){if(null==c)throw"decfrac";var f=c;0==(c.flags&n.FlagNaN)&&(f=r.CreateWithFlags(c.unsignedMantissa,c.exponent,c.flags^n.FlagNegative));return r.math.MultiplyAndAdd(this,b,f,e)};m.RoundToPrecision=function(b){return r.math.RoundToPrecision(this,b)};m.Plus=function(b){return r.math.Plus(this,b)};m.RoundToBinaryPrecision=function(b){return r.math.RoundToBinaryPrecision(this,
b)}})(r,r.prototype);"undefined"!==typeof exports&&(exports.ExtendedDecimal=r);var t=function(l,m){this.exponent=m;var b=l.signum();this.mantissa=0>b?l.negate():l;this.flags=0>b?n.FlagNegative:0};(function(s,m){m.exponent=null;m.mantissa=null;m.flags=null;m.getExponent=function(){return this.exponent};m.getUnsignedMantissa=function(){return this.mantissa};m.getMantissa=function(){return this.isNegative()?this.mantissa.negate():this.mantissa};m.EqualsInternal=function(b){return null==b?!1:this.exponent.equals(b.exponent)&&
this.mantissa.equals(b.mantissa)&&this.flags==b.flags};m.equals=function(b){return this.EqualsInternal(b.constructor==t?b:null)};m.hashCode=function(){var b;b=0+1000000007*this.exponent.hashCode();b+=1000000009*this.mantissa.hashCode();return b+=1000000009*this.flags};s.CreateWithFlags=function(b,c,e){b=new t(b,c);b.flags=e;return b};s.MaxSafeInt=214748363;s.FromString=function(b){if(null==b)throw"str";return r.FromString(b).ToExtendedFloat()};s.BigShiftIteration=l.valueOf(1E6);s.ShiftIteration=1E6;
s.ShiftLeft=function(b,c){for(;0<c.compareTo(t.BigShiftIteration);)b=b.shiftLeft(1E6),c=c.subtract(t.BigShiftIteration);var e=c.intValue();return b=b.shiftLeft(e)};s.ShiftLeftInt=function(b,c){for(;c>t.ShiftIteration;)b=b.shiftLeft(1E6),c-=t.ShiftIteration;return b=b.shiftLeft(c|0)};s.BinaryMathHelper=function(){};(function(b,c){c.GetRadix=function(){return 2};c.GetSign=function(b){return b.signum()};c.GetMantissa=function(b){return b.mantissa};c.GetExponent=function(b){return b.exponent};c.RescaleByExponentDiff=
function(b,c,d){var g=0>b.signum();g&&(b=b.negate());c=c.subtract(d).abs();b=t.ShiftLeft(b,c);g&&(b=b.negate());return b};c.CreateNew=function(b,c){return new t(b,c)};c.CreateShiftAccumulatorWithDigits=function(b,c,d){return new y(b,c,d)};c.CreateShiftAccumulator=function(b){return new y(b,0,0)};c.HasTerminatingRadixExpansion=function(b,c){var d=b.gcd(c);if(0==d.signum())return!1;for(c=c.divide(d);!1==c.testBit(0);)c=c.shiftRight(1);return c.equals(l.ONE)};c.MultiplyByRadixPower=function(b,c){return 0>=
c.signum()?b:c.CanFitInInt32()?t.ShiftLeftInt(b,c.AsInt32()):t.ShiftLeft(b,c.AsBigInteger())};c.GetFlags=function(b){return 0>b.mantissa.signum()?n.FlagNegative:0};c.CreateNewWithFlags=function(b,c,d){if((d=0!=(d&n.FlagNegative))&&0<b.signum()||!d&&0>b.signum())b=b.negate();return new t(b,c)};c.GetArithmeticSupport=function(){return n.FiniteOnly};c.ValueOf=function(b){return t.FromInt64(b)}})(t.BinaryMathHelper,t.BinaryMathHelper.prototype);m.ToBigInteger=function(){var b=this.getExponent().signum();
if(0==b)return this.getMantissa();if(0<b){var b=this.getExponent(),c=this.getMantissa();if(0==c.signum())return c;var e=0>c.signum();for(e&&(c=c.negate());0<b.signum()&&0!=c.signum();){var f=4096;0>b.compareTo(l.valueOf(f))&&(f=b.intValue());c=c.shiftLeft(f);b=b.subtract(l.valueOf(f))}}else{b=this.getExponent();c=this.getMantissa();if(0==c.signum())return c;for((e=0>c.signum())&&(c=c.negate());0>b.signum()&&0!=c.signum();)f=4096,0<b.compareTo(l.valueOf(-4096))&&(f=-b.intValue()),c=c.shiftRight(f),
b=b.add(l.valueOf(f))}e&&(c=c.negate());return c};s.OneShift62=l.ONE.shiftLeft(62);m.ToExtendedFloat=function(){if(this.IsNaN()||this.IsInfinity())throw"This value is infinity or NaN";var b=this.getExponent(),c=this.getMantissa();if(0==c.signum())return t.Zero;if(0==b.signum())return t.FromBigInteger(c);if(0<b.signum())return c=c.multiply(v.FindPowerOfTenFromBig(b)),t.FromBigInteger(c);var b=p.FromBig(b),e=0>c.signum(),f;e&&(c=c.negate());for(var d=p.Copy(b).Negate(),d=v.FindPowerOfFiveFromBig(d.AsBigInteger());;){var g;
f=c.divideAndRemainder(d);g=f[0];f=f[1];if(0!=f.signum()&&0>g.compareTo(t.OneShift62)){g=p.GetLastWords(g,2);var a=0;0!=(g[0]|g[1])?(a=v.BitPrecisionInt(g[1]),a=0!=a?a+32:v.BitPrecisionInt(g[0]),a=63-a):a=1;b.SubtractInt(a);c=c.shiftLeft(a)}else{c=g;break}}d=d.shiftRight(1);0<f.compareTo(d)&&(c=c.add(l.ONE));e&&(c=c.negate());return new t(c,b.AsBigInteger())};s.OneShift23=l.ONE.shiftLeft(23);s.OneShift52=l.ONE.shiftLeft(52);m.ToSingle=function(){if(this.IsPositiveInfinity())return Number.POSITIVE_INFINITY;
if(this.IsNegativeInfinity())return Number.NEGATIVE_INFINITY;if(this.IsNaN()){var b=2139095041;this.isNegative()&&(b|=-2147483648);b=this.IsQuietNaN()?b|4194304:b|2097152;if(0!=this.getUnsignedMantissa().signum())var c=this.getUnsignedMantissa().remainder(l.valueOf(2097152)),b=b|c.intValue();return Float.intBitsToFloat(b)}if(this.isNegative()&&0==this.signum())return Float.intBitsToFloat(-2147483648);var e=this.mantissa.abs(),b=p.FromBig(this.exponent),f=c=0;if(0==this.mantissa.signum())return 0;
var d=0;if(0>e.compareTo(t.OneShift23)){d=e.intValue();for(e=0;8388608>d;)d<<=1,e++;b.SubtractInt(e);e=new p(d)}else e=new y(e,0,0),e.ShiftToDigitsInt(24),f=e.getOlderDiscardedDigits(),c=e.getLastDiscardedDigit(),b.Add(e.getDiscardedDigitCount()),e=e.getShiftedIntFast();0<c&&(0<f||!e.isEvenNumber())&&(e.AddInt(1),0==e.CompareToInt(16777216)&&(e=new p(8388608),b.AddInt(1)));d=!1;if(0<b.CompareToInt(104))return this.isNegative()?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;0>b.CompareToInt(-149)&&
(d=!0,e=y.FromInt32(e.AsInt32()),c=p.Copy(b).SubtractInt(-149).Abs(),e.ShiftRight(c),f=e.getOlderDiscardedDigits(),c=e.getLastDiscardedDigit(),b.Add(e.getDiscardedDigitCount()),e=e.getShiftedIntFast(),0<c&&(0<f||!e.isEvenNumber())&&(e.AddInt(1),0==e.CompareToInt(16777216)&&(e=new p(8388608),b.AddInt(1))));if(0>b.CompareToInt(-149))return this.isNegative()?Float.intBitsToFloat(-2147483648):Float.intBitsToFloat(0);b=b.AsInt32();b+=150;c=(e.AsInt32()|0)&8388607;d||(c|=b<<23);this.isNegative()&&(c|=-2147483648);
return Float.intBitsToFloat(c)};m.ToDouble=function(){if(this.IsPositiveInfinity())return Number.POSITIVE_INFINITY;if(this.IsNegativeInfinity())return Number.NEGATIVE_INFINITY;if(this.IsNaN()){var b=[1,2146435072];this.isNegative()&&(b[1]|=-2147483648);this.IsQuietNaN()?b[1]|=524288:b[1]|=262144;if(0!=this.getUnsignedMantissa().signum()){var c=p.GetLastWords(this.getUnsignedMantissa(),2);b[0]=c[0];b[1]=c[1]&262143}return D.IntegersToDouble(b)}if(this.isNegative()&&0==this.signum())return D.IntegersToDouble([-2147483648,
0]);var e=this.mantissa.abs(),b=p.FromBig(this.exponent),f=c=0;if(0==this.mantissa.signum())return 0;var d;if(0>e.compareTo(t.OneShift52))for(d=p.GetLastWords(e,2);!v.HasBitSet(d,52);)v.ShiftLeftOne(d),b.SubtractInt(1);else d=new y(e,0,0),d.ShiftToDigitsInt(53),f=d.getOlderDiscardedDigits(),c=d.getLastDiscardedDigit(),b.Add(d.getDiscardedDigitCount()),d=p.GetLastWords(d.getShiftedInt(),2);0<c&&(0<f||v.HasBitSet(d,0))&&(d[0]=d[0]+1|0,0==d[0]&&(d[1]=d[1]+1|0),0==d[0]&&2097152==d[1]&&(d[1]>>=1,b.AddInt(1)));
e=!1;if(0<b.CompareToInt(971))return this.isNegative()?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;0>b.CompareToInt(-1074)&&(e=!0,d=new y(p.WordsToBigInteger(d),0,0),c=p.Copy(b).SubtractInt(-1074).Abs(),d.ShiftRight(c),f=d.getOlderDiscardedDigits(),c=d.getLastDiscardedDigit(),b.Add(d.getDiscardedDigitCount()),d=p.GetLastWords(d.getShiftedInt(),2),0<c&&(0<f||v.HasBitSet(d,0))&&(d[0]=d[0]+1|0,0==d[0]&&(d[1]=d[1]+1|0),0==d[0]&&2097152==d[1]&&(d[1]>>=1,b.AddInt(1))));if(0>b.CompareToInt(-1074))return this.isNegative()?
D.IntegersToDouble([0,-2147483648]):0;b.AddInt(1075);d[1]&=1048575;e||(b=b.AsInt32()<<20,d[1]|=b);this.isNegative()&&(d[1]|=-2147483648);return D.IntegersToDouble(d)};s.FromSingle=function(b){var c=Float.floatToRawIntBits(b);b=0!=c>>31;var e=c>>23&255,c=c&8388607;if(255==e){if(0==c)return b?t.NegativeInfinity:t.PositiveInfinity;e=0!=(c&4194304);c=l.valueOf(c&2097151);c=c.subtract(l.ONE);return 0==c.signum()?e?t.NaN:t.SignalingNaN:t.CreateWithFlags(c,l.ZERO,(b?n.FlagNegative:0)|(e?n.FlagQuietNaN:n.FlagSignalingNaN))}0==
e?e++:c|=8388608;if(0==c)return b?t.NegativeZero:t.Zero;for(;0==(c&1);)e++,c>>=1;b&&(c=-c);c=l.valueOf(c);return new t(c,l.valueOf(e-150))};s.FromBigInteger=function(b){return new t(b,l.ZERO)};s.FromInt64=function(b){b=q.createLong(b);b=l.valueOf(b);return new t(b,l.ZERO)};s.FromDouble=function(b){var c=D.DoubleToIntegers(b),e=c[1]>>20&2047;b=0!=c[1]>>31;if(2047==e){if(0==(c[1]&1048575)&&0==c[0])return b?t.NegativeInfinity:t.PositiveInfinity;e=0!=(c[1]&524288);c[1]&=262143;c=p.WordsToBigInteger(c);
c=c.subtract(l.ONE);return 0==c.signum()?e?t.NaN:t.SignalingNaN:t.CreateWithFlags(c,l.ZERO,(b?n.FlagNegative:0)|(e?n.FlagQuietNaN:n.FlagSignalingNaN))}c[1]&=1048575;0==e?e++:c[1]|=1048576;if(0!=(c[1]|c[0]))e+=v.ShiftAwayTrailingZerosTwoElements(c);else return b?t.NegativeZero:t.Zero;return t.CreateWithFlags(p.WordsToBigInteger(c),l.valueOf(e-1075),b?n.FlagNegative:0)};m.ToExtendedDecimal=function(){return r.FromExtendedFloat(this)};m.toString=function(){return r.FromExtendedFloat(this).toString()};
m.ToEngineeringString=function(){return this.ToExtendedDecimal().ToEngineeringString()};m.ToPlainString=function(){return this.ToExtendedDecimal().ToPlainString()};s.One=new t(l.ONE,l.ZERO);s.Zero=new t(l.ZERO,l.ZERO);s.NegativeZero=t.CreateWithFlags(l.ZERO,l.ZERO,n.FlagNegative);s.Ten=new t(l.TEN,l.ZERO);s.NaN=t.CreateWithFlags(l.ZERO,l.ZERO,n.FlagQuietNaN);s.SignalingNaN=t.CreateWithFlags(l.ZERO,l.ZERO,n.FlagSignalingNaN);s.PositiveInfinity=t.CreateWithFlags(l.ZERO,l.ZERO,n.FlagInfinity);s.NegativeInfinity=
t.CreateWithFlags(l.ZERO,l.ZERO,n.FlagInfinity|n.FlagNegative);m.IsPositiveInfinity=function(){return(this.flags&(n.FlagInfinity|n.FlagNegative))==(n.FlagInfinity|n.FlagNegative)};m.IsNegativeInfinity=function(){return(this.flags&(n.FlagInfinity|n.FlagNegative))==n.FlagInfinity};m.IsNaN=function(){return 0!=(this.flags&(n.FlagQuietNaN|n.FlagSignalingNaN))};m.IsInfinity=function(){return 0!=(this.flags&n.FlagInfinity)};m.isNegative=function(){return 0!=(this.flags&n.FlagNegative)};m.IsQuietNaN=function(){return 0!=
(this.flags&n.FlagQuietNaN)};m.IsSignalingNaN=function(){return 0!=(this.flags&n.FlagSignalingNaN)};m.signum=function(){return 0==this.mantissa.signum()?0:0!=(this.flags&n.FlagNegative)?-1:1};m.isZero=function(){return 0==this.mantissa.signum()};m.DivideToSameExponent=function(b,c){return this.DivideToExponent(b,this.exponent,u.ForRounding(c))};m.Reduce=function(b){return t.math.Reduce(this,b)};m.RemainderNaturalScale=function(b,c){return this.Subtract(this.DivideToIntegerNaturalScale(b,null).Multiply(b,
null),c)};m.Divide=function(b,c){return t.math.Divide(this,b,c)};m.DivideToExponent=function(b,c,e){return t.math.DivideToExponent(this,b,c,e)};m.Abs=function(b){return t.math.Abs(this,b)};m.Negate=function(b){return t.math.Negate(this,b)};m.Subtract=function(b,c){if(null==b)throw"decfrac";var e=b;0==(b.flags&n.FlagNaN)&&(e=t.CreateWithFlags(b.mantissa,b.exponent,b.flags^n.FlagNegative));return this.Add(e,c)};s.math=new z(new t.BinaryMathHelper);m.DivideToIntegerNaturalScale=function(b,c){return t.math.DivideToIntegerNaturalScale(this,
b,c)};m.DivideToIntegerZeroScale=function(b,c){return t.math.DivideToIntegerZeroScale(this,b,c)};m.Remainder=function(b,c){return t.math.Remainder(this,b,c)};m.RemainderNear=function(b,c){return t.math.RemainderNear(this,b,c)};m.NextMinus=function(b){return t.math.NextMinus(this,b)};m.NextPlus=function(b){return t.math.NextPlus(this,b)};m.NextToward=function(b,c){return t.math.NextToward(this,b,c)};s.Max=function(b,c,e){return t.math.Max(b,c,e)};s.Min=function(b,c,e){return t.math.Min(b,c,e)};s.MaxMagnitude=
function(b,c,e){return t.math.MaxMagnitude(b,c,e)};s.MinMagnitude=function(b,c,e){return t.math.MinMagnitude(b,c,e)};m.compareTo=function(b){return t.math.compareTo(this,b)};m.CompareToWithContext=function(b,c){return t.math.CompareToWithContext(this,b,!1,c)};m.CompareToSignal=function(b,c){return t.math.CompareToWithContext(this,b,!0,c)};m.Add=function(b,c){return t.math.Add(this,b,c)};m.Quantize=function(b,c){return t.math.Quantize(this,b,c)};m.RoundToIntegralExact=function(b){return t.math.RoundToExponentExact(this,
l.ZERO,b)};m.RoundToIntegralNoRoundedFlag=function(b){return t.math.RoundToExponentNoRoundedFlag(this,l.ZERO,b)};m.RoundToExponentExact=function(b,c){return t.math.RoundToExponentExact(this,b,c)};m.RoundToExponent=function(b,c){return t.math.RoundToExponentSimple(this,b,c)};m.Multiply=function(b,c){return t.math.Multiply(this,b,c)};m.MultiplyAndAdd=function(b,c,e){return t.math.MultiplyAndAdd(this,b,c,e)};m.MultiplyAndSubtract=function(b,c,e){if(null==c)throw"decfrac";var f=c;0==(c.flags&n.FlagNaN)&&
(f=t.CreateWithFlags(c.mantissa,c.exponent,c.flags^n.FlagNegative));return t.math.MultiplyAndAdd(this,b,f,e)};m.RoundToPrecision=function(b){return t.math.RoundToPrecision(this,b)};m.Plus=function(b){return t.math.Plus(this,b)};m.RoundToBinaryPrecision=function(b){return t.math.RoundToBinaryPrecision(this,b)}})(t,t.prototype);"undefined"!==typeof exports&&(exports.ExtendedFloat=t)})();
